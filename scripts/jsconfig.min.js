define("views/signIn",[],function(){var e=function(){};return{create:function(){},show:function(){},beforeShow:function(){},beforeHide:function(){},endOldSession:function(){}}}),function(){(function(p){var s=this||(0,eval)("this"),v=s.document,L=s.navigator,w=s.jQuery,D=s.JSON;(function(e){"function"==typeof require&&"object"==typeof exports&&"object"==typeof module?e(module.exports||exports,require):"function"==typeof define&&define.amd?define("knockout",["exports","require"],e):e(s.ko={})})(function(e,t){function n(e,t){return null===e||typeof e in a?e===t:!1}function r(e,t){var n;return function(){n||(n=setTimeout(function(){n=p,e()},t))}}function i(e,t){var n;return function(){clearTimeout(n),n=setTimeout(e,t)}}function o(e,t,n,r){u.d[e]={init:function(e,i,s,o,a){var f,l;return u.s(function(){var s=u.a.c(i()),o=!n!=!s,c=!l;if(c||t||o!==f)c&&u.Y.la()&&(l=u.a.ia(u.f.childNodes(e),!0)),o?(c||u.f.T(e,u.a.ia(l)),u.Ca(r?r(a,s):a,e)):u.f.ja(e),f=o},null,{o:e}),{controlsDescendantBindings:!0}}},u.h.ha[e]=!1,u.f.Q[e]=!0}var u="undefined"!=typeof e?e:{};u.b=function(e,t){for(var n=e.split("."),r=u,i=0;i<n.length-1;i++)r=r[n[i]];r[n[n.length-1]]=t},u.A=function(e,t,n){e[t]=n},u.version="3.2.0",u.b("version",u.version),u.a=function(){function e(e,t){for(var n in e)e.hasOwnProperty(n)&&t(n,e[n])}function t(e,t){if(t)for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function n(e,t){return e.__proto__=t,e}var r={__proto__:[]}instanceof Array,i={},o={};i[L&&/Firefox\/2/i.test(L.userAgent)?"KeyboardEvent":"UIEvents"]=["keyup","keydown","keypress"],i.MouseEvents="click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave".split(" "),e(i,function(e,t){if(t.length)for(var n=0,r=t.length;n<r;n++)o[t[n]]=e});var a={propertychange:!0},f=v&&function(){for(var e=3,t=v.createElement("div"),n=t.getElementsByTagName("i");t.innerHTML="<!--[if gt IE "+ ++e+"]><i></i><![endif]-->",n[0];);return 4<e?e:p}();return{vb:["authenticity_token",/^__RequestVerificationToken(_.*)?$/],u:function(e,t){for(var n=0,r=e.length;n<r;n++)t(e[n],n)},m:function(e,t){if("function"==typeof Array.prototype.indexOf)return Array.prototype.indexOf.call(e,t);for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1},qb:function(e,t,n){for(var r=0,i=e.length;r<i;r++)if(t.call(n,e[r],r))return e[r];return null},ua:function(e,t){var n=u.a.m(e,t);0<n?e.splice(n,1):0===n&&e.shift()},rb:function(e){e=e||[];for(var t=[],n=0,r=e.length;n<r;n++)0>u.a.m(t,e[n])&&t.push(e[n]);return t},Da:function(e,t){e=e||[];for(var n=[],r=0,i=e.length;r<i;r++)n.push(t(e[r],r));return n},ta:function(e,t){e=e||[];for(var n=[],r=0,i=e.length;r<i;r++)t(e[r],r)&&n.push(e[r]);return n},ga:function(e,t){if(t instanceof Array)e.push.apply(e,t);else for(var n=0,r=t.length;n<r;n++)e.push(t[n]);return e},ea:function(e,t,n){var r=u.a.m(u.a.Xa(e),t);0>r?n&&e.push(t):n||e.splice(r,1)},xa:r,extend:t,za:n,Aa:r?n:t,G:e,na:function(e,t){if(!e)return e;var n={},r;for(r in e)e.hasOwnProperty(r)&&(n[r]=t(e[r],r,e));return n},Ka:function(e){for(;e.firstChild;)u.removeNode(e.firstChild)},oc:function(e){e=u.a.S(e);for(var t=v.createElement("div"),n=0,r=e.length;n<r;n++)t.appendChild(u.R(e[n]));return t},ia:function(e,t){for(var n=0,r=e.length,i=[];n<r;n++){var s=e[n].cloneNode(!0);i.push(t?u.R(s):s)}return i},T:function(e,t){u.a.Ka(e);if(t)for(var n=0,r=t.length;n<r;n++)e.appendChild(t[n])},Lb:function(e,t){var n=e.nodeType?[e]:e;if(0<n.length){for(var r=n[0],i=r.parentNode,s=0,o=t.length;s<o;s++)i.insertBefore(t[s],r);s=0;for(o=n.length;s<o;s++)u.removeNode(n[s])}},ka:function(e,t){if(e.length){for(t=8===t.nodeType&&t.parentNode||t;e.length&&e[0].parentNode!==t;)e.shift();if(1<e.length){var n=e[0],r=e[e.length-1];for(e.length=0;n!==r;)if(e.push(n),n=n.nextSibling,!n)return;e.push(r)}}return e},Nb:function(e,t){7>f?e.setAttribute("selected",t):e.selected=t},cb:function(e){return null===e||e===p?"":e.trim?e.trim():e.toString().replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")},vc:function(e,t){return e=e||"",t.length>e.length?!1:e.substring(0,t.length)===t},cc:function(e,t){if(e===t)return!0;if(11===e.nodeType)return!1;if(t.contains)return t.contains(3===e.nodeType?e.parentNode:e);if(t.compareDocumentPosition)return 16==(t.compareDocumentPosition(e)&16);for(;e&&e!=t;)e=e.parentNode;return!!e},Ja:function(e){return u.a.cc(e,e.ownerDocument.documentElement)},ob:function(e){return!!u.a.qb(e,u.a.Ja)},t:function(e){return e&&e.tagName&&e.tagName.toLowerCase()},n:function(e,t,n){var r=f&&a[t];if(!r&&w)w(e).bind(t,n);else if(r||"function"!=typeof e.addEventListener){if("undefined"==typeof e.attachEvent)throw Error("Browser doesn't support addEventListener or attachEvent");var i=function(t){n.call(e,t)},s="on"+t;e.attachEvent(s,i),u.a.w.da(e,function(){e.detachEvent(s,i)})}else e.addEventListener(t,n,!1)},oa:function(e,t){if(!e||!e.nodeType)throw Error("element must be a DOM node when calling triggerEvent");var n;"input"===u.a.t(e)&&e.type&&"click"==t.toLowerCase()?(n=e.type,n="checkbox"==n||"radio"==n):n=!1;if(w&&!n)w(e).trigger(t);else if("function"==typeof v.createEvent){if("function"!=typeof e.dispatchEvent)throw Error("The supplied element doesn't support dispatchEvent");n=v.createEvent(o[t]||"HTMLEvents"),n.initEvent(t,!0,!0,s,0,0,0,0,0,!1,!1,!1,!1,0,e),e.dispatchEvent(n)}else if(n&&e.click)e.click();else{if("undefined"==typeof e.fireEvent)throw Error("Browser doesn't support triggering events");e.fireEvent("on"+t)}},c:function(e){return u.C(e)?e():e},Xa:function(e){return u.C(e)?e.v():e},Ba:function(e,t,n){if(t){var r=/\S+/g,i=e.className.match(r)||[];u.a.u(t.match(r),function(e){u.a.ea(i,e,n)}),e.className=i.join(" ")}},bb:function(e,t){var n=u.a.c(t);if(null===n||n===p)n="";var r=u.f.firstChild(e);!r||3!=r.nodeType||u.f.nextSibling(r)?u.f.T(e,[e.ownerDocument.createTextNode(n)]):r.data=n,u.a.fc(e)},Mb:function(e,t){e.name=t;if(7>=f)try{e.mergeAttributes(v.createElement("<input name='"+e.name+"'/>"),!1)}catch(n){}},fc:function(e){9<=f&&(e=1==e.nodeType?e:e.parentNode,e.style&&(e.style.zoom=e.style.zoom))},dc:function(e){if(f){var t=e.style.width;e.style.width=0,e.style.width=t}},sc:function(e,t){e=u.a.c(e),t=u.a.c(t);for(var n=[],r=e;r<=t;r++)n.push(r);return n},S:function(e){for(var t=[],n=0,r=e.length;n<r;n++)t.push(e[n]);return t},yc:6===f,zc:7===f,L:f,xb:function(e,t){for(var n=u.a.S(e.getElementsByTagName("input")).concat(u.a.S(e.getElementsByTagName("textarea"))),r="string"==typeof t?function(e){return e.name===t}:function(e){return t.test(e.name)},i=[],s=n.length-1;0<=s;s--)r(n[s])&&i.push(n[s]);return i},pc:function(e){return"string"==typeof e&&(e=u.a.cb(e))?D&&D.parse?D.parse(e):(new Function("return "+e))():null},eb:function(e,t,n){if(!D||!D.stringify)throw Error("Cannot find JSON.stringify(). Some browsers (e.g., IE < 8) don't support it natively, but you can overcome this by adding a script reference to json2.js, downloadable from http://www.json.org/json2.js");return D.stringify(u.a.c(e),t,n)},qc:function(t,n,r){r=r||{};var i=r.params||{},s=r.includeFields||this.vb,o=t;if("object"==typeof t&&"form"===u.a.t(t))for(var o=t.action,a=s.length-1;0<=a;a--)for(var f=u.a.xb(t,s[a]),l=f.length-1;0<=l;l--)i[f[l].name]=f[l].value;n=u.a.c(n);var c=v.createElement("form");c.style.display="none",c.action=o,c.method="post";for(var h in n)t=v.createElement("input"),t.type="hidden",t.name=h,t.value=u.a.eb(u.a.c(n[h])),c.appendChild(t);e(i,function(e,t){var n=v.createElement("input");n.type="hidden",n.name=e,n.value=t,c.appendChild(n)}),v.body.appendChild(c),r.submitter?r.submitter(c):c.submit(),setTimeout(function(){c.parentNode.removeChild(c)},0)}}}(),u.b("utils",u.a),u.b("utils.arrayForEach",u.a.u),u.b("utils.arrayFirst",u.a.qb),u.b("utils.arrayFilter",u.a.ta),u.b("utils.arrayGetDistinctValues",u.a.rb),u.b("utils.arrayIndexOf",u.a.m),u.b("utils.arrayMap",u.a.Da),u.b("utils.arrayPushAll",u.a.ga),u.b("utils.arrayRemoveItem",u.a.ua),u.b("utils.extend",u.a.extend),u.b("utils.fieldsIncludedWithJsonPost",u.a.vb),u.b("utils.getFormFields",u.a.xb),u.b("utils.peekObservable",u.a.Xa),u.b("utils.postJson",u.a.qc),u.b("utils.parseJson",u.a.pc),u.b("utils.registerEventHandler",u.a.n),u.b("utils.stringifyJson",u.a.eb),u.b("utils.range",u.a.sc),u.b("utils.toggleDomNodeCssClass",u.a.Ba),u.b("utils.triggerEvent",u.a.oa),u.b("utils.unwrapObservable",u.a.c),u.b("utils.objectForEach",u.a.G),u.b("utils.addOrRemoveItem",u.a.ea),u.b("unwrap",u.a.c),Function.prototype.bind||(Function.prototype.bind=function(e){var t=this,n=Array.prototype.slice.call(arguments);return e=n.shift(),function(){return t.apply(e,n.concat(Array.prototype.slice.call(arguments)))}}),u.a.e=new function(){function e(e,i){var s=e[n];if(!s||"null"===s||!r[s]){if(!i)return p;s=e[n]="ko"+t++,r[s]={}}return r[s]}var t=0,n="__ko__"+(new Date).getTime(),r={};return{get:function(t,n){var r=e(t,!1);return r===p?p:r[n]},set:function(t,n,r){if(r!==p||e(t,!1)!==p)e(t,!0)[n]=r},clear:function(e){var t=e[n];return t?(delete r[t],e[n]=null,!0):!1},F:function(){return t++ +n}}},u.b("utils.domData",u.a.e),u.b("utils.domData.clear",u.a.e.clear),u.a.w=new function(){function e(e,t){var r=u.a.e.get(e,n);return r===p&&t&&(r=[],u.a.e.set(e,n,r)),r}function t(n){var r=e(n,!1);if(r)for(var r=r.slice(0),s=0;s<r.length;s++)r[s](n);u.a.e.clear(n),u.a.w.cleanExternalData(n);if(i[n.nodeType])for(r=n.firstChild;n=r;)r=n.nextSibling,8===n.nodeType&&t(n)}var n=u.a.e.F(),r={1:!0,8:!0,9:!0},i={1:!0,9:!0};return{da:function(t,n){if("function"!=typeof n)throw Error("Callback must be a function");e(t,!0).push(n)},Kb:function(t,r){var i=e(t,!1);i&&(u.a.ua(i,r),0==i.length&&u.a.e.set(t,n,p))},R:function(e){if(r[e.nodeType]&&(t(e),i[e.nodeType])){var n=[];u.a.ga(n,e.getElementsByTagName("*"));for(var s=0,o=n.length;s<o;s++)t(n[s])}return e},removeNode:function(e){u.R(e),e.parentNode&&e.parentNode.removeChild(e)},cleanExternalData:function(e){w&&"function"==typeof w.cleanData&&w.cleanData([e])}}},u.R=u.a.w.R,u.removeNode=u.a.w.removeNode,u.b("cleanNode",u.R),u.b("removeNode",u.removeNode),u.b("utils.domNodeDisposal",u.a.w),u.b("utils.domNodeDisposal.addDisposeCallback",u.a.w.da),u.b("utils.domNodeDisposal.removeDisposeCallback",u.a.w.Kb),function(){u.a.ba=function(e){var t;if(w){if(w.parseHTML)t=w.parseHTML(e)||[];else if((t=w.clean([e]))&&t[0]){for(e=t[0];e.parentNode&&11!==e.parentNode.nodeType;)e=e.parentNode;e.parentNode&&e.parentNode.removeChild(e)}}else{var n=u.a.cb(e).toLowerCase();t=v.createElement("div"),n=n.match(/^<(thead|tbody|tfoot)/)&&[1,"<table>","</table>"]||!n.indexOf("<tr")&&[2,"<table><tbody>","</tbody></table>"]||(!n.indexOf("<td")||!n.indexOf("<th"))&&[3,"<table><tbody><tr>","</tr></tbody></table>"]||[0,"",""],e="ignored<div>"+n[1]+e+n[2]+"</div>";for("function"==typeof s.innerShiv?t.appendChild(s.innerShiv(e)):t.innerHTML=e;n[0]--;)t=t.lastChild;t=u.a.S(t.lastChild.childNodes)}return t},u.a.$a=function(e,t){u.a.Ka(e),t=u.a.c(t);if(null!==t&&t!==p)if("string"!=typeof t&&(t=t.toString()),w)w(e).html(t);else for(var n=u.a.ba(t),r=0;r<n.length;r++)e.appendChild(n[r])}}(),u.b("utils.parseHtmlFragment",u.a.ba),u.b("utils.setHtml",u.a.$a),u.D=function(){function e(t,n){if(t)if(8==t.nodeType){var r=u.D.Gb(t.nodeValue);null!=r&&n.push({bc:t,mc:r})}else if(1==t.nodeType)for(var r=0,i=t.childNodes,s=i.length;r<s;r++)e(i[r],n)}var t={};return{Ua:function(e){if("function"!=typeof e)throw Error("You can only pass a function to ko.memoization.memoize()");var n=(4294967296*(1+Math.random())|0).toString(16).substring(1)+(4294967296*(1+Math.random())|0).toString(16).substring(1);return t[n]=e,"<!--[ko_memo:"+n+"]-->"},Rb:function(e,n){var r=t[e];if(r===p)throw Error("Couldn't find any memo with ID "+e+". Perhaps it's already been unmemoized.");try{return r.apply(null,n||[]),!0}finally{delete t[e]}},Sb:function(t,n){var r=[];e(t,r);for(var i=0,s=r.length;i<s;i++){var o=r[i].bc,a=[o];n&&u.a.ga(a,n),u.D.Rb(r[i].mc,a),o.nodeValue="",o.parentNode&&o.parentNode.removeChild(o)}},Gb:function(e){return(e=e.match(/^\[ko_memo\:(.*?)\]$/))?e[1]:null}}}(),u.b("memoization",u.D),u.b("memoization.memoize",u.D.Ua),u.b("memoization.unmemoize",u.D.Rb),u.b("memoization.parseMemoText",u.D.Gb),u.b("memoization.unmemoizeDomNodeAndDescendants",u.D.Sb),u.La={throttle:function(e,t){e.throttleEvaluation=t;var n=null;return u.j({read:e,write:function(r){clearTimeout(n),n=setTimeout(function(){e(r)},t)}})},rateLimit:function(e,t){var n,s,o;"number"==typeof t?n=t:(n=t.timeout,s=t.method),o="notifyWhenChangesStop"==s?i:r,e.Ta(function(e){return o(e,n)})},notify:function(e,t){e.equalityComparer="always"==t?null:n}};var a={"undefined":1,"boolean":1,number:1,string:1};u.b("extenders",u.La),u.Pb=function(e,t,n){this.target=e,this.wa=t,this.ac=n,this.Cb=!1,u.A(this,"dispose",this.K)},u.Pb.prototype.K=function(){this.Cb=!0,this.ac()},u.P=function(){u.a.Aa(this,u.P.fn),this.M={}};var f="change",l={U:function(e,t,n){var r=this;n=n||f;var i=new u.Pb(r,t?e.bind(t):e,function(){u.a.ua(r.M[n],i),r.nb&&r.nb()});return r.va&&r.va(n),r.M[n]||(r.M[n]=[]),r.M[n].push(i),i},notifySubscribers:function(e,t){t=t||f;if(this.Ab(t))try{u.k.Ea();for(var n=this.M[t].slice(0),r=0,i;i=n[r];++r)i.Cb||i.wa(e)}finally{u.k.end()}},Ta:function(e){var t=this,n=u.C(t),r,i,s;t.qa||(t.qa=t.notifySubscribers,t.notifySubscribers=function(e,n){n&&n!==f?"beforeChange"===n?t.kb(e):t.qa(e,n):t.lb(e)});var o=e(function(){n&&s===t&&(s=t()),r=!1,t.Pa(i,s)&&t.qa(i=s)});t.lb=function(e){r=!0,s=e,o()},t.kb=function(e){r||(i=e,t.qa(e,"beforeChange"))}},Ab:function(e){return this.M[e]&&this.M[e].length},yb:function(){var e=0;return u.a.G(this.M,function(t,n){e+=n.length}),e},Pa:function(e,t){return!this.equalityComparer||!this.equalityComparer(e,t)},extend:function(e){var t=this;return e&&u.a.G(e,function(e,n){var r=u.La[e];"function"==typeof r&&(t=r(t,n)||t)}),t}};u.A(l,"subscribe",l.U),u.A(l,"extend",l.extend),u.A(l,"getSubscriptionsCount",l.yb),u.a.xa&&u.a.za(l,Function.prototype),u.P.fn=l,u.Db=function(e){return null!=e&&"function"==typeof e.U&&"function"==typeof e.notifySubscribers},u.b("subscribable",u.P),u.b("isSubscribable",u.Db),u.Y=u.k=function(){function e(e){n.push(r),r=e}function t(){r=n.pop()}var n=[],r,i=0;return{Ea:e,end:t,Jb:function(e){if(r){if(!u.Db(e))throw Error("Only subscribable things can act as dependencies");r.wa(e,e.Vb||(e.Vb=++i))}},B:function(n,r,i){try{return e(),n.apply(r,i||[])}finally{t()}},la:function(){if(r)return r.s.la()},ma:function(){if(r)return r.ma}}}(),u.b("computedContext",u.Y),u.b("computedContext.getDependenciesCount",u.Y.la),u.b("computedContext.isInitial",u.Y.ma),u.b("computedContext.isSleeping",u.Y.Ac),u.p=function(e){function t(){return 0<arguments.length?(t.Pa(n,arguments[0])&&(t.X(),n=arguments[0],t.W()),this):(u.k.Jb(t),n)}var n=e;return u.P.call(t),u.a.Aa(t,u.p.fn),t.v=function(){return n},t.W=function(){t.notifySubscribers(n)},t.X=function(){t.notifySubscribers(n,"beforeChange")},u.A(t,"peek",t.v),u.A(t,"valueHasMutated",t.W),u.A(t,"valueWillMutate",t.X),t},u.p.fn={equalityComparer:n};var c=u.p.rc="__ko_proto__";u.p.fn[c]=u.p,u.a.xa&&u.a.za(u.p.fn,u.P.fn),u.Ma=function(e,t){return null===e||e===p||e[c]===p?!1:e[c]===t?!0:u.Ma(e[c],t)},u.C=function(e){return u.Ma(e,u.p)},u.Ra=function(e){return"function"==typeof e&&e[c]===u.p||"function"==typeof e&&e[c]===u.j&&e.hc?!0:!1},u.b("observable",u.p),u.b("isObservable",u.C),u.b("isWriteableObservable",u.Ra),u.b("isWritableObservable",u.Ra),u.aa=function(e){e=e||[];if("object"==typeof e&&"length"in e)return e=u.p(e),u.a.Aa(e,u.aa.fn),e.extend({trackArrayChanges:!0});throw Error("The argument passed when initializing an observable array must be an array, or null, or undefined.")},u.aa.fn={remove:function(e){for(var t=this.v(),n=[],r="function"!=typeof e||u.C(e)?function(t){return t===e}:e,i=0;i<t.length;i++){var s=t[i];r(s)&&(0===n.length&&this.X(),n.push(s),t.splice(i,1),i--)}return n.length&&this.W(),n},removeAll:function(e){if(e===p){var t=this.v(),n=t.slice(0);return this.X(),t.splice(0,t.length),this.W(),n}return e?this.remove(function(t){return 0<=u.a.m(e,t)}):[]},destroy:function(e){var t=this.v(),n="function"!=typeof e||u.C(e)?function(t){return t===e}:e;this.X();for(var r=t.length-1;0<=r;r--)n(t[r])&&(t[r]._destroy=!0);this.W()},destroyAll:function(e){return e===p?this.destroy(function(){return!0}):e?this.destroy(function(t){return 0<=u.a.m(e,t)}):[]},indexOf:function(e){var t=this();return u.a.m(t,e)},replace:function(e,t){var n=this.indexOf(e);0<=n&&(this.X(),this.v()[n]=t,this.W())}},u.a.u("pop push reverse shift sort splice unshift".split(" "),function(e){u.aa.fn[e]=function(){var t=this.v();return this.X(),this.sb(t,e,arguments),t=t[e].apply(t,arguments),this.W(),t}}),u.a.u(["slice"],function(e){u.aa.fn[e]=function(){var t=this();return t[e].apply(t,arguments)}}),u.a.xa&&u.a.za(u.aa.fn,u.p.fn),u.b("observableArray",u.aa);var h="arrayChange";u.La.trackArrayChanges=function(e){function t(){if(!n){n=!0;var t=e.notifySubscribers;e.notifySubscribers=function(e,n){return n&&n!==f||++i,t.apply(this,arguments)};var s=[].concat(e.v()||[]);r=null,e.U(function(t){t=[].concat(t||[]);if(e.Ab(h)){var n;if(!r||1<i)r=u.a.Fa(s,t,{sparse:!0});n=r,n.length&&e.notifySubscribers(n,h)}s=t,r=null,i=0})}}if(!e.sb){var n=!1,r=null,i=0,s=e.U;e.U=e.subscribe=function(e,n,r){return r===h&&t(),s.apply(this,arguments)},e.sb=function(e,t,s){function o(e,t,n){return a[a.length]={status:e,value:t,index:n}}if(n&&!i){var a=[],f=e.length,l=s.length,c=0;switch(t){case"push":c=f;case"unshift":for(t=0;t<l;t++)o("added",s[t],c+t);break;case"pop":c=f-1;case"shift":f&&o("deleted",e[c],c);break;case"splice":t=Math.min(Math.max(0,0>s[0]?f+s[0]:s[0]),f);for(var f=1===l?f:Math.min(t+(s[1]||0),f),l=t+l-2,c=Math.max(f,l),h=[],p=[],d=2;t<c;++t,++d)t<f&&p.push(o("deleted",e[t],t)),t<l&&h.push(o("added",s[d],t));u.a.wb(p,h);break;default:return}r=a}}}},u.s=u.j=function(e,t,n){function r(){u.a.G(N,function(e,t){t.K()}),N={}}function i(){r(),C=0,m=!0,h=!1}function s(){var e=a.throttleEvaluation;e&&0<=e?(clearTimeout(k),k=setTimeout(o,e)):a.ib?a.ib():o()}function o(e){if(d){if(y)throw Error("A 'pure' computed must not be called recursively")}else if(!m){if(x&&x()){if(!v){T();return}}else v=!1;d=!0;if(b)try{var n={};u.k.Ea({wa:function(e,t){n[t]||(n[t]=1,++C)},s:a,ma:p}),C=0,c=g.call(t)}finally{u.k.end(),d=!1}else try{var r=N,i=C;u.k.Ea({wa:function(e,t){m||(i&&r[t]?(N[t]=r[t],++C,delete r[t],--i):N[t]||(N[t]=e.U(s),++C))},s:a,ma:y?p:!C}),N={},C=0;try{var o=t?g.call(t):g()}finally{u.k.end(),i&&u.a.G(r,function(e,t){t.K()}),h=!1}a.Pa(c,o)&&(a.notifySubscribers(c,"beforeChange"),c=o,!0!==e&&a.notifySubscribers(c))}finally{d=!1}C||T()}}function a(){if(0<arguments.length){if("function"!=typeof w)throw Error("Cannot write a value to a ko.computed unless you specify a 'write' option. If you wish to read the current value, don't pass any parameters.");return w.apply(t,arguments),this}return u.k.Jb(a),h&&o(!0),c}function f(){return h&&!C&&o(!0),c}function l(){return h||0<C}var c,h=!0,d=!1,v=!1,m=!1,g=e,y=!1,b=!1;g&&"object"==typeof g?(n=g,g=n.read):(n=n||{},g||(g=n.read));if("function"!=typeof g)throw Error("Pass a function that returns the value of the ko.computed");var w=n.write,E=n.disposeWhenNodeIsRemoved||n.o||null,S=n.disposeWhen||n.Ia,x=S,T=i,N={},C=0,k=null;t||(t=n.owner),u.P.call(a),u.a.Aa(a,u.j.fn),a.v=f,a.la=function(){return C},a.hc="function"==typeof n.write,a.K=function(){T()},a.Z=l;var L=a.Ta;return a.Ta=function(e){L.call(a,e),a.ib=function(){a.kb(c),h=!0,a.lb(a)}},n.pure?(b=y=!0,a.va=function(){b&&(b=!1,o(!0))},a.nb=function(){a.yb()||(r(),b=h=!0)}):n.deferEvaluation&&(a.va=function(){f(),delete a.va}),u.A(a,"peek",a.v),u.A(a,"dispose",a.K),u.A(a,"isActive",a.Z),u.A(a,"getDependenciesCount",a.la),E&&(v=!0,E.nodeType&&(x=function(){return!u.a.Ja(E)||S&&S()})),b||n.deferEvaluation||o(),E&&l()&&E.nodeType&&(T=function(){u.a.w.Kb(E,T),i()},u.a.w.da(E,T)),a},u.jc=function(e){return u.Ma(e,u.j)},l=u.p.rc,u.j[l]=u.p,u.j.fn={equalityComparer:n},u.j.fn[l]=u.j,u.a.xa&&u.a.za(u.j.fn,u.P.fn),u.b("dependentObservable",u.j),u.b("computed",u.j),u.b("isComputed",u.jc),u.Ib=function(e,t){return"function"==typeof e?u.s(e,t,{pure:!0}):(e=u.a.extend({},e),e.pure=!0,u.s(e,t))},u.b("pureComputed",u.Ib),function(){function e(r,i,s){s=s||new n,r=i(r);if("object"!=typeof r||null===r||r===p||r instanceof Date||r instanceof String||r instanceof Number||r instanceof Boolean)return r;var o=r instanceof Array?[]:{};return s.save(r,o),t(r,function(t){var n=i(r[t]);switch(typeof n){case"boolean":case"number":case"string":case"function":o[t]=n;break;case"object":case"undefined":var u=s.get(n);o[t]=u!==p?u:e(n,i,s)}}),o}function t(e,t){if(e instanceof Array){for(var n=0;n<e.length;n++)t(n);"function"==typeof e.toJSON&&t("toJSON")}else for(n in e)t(n)}function n(){this.keys=[],this.hb=[]}u.Qb=function(t){if(0==arguments.length)throw Error("When calling ko.toJS, pass the object you want to convert.");return e(t,function(e){for(var t=0;u.C(e)&&10>t;t++)e=e();return e})},u.toJSON=function(e,t,n){return e=u.Qb(e),u.a.eb(e,t,n)},n.prototype={save:function(e,t){var n=u.a.m(this.keys,e);0<=n?this.hb[n]=t:(this.keys.push(e),this.hb.push(t))},get:function(e){return e=u.a.m(this.keys,e),0<=e?this.hb[e]:p}}}(),u.b("toJS",u.Qb),u.b("toJSON",u.toJSON),function(){u.i={q:function(e){switch(u.a.t(e)){case"option":return!0===e.__ko__hasDomDataOptionValue__?u.a.e.get(e,u.d.options.Va):7>=u.a.L?e.getAttributeNode("value")&&e.getAttributeNode("value").specified?e.value:e.text:e.value;case"select":return 0<=e.selectedIndex?u.i.q(e.options[e.selectedIndex]):p;default:return e.value}},ca:function(e,t,n){switch(u.a.t(e)){case"option":switch(typeof t){case"string":u.a.e.set(e,u.d.options.Va,p),"__ko__hasDomDataOptionValue__"in e&&delete e.__ko__hasDomDataOptionValue__,e.value=t;break;default:u.a.e.set(e,u.d.options.Va,t),e.__ko__hasDomDataOptionValue__=!0,e.value="number"==typeof t?t:""}break;case"select":if(""===t||null===t)t=p;for(var r=-1,i=0,s=e.options.length,o;i<s;++i)if(o=u.i.q(e.options[i]),o==t||""==o&&t===p){r=i;break}if(n||0<=r||t===p&&1<e.size)e.selectedIndex=r;break;default:if(null===t||t===p)t="";e.value=t}}}}(),u.b("selectExtensions",u.i),u.b("selectExtensions.readValue",u.i.q),u.b("selectExtensions.writeValue",u.i.ca),u.h=function(){function e(e){e=u.a.cb(e),123===e.charCodeAt(0)&&(e=e.slice(1,-1));var t=[],n=e.match(r),o,a,f=0;if(n){n.push(",");for(var l=0,c;c=n[l];++l){var h=c.charCodeAt(0);if(44===h){if(0>=f){o&&t.push(a?{key:o,value:a.join("")}:{unknown:o}),o=a=f=0;continue}}else if(58===h){if(!a)continue}else if(47===h&&l&&1<c.length)(h=n[l-1].match(i))&&!s[h[0]]&&(e=e.substr(e.indexOf(c)+1),n=e.match(r),n.push(","),l=-1,c="/");else if(40===h||123===h||91===h)++f;else if(41===h||125===h||93===h)--f;else if(!o&&!a){o=34===h||39===h?c.slice(1,-1):c;continue}a?a.push(c):a=[c]}}return t}var t=["true","false","null","undefined"],n=/^(?:[$_a-z][$\w]*|(.+)(\.\s*[$_a-z][$\w]*|\[.+\]))$/i,r=RegExp("\"(?:[^\"\\\\]|\\\\.)*\"|'(?:[^'\\\\]|\\\\.)*'|/(?:[^/\\\\]|\\\\.)*/w*|[^\\s:,/][^,\"'{}()/:[\\]]*[^\\s,\"'{}()/:[\\]]|[^\\s]","g"),i=/[\])"'A-Za-z0-9_$]+$/,s={"in":1,"return":1,"typeof":1},o={};return{ha:[],V:o,Wa:e,ya:function(r,i){function s(e,r){var i;if(!c){var h=u.getBindingHandler(e);if(h&&h.preprocess&&!(r=h.preprocess(r,e,s)))return;if(h=o[e])i=r,0<=u.a.m(t,i)?i=!1:(h=i.match(n),i=null===h?!1:h[1]?"Object("+h[1]+")"+h[2]:i),h=i;h&&f.push("'"+e+"':function(_z){"+i+"=_z}")}l&&(r="function(){return "+r+" }"),a.push("'"+e+"':"+r)}i=i||{};var a=[],f=[],l=i.valueAccessors,c=i.bindingParams,h="string"==typeof r?e(r):r;return u.a.u(h,function(e){s(e.key||e.unknown,e.value)}),f.length&&s("_ko_property_writers","{"+f.join(",")+" }"),a.join(",")},lc:function(e,t){for(var n=0;n<e.length;n++)if(e[n].key==t)return!0;return!1},pa:function(e,t,n,r,i){e&&u.C(e)?!u.Ra(e)||i&&e.v()===r||e(r):(e=t.get("_ko_property_writers"))&&e[n]&&e[n](r)}}}(),u.b("expressionRewriting",u.h),u.b("expressionRewriting.bindingRewriteValidators",u.h.ha),u.b("expressionRewriting.parseObjectLiteral",u.h.Wa),u.b("expressionRewriting.preProcessBindings",u.h.ya),u.b("expressionRewriting._twoWayBindings",u.h.V),u.b("jsonExpressionRewriting",u.h),u.b("jsonExpressionRewriting.insertPropertyAccessorsIntoJson",u.h.ya),function(){function e(e){return 8==e.nodeType&&s.test(i?e.text:e.nodeValue)}function t(e){return 8==e.nodeType&&o.test(i?e.text:e.nodeValue)}function n(n,r){for(var i=n,s=1,o=[];i=i.nextSibling;){if(t(i)&&(s--,0===s))return o;o.push(i),e(i)&&s++}if(!r)throw Error("Cannot find closing comment tag to match: "+n.nodeValue);return null}function r(e,t){var r=n(e,t);return r?0<r.length?r[r.length-1].nextSibling:e.nextSibling:null}var i=v&&"<!--test-->"===v.createComment("test").text,s=i?/^\x3c!--\s*ko(?:\s+([\s\S]+))?\s*--\x3e$/:/^\s*ko(?:\s+([\s\S]+))?\s*$/,o=i?/^\x3c!--\s*\/ko\s*--\x3e$/:/^\s*\/ko\s*$/,a={ul:!0,ol:!0};u.f={Q:{},childNodes:function(t){return e(t)?n(t):t.childNodes},ja:function(t){if(e(t)){t=u.f.childNodes(t);for(var n=0,r=t.length;n<r;n++)u.removeNode(t[n])}else u.a.Ka(t)},T:function(t,n){if(e(t)){u.f.ja(t);for(var r=t.nextSibling,i=0,s=n.length;i<s;i++)r.parentNode.insertBefore(n[i],r)}else u.a.T(t,n)},Hb:function(t,n){e(t)?t.parentNode.insertBefore(n,t.nextSibling):t.firstChild?t.insertBefore(n,t.firstChild):t.appendChild(n)},Bb:function(t,n,r){r?e(t)?t.parentNode.insertBefore(n,r.nextSibling):r.nextSibling?t.insertBefore(n,r.nextSibling):t.appendChild(n):u.f.Hb(t,n)},firstChild:function(n){return e(n)?!n.nextSibling||t(n.nextSibling)?null:n.nextSibling:n.firstChild},nextSibling:function(n){return e(n)&&(n=r(n)),n.nextSibling&&t(n.nextSibling)?null:n.nextSibling},gc:e,xc:function(e){return(e=(i?e.text:e.nodeValue).match(s))?e[1]:null},Fb:function(n){if(a[u.a.t(n)]){var i=n.firstChild;if(i)do if(1===i.nodeType){var s;s=i.firstChild;var o=null;if(s)do if(o)o.push(s);else if(e(s)){var f=r(s,!0);f?s=f:o=[s]}else t(s)&&(o=[s]);while(s=s.nextSibling);if(s=o)for(o=i.nextSibling,f=0;f<s.length;f++)o?n.insertBefore(s[f],o):n.appendChild(s[f])}while(i=i.nextSibling)}}}}(),u.b("virtualElements",u.f),u.b("virtualElements.allowedBindings",u.f.Q),u.b("virtualElements.emptyNode",u.f.ja),u.b("virtualElements.insertAfter",u.f.Bb),u.b("virtualElements.prepend",u.f.Hb),u.b("virtualElements.setDomNodeChildren",u.f.T),function(){u.J=function(){this.Yb={}},u.a.extend(u.J.prototype,{nodeHasBindings:function(e){switch(e.nodeType){case 1:return null!=e.getAttribute("data-bind")||u.g.getComponentNameForNode(e);case 8:return u.f.gc(e);default:return!1}},getBindings:function(e,t){var n=this.getBindingsString(e,t),n=n?this.parseBindingsString(n,t,e):null;return u.g.mb(n,e,t,!1)},getBindingAccessors:function(e,t){var n=this.getBindingsString(e,t),n=n?this.parseBindingsString(n,t,e,{valueAccessors:!0}):null;return u.g.mb(n,e,t,!0)},getBindingsString:function(e){switch(e.nodeType){case 1:return e.getAttribute("data-bind");case 8:return u.f.xc(e);default:return null}},parseBindingsString:function(e,t,n,r){try{var i=this.Yb,s=e+(r&&r.valueAccessors||""),o;if(!(o=i[s])){var a,f="with($context){with($data||{}){return{"+u.h.ya(e,r)+"}}}";a=new Function("$context","$element",f),o=i[s]=a}return o(t,n)}catch(l){throw l.message="Unable to parse bindings.\nBindings value: "+e+"\nMessage: "+l.message,l}}}),u.J.instance=new u.J}(),u.b("bindingProvider",u.J),function(){function e(e){return function(){return e}}function t(e){return e()}function n(e){return u.a.na(u.k.B(e),function(t,n){return function(){return e()[n]}})}function r(e,t){return n(this.getBindings.bind(this,e,t))}function i(e,t,n){var r,i=u.f.firstChild(t),s=u.J.instance,a=s.preprocessNode;if(a){for(;r=i;)i=u.f.nextSibling(r),a.call(s,r);i=u.f.firstChild(t)}for(;r=i;)i=u.f.nextSibling(r),o(e,r,n)}function o(e,t,n){var r=!0,s=1===t.nodeType;s&&u.f.Fb(t);if(s&&n||u.J.instance.nodeHasBindings(t))r=f(t,null,e,n).shouldBindDescendants;r&&!c[u.a.t(t)]&&i(e,t,!s)}function a(e){var t=[],n={},r=[];return u.a.G(e,function i(s){if(!n[s]){var o=u.getBindingHandler(s);o&&(o.after&&(r.push(s),u.a.u(o.after,function(t){if(e[t]){if(-1!==u.a.m(r,t))throw Error("Cannot combine the following bindings, because they have a cyclic dependency: "+r.join(", "));i(t)}}),r.length--),t.push({key:s,zb:o})),n[s]=!0}}),t}function f(e,n,i,s){var o=u.a.e.get(e,h);if(!n){if(o)throw Error("You cannot apply bindings multiple times to the same element.");u.a.e.set(e,h,!0)}!o&&s&&u.Ob(e,i);var f;if(n&&"function"!=typeof n)f=n;else{var l=u.J.instance,c=l.getBindingAccessors||r,d=u.j(function(){return(f=n?n(i,e):c.call(l,e,i))&&i.I&&i.I(),f},null,{o:e});f&&d.Z()||(d=null)}var v;if(f){var m=d?function(e){return function(){return t(d()[e])}}:function(e){return f[e]},g=function(){return u.a.na(d?d():f,t)};g.get=function(e){return f[e]&&t(m(e))},g.has=function(e){return e in f},s=a(f),u.a.u(s,function(t){var n=t.zb.init,r=t.zb.update,s=t.key;if(8===e.nodeType&&!u.f.Q[s])throw Error("The binding '"+s+"' cannot be used with virtual elements");try{"function"==typeof n&&u.k.B(function(){var t=n(e,m(s),g,i.$data,i);if(t&&t.controlsDescendantBindings){if(v!==p)throw Error("Multiple bindings ("+v+" and "+s+") are trying to control descendant bindings of the same element. You cannot use these bindings together on the same element.");v=s}}),"function"==typeof r&&u.j(function(){r(e,m(s),g,i.$data,i)},null,{o:e})}catch(o){throw o.message='Unable to process binding "'+s+": "+f[s]+'"\nMessage: '+o.message,o}})}return{shouldBindDescendants:v===p}}function l(e){return e&&e instanceof u.N?e:new u.N(e)}u.d={};var c={script:!0};u.getBindingHandler=function(e){return u.d[e]},u.N=function(e,t,n,r){var i=this,s="function"==typeof e&&!u.C(e),o,a=u.j(function(){var o=s?e():e,f=u.a.c(o);return t?(t.I&&t.I(),u.a.extend(i,t),a&&(i.I=a)):(i.$parents=[],i.$root=f,i.ko=u),i.$rawData=o,i.$data=f,n&&(i[n]=f),r&&r(i,t,f),i.$data},null,{Ia:function(){return o&&!u.a.ob(o)},o:!0});a.Z()&&(i.I=a,a.equalityComparer=null,o=[],a.Tb=function(e){o.push(e),u.a.w.da(e,function(e){u.a.ua(o,e),o.length||(a.K(),i.I=a=p)})})},u.N.prototype.createChildContext=function(e,t,n){return new u.N(e,this,t,function(e,t){e.$parentContext=t,e.$parent=t.$data,e.$parents=(t.$parents||[]).slice(0),e.$parents.unshift(e.$parent),n&&n(e)})},u.N.prototype.extend=function(e){return new u.N(this.I||this.$data,this,null,function(t,n){t.$rawData=n.$rawData,u.a.extend(t,"function"==typeof e?e():e)})};var h=u.a.e.F(),d=u.a.e.F();u.Ob=function(e,t){if(2!=arguments.length)return u.a.e.get(e,d);u.a.e.set(e,d,t),t.I&&t.I.Tb(e)},u.ra=function(e,t,n){return 1===e.nodeType&&u.f.Fb(e),f(e,t,l(n),!0)},u.Wb=function(t,r,i){return i=l(i),u.ra(t,"function"==typeof r?n(r.bind(null,i,t)):u.a.na(r,e),i)},u.Ca=function(e,t){1!==t.nodeType&&8!==t.nodeType||i(l(e),t,!0)},u.pb=function(e,t){!w&&s.jQuery&&(w=s.jQuery);if(t&&1!==t.nodeType&&8!==t.nodeType)throw Error("ko.applyBindings: first parameter should be your view model; second parameter should be a DOM node");t=t||s.document.body,o(l(e),t,!0)},u.Ha=function(e){switch(e.nodeType){case 1:case 8:var t=u.Ob(e);if(t)return t;if(e.parentNode)return u.Ha(e.parentNode)}return p},u.$b=function(e){return(e=u.Ha(e))?e.$data:p},u.b("bindingHandlers",u.d),u.b("applyBindings",u.pb),u.b("applyBindingsToDescendants",u.Ca),u.b("applyBindingAccessorsToNode",u.ra),u.b("applyBindingsToNode",u.Wb),u.b("contextFor",u.Ha),u.b("dataFor",u.$b)}(),function(e){function t(t,r){var o=i.hasOwnProperty(t)?i[t]:e,a;o||(o=i[t]=new u.P,n(t,function(e){s[t]=e,delete i[t],a?o.notifySubscribers(e):setTimeout(function(){o.notifySubscribers(e)},0)}),a=!0),o.U(r)}function n(e,t){r("getConfig",[e],function(n){n?r("loadComponent",[e,n],function(e){t(e)}):t(null)})}function r(t,n,i,s){s||(s=u.g.loaders.slice(0));var o=s.shift();if(o){var a=o[t];if(a){var f=!1;if(a.apply(o,n.concat(function(e){f?i(null):null!==e?i(e):r(t,n,i,s)}))!==e&&(f=!0,!o.suppressLoaderExceptions))throw Error("Component loaders must supply values by invoking the callback, not by returning values synchronously.")}else r(t,n,i,s)}else i(null)}var i={},s={};u.g={get:function(n,r){var i=s.hasOwnProperty(n)?s[n]:e;i?setTimeout(function(){r(i)},0):t(n,r)},tb:function(e){delete s[e]},jb:r},u.g.loaders=[],u.b("components",u.g),u.b("components.get",u.g.get),u.b("components.clearCachedDefinition",u.g.tb)}(),function(){function e(e,t,n,r){function i(){0===--a&&r(s)}var s={},a=2,f=n.template;n=n.viewModel,f?o(t,f,function(t){u.g.jb("loadTemplate",[e,t],function(e){s.template=e,i()})}):i(),n?o(t,n,function(t){u.g.jb("loadViewModel",[e,t],function(e){s[l]=e,i()})}):i()}function n(e,t,r){if("function"==typeof t)r(function(e){return new t(e)});else if("function"==typeof t[l])r(t[l]);else if("instance"in t){var i=t.instance;r(function(){return i})}else"viewModel"in t?n(e,t.viewModel,r):e("Unknown viewModel value: "+t)}function r(e){switch(u.a.t(e)){case"script":return u.a.ba(e.text);case"textarea":return u.a.ba(e.value);case"template":if(i(e.content))return u.a.ia(e.content.childNodes)}return u.a.ia(e.childNodes)}function i(e){return s.DocumentFragment?e instanceof DocumentFragment:e&&11===e.nodeType}function o(e,n,r){"string"==typeof n.require?t||s.require?(t||s.require)([n.require],r):e("Uses require, but no AMD loader is present"):r(n)}function a(e){return function(t){throw Error("Component '"+e+"': "+t)}}var f={};u.g.tc=function(e,t){if(!t)throw Error("Invalid configuration for "+e);if(u.g.Qa(e))throw Error("Component "+e+" is already registered");f[e]=t},u.g.Qa=function(e){return e in f},u.g.wc=function(e){delete f[e],u.g.tb(e)},u.g.ub={getConfig:function(e,t){t(f.hasOwnProperty(e)?f[e]:null)},loadComponent:function(t,n,r){var i=a(t);o(i,n,function(n){e(t,i,n,r)})},loadTemplate:function(e,t,n){e=a(e);if("string"==typeof t)n(u.a.ba(t));else if(t instanceof Array)n(t);else if(i(t))n(u.a.S(t.childNodes));else if(t.element)if(t=t.element,s.HTMLElement?t instanceof HTMLElement:t&&t.tagName&&1===t.nodeType)n(r(t));else if("string"==typeof t){var o=v.getElementById(t);o?n(r(o)):e("Cannot find element with ID "+t)}else e("Unknown element type: "+t);else e("Unknown template value: "+t)},loadViewModel:function(e,t,r){n(a(e),t,r)}};var l="createViewModel";u.b("components.register",u.g.tc),u.b("components.isRegistered",u.g.Qa),u.b("components.unregister",u.g.wc),u.b("components.defaultLoader",u.g.ub),u.g.loaders.push(u.g.ub),u.g.Ub=f}(),function(){function e(e,n){var r=e.getAttribute("params");if(r){var r=t.parseBindingsString(r,n,e,{valueAccessors:!0,bindingParams:!0}),r=u.a.na(r,function(t){return u.s(t,null,{o:e})}),i=u.a.na(r,function(t){return t.Z()?u.s(function(){return u.a.c(t())},null,{o:e}):t.v()});return i.hasOwnProperty("$raw")||(i.$raw=r),i}return{$raw:{}}}u.g.getComponentNameForNode=function(e){return e=u.a.t(e),u.g.Qa(e)&&e},u.g.mb=function(t,n,r,i){if(1===n.nodeType){var s=u.g.getComponentNameForNode(n);if(s){t=t||{};if(t.component)throw Error('Cannot use the "component" binding on a custom element matching a component');var o={name:s,params:e(n,r)};t.component=i?function(){return o}:o}}return t};var t=new u.J;9>u.a.L&&(u.g.register=function(e){return function(t){return v.createElement(t),e.apply(this,arguments)}}(u.g.register),v.createDocumentFragment=function(e){return function(){var t=e(),n=u.g.Ub,r;for(r in n)n.hasOwnProperty(r)&&t.createElement(r);return t}}(v.createDocumentFragment))}(),function(){var e=0;u.d.component={init:function(t,n,r,i,s){function o(){var e=a&&a.dispose;"function"==typeof e&&e.call(a),f=null}var a,f;return u.a.w.da(t,o),u.s(function(){var r=u.a.c(n()),i,l;"string"==typeof r?i=r:(i=u.a.c(r.name),l=u.a.c(r.params));if(!i)throw Error("No component name specified");var c=f=++e;u.g.get(i,function(e){if(f===c){o();if(!e)throw Error("Unknown component '"+i+"'");var n=e.template;if(!n)throw Error("Component '"+i+"' has no template");n=u.a.ia(n),u.f.T(t,n);var n=l,r=e.createViewModel;e=r?r.call(e,n,{element:t}):n,n=s.createChildContext(e),a=e,u.Ca(n,t)}})},null,{o:t}),{controlsDescendantBindings:!0}}},u.f.Q.component=!0}();var d={"class":"className","for":"htmlFor"};u.d.attr={update:function(e,t){var n=u.a.c(t())||{};u.a.G(n,function(t,n){n=u.a.c(n);var r=!1===n||null===n||n===p;r&&e.removeAttribute(t),8>=u.a.L&&t in d?(t=d[t],r?e.removeAttribute(t):e[t]=n):r||e.setAttribute(t,n.toString()),"name"===t&&u.a.Mb(e,r?"":n.toString())})}},function(){u.d.checked={after:["value","attr"],init:function(e,t,n){function r(){var r=e.checked,i=c?s():r;if(!u.Y.ma()&&(!a||r)){var o=u.k.B(t);f?l!==i?(r&&(u.a.ea(o,i,!0),u.a.ea(o,l,!1)),l=i):u.a.ea(o,i,r):u.h.pa(o,n,"checked",i,!0)}}function i(){var n=u.a.c(t());e.checked=f?0<=u.a.m(n,s()):o?n:s()===n}var s=u.Ib(function(){return n.has("checkedValue")?u.a.c(n.get("checkedValue")):n.has("value")?u.a.c(n.get("value")):e.value}),o="checkbox"==e.type,a="radio"==e.type;if(o||a){var f=o&&u.a.c(t())instanceof Array,l=f?s():p,c=a||f;a&&!e.name&&u.d.uniqueName.init(e,function(){return!0}),u.s(r,null,{o:e}),u.a.n(e,"click",r),u.s(i,null,{o:e})}}},u.h.V.checked=!0,u.d.checkedValue={update:function(e,t){e.value=u.a.c(t())}}}(),u.d.css={update:function(e,t){var n=u.a.c(t());"object"==typeof n?u.a.G(n,function(t,n){n=u.a.c(n),u.a.Ba(e,t,n)}):(n=String(n||""),u.a.Ba(e,e.__ko__cssValue,!1),e.__ko__cssValue=n,u.a.Ba(e,n,!0))}},u.d.enable={update:function(e,t){var n=u.a.c(t());n&&e.disabled?e.removeAttribute("disabled"):n||e.disabled||(e.disabled=!0)}},u.d.disable={update:function(e,t){u.d.enable.update(e,function(){return!u.a.c(t())})}},u.d.event={init:function(e,t,n,r,i){var s=t()||{};u.a.G(s,function(s){"string"==typeof s&&u.a.n(e,s,function(e){var o,a=t()[s];if(a){try{var f=u.a.S(arguments);r=i.$data,f.unshift(r),o=a.apply(r,f)}finally{!0!==o&&(e.preventDefault?e.preventDefault():e.returnValue=!1)}!1===n.get(s+"Bubble")&&(e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation())}})})}},u.d.foreach={Eb:function(e){return function(){var t=e(),n=u.a.Xa(t);return!n||"number"==typeof n.length?{foreach:t,templateEngine:u.O.Oa}:(u.a.c(t),{foreach:n.data,as:n.as,includeDestroyed:n.includeDestroyed,afterAdd:n.afterAdd,beforeRemove:n.beforeRemove,afterRender:n.afterRender,beforeMove:n.beforeMove,afterMove:n.afterMove,templateEngine:u.O.Oa})}},init:function(e,t){return u.d.template.init(e,u.d.foreach.Eb(t))},update:function(e,t,n,r,i){return u.d.template.update(e,u.d.foreach.Eb(t),n,r,i)}},u.h.ha.foreach=!1,u.f.Q.foreach=!0,u.d.hasfocus={init:function(e,t,n){function r(r){e.__ko_hasfocusUpdating=!0;var i=e.ownerDocument;if("activeElement"in i){var s;try{s=i.activeElement}catch(o){s=i.body}r=s===e}i=t(),u.h.pa(i,n,"hasfocus",r,!0),e.__ko_hasfocusLastValue=r,e.__ko_hasfocusUpdating=!1}var i=r.bind(null,!0),s=r.bind(null,!1);u.a.n(e,"focus",i),u.a.n(e,"focusin",i),u.a.n(e,"blur",s),u.a.n(e,"focusout",s)},update:function(e,t){var n=!!u.a.c(t());e.__ko_hasfocusUpdating||e.__ko_hasfocusLastValue===n||(n?e.focus():e.blur(),u.k.B(u.a.oa,null,[e,n?"focusin":"focusout"]))}},u.h.V.hasfocus=!0,u.d.hasFocus=u.d.hasfocus,u.h.V.hasFocus=!0,u.d.html={init:function(){return{controlsDescendantBindings:!0}},update:function(e,t){u.a.$a(e,t())}},o("if"),o("ifnot",!1,!0),o("with",!0,!1,function(e,t){return e.createChildContext(t)});var m={};u.d.options={init:function(e){if("select"!==u.a.t(e))throw Error("options binding applies only to SELECT elements");for(;0<e.length;)e.remove(0);return{controlsDescendantBindings:!0}},update:function(e,t,n){function r(){return u.a.ta(e.options,function(e){return e.selected})}function i(e,t,n){var r=typeof t;return"function"==r?t(e):"string"==r?e[t]:n}function s(t,n){if(c.length){var r=0<=u.a.m(c,u.i.q(n[0]));u.a.Nb(n[0],r),h&&!r&&u.k.B(u.a.oa,null,[e,"change"])}}var o=0!=e.length&&e.multiple?e.scrollTop:null,a=u.a.c(t()),f=n.get("optionsIncludeDestroyed");t={};var l,c;c=e.multiple?u.a.Da(r(),u.i.q):0<=e.selectedIndex?[u.i.q(e.options[e.selectedIndex])]:[],a&&("undefined"==typeof a.length&&(a=[a]),l=u.a.ta(a,function(e){return f||e===p||null===e||!u.a.c(e._destroy)}),n.has("optionsCaption")&&(a=u.a.c(n.get("optionsCaption")),null!==a&&a!==p&&l.unshift(m)));var h=!1;t.beforeRemove=function(t){e.removeChild(t)},a=s,n.has("optionsAfterRender")&&(a=function(e,t){s(0,t),u.k.B(n.get("optionsAfterRender"),null,[t[0],e!==m?e:p])}),u.a.Za(e,l,function(t,r,s){return s.length&&(c=s[0].selected?[u.i.q(s[0])]:[],h=!0),r=e.ownerDocument.createElement("option"),t===m?(u.a.bb(r,n.get("optionsCaption")),u.i.ca(r,p)):(s=i(t,n.get("optionsValue"),t),u.i.ca(r,u.a.c(s)),t=i(t,n.get("optionsText"),s),u.a.bb(r,t)),[r]},t,a),u.k.B(function(){n.get("valueAllowUnset")&&n.has("value")?u.i.ca(e,u.a.c(n.get("value")),!0):(e.multiple?c.length&&r().length<c.length:c.length&&0<=e.selectedIndex?u.i.q(e.options[e.selectedIndex])!==c[0]:c.length||0<=e.selectedIndex)&&u.a.oa(e,"change")}),u.a.dc(e),o&&20<Math.abs(o-e.scrollTop)&&(e.scrollTop=o)}},u.d.options.Va=u.a.e.F(),u.d.selectedOptions={after:["options","foreach"],init:function(e,t,n){u.a.n(e,"change",function(){var r=t(),i=[];u.a.u(e.getElementsByTagName("option"),function(e){e.selected&&i.push(u.i.q(e))}),u.h.pa(r,n,"selectedOptions",i)})},update:function(e,t){if("select"!=u.a.t(e))throw Error("values binding applies only to SELECT elements");var n=u.a.c(t());n&&"number"==typeof n.length&&u.a.u(e.getElementsByTagName("option"),function(e){var t=0<=u.a.m(n,u.i.q(e));u.a.Nb(e,t)})}},u.h.V.selectedOptions=!0,u.d.style={update:function(e,t){var n=u.a.c(t()||{});u.a.G(n,function(t,n){n=u.a.c(n);if(null===n||n===p||!1===n)n="";e.style[t]=n})}},u.d.submit={init:function(e,t,n,r,i){if("function"!=typeof t())throw Error("The value for a submit binding must be a function");u.a.n(e,"submit",function(n){var r,s=t();try{r=s.call(i.$data,e)}finally{!0!==r&&(n.preventDefault?n.preventDefault():n.returnValue=!1)}})}},u.d.text={init:function(){return{controlsDescendantBindings:!0}},update:function(e,t){u.a.bb(e,t())}},u.f.Q.text=!0,function(){if(s&&s.navigator)var e=function(e){if(e)return parseFloat(e[1])},t=s.opera&&s.opera.version&&parseInt(s.opera.version()),n=s.navigator.userAgent,r=e(n.match(/^(?:(?!chrome).)*version\/([^ ]*) safari/i)),i=e(n.match(/Firefox\/([^ ]*)/));if(10>u.a.L)var o=u.a.e.F(),a=u.a.e.F(),f=function(e){var t=this.activeElement;(t=t&&u.a.e.get(t,a))&&t(e)},l=function(e,t){var n=e.ownerDocument;u.a.e.get(n,o)||(u.a.e.set(n,o,!0),u.a.n(n,"selectionchange",f)),u.a.e.set(e,a,t)};u.d.textInput={init:function(e,n,s){function o(t,n){u.a.n(e,t,n)}function a(){var t=u.a.c(n());if(null===t||t===p)t="";v!==p&&t===v?setTimeout(a,4):e.value!==t&&(h=t,e.value=t)}function f(){d||(v=e.value,d=setTimeout(c,4))}function c(){clearTimeout(d),v=d=p;var t=e.value;h!==t&&(h=t,u.h.pa(n(),s,"textInput",t))}var h=e.value,d,v;10>u.a.L?(o("propertychange",function(e){"value"===e.propertyName&&c()}),8==u.a.L&&(o("keyup",c),o("keydown",c)),8<=u.a.L&&(l(e,c),o("dragend",f))):(o("input",c),5>r&&"textarea"===u.a.t(e)?(o("keydown",f),o("paste",f),o("cut",f)):11>t?o("keydown",f):4>i&&(o("DOMAutoComplete",c),o("dragdrop",c),o("drop",c))),o("change",c),u.s(a,null,{o:e})}},u.h.V.textInput=!0,u.d.textinput={preprocess:function(e,t,n){n("textInput",e)}}}(),u.d.uniqueName={init:function(e,t){if(t()){var n="ko_unique_"+ ++u.d.uniqueName.Zb;u.a.Mb(e,n)}}},u.d.uniqueName.Zb=0,u.d.value={after:["options","foreach"],init:function(e,t,n){if("input"!=e.tagName.toLowerCase()||"checkbox"!=e.type&&"radio"!=e.type){var r=["change"],i=n.get("valueUpdate"),s=!1,o=null;i&&("string"==typeof i&&(i=[i]),u.a.ga(r,i),r=u.a.rb(r));var a=function(){o=null,s=!1;var r=t(),i=u.i.q(e);u.h.pa(r,n,"value",i)};!u.a.L||"input"!=e.tagName.toLowerCase()||"text"!=e.type||"off"==e.autocomplete||e.form&&"off"==e.form.autocomplete||-1!=u.a.m(r,"propertychange")||(u.a.n(e,"propertychange",function(){s=!0}),u.a.n(e,"focus",function(){s=!1}),u.a.n(e,"blur",function(){s&&a()})),u.a.u(r,function(t){var n=a;u.a.vc(t,"after")&&(n=function(){o=u.i.q(e),setTimeout(a,0)},t=t.substring(5)),u.a.n(e,t,n)});var f=function(){var r=u.a.c(t()),i=u.i.q(e);if(null!==o&&r===o)setTimeout(f,0);else if(r!==i)if("select"===u.a.t(e)){var s=n.get("valueAllowUnset"),i=function(){u.i.ca(e,r,s)};i(),s||r===u.i.q(e)?setTimeout(i,0):u.k.B(u.a.oa,null,[e,"change"])}else u.i.ca(e,r)};u.s(f,null,{o:e})}else u.ra(e,{checkedValue:t})},update:function(){}},u.h.V.value=!0,u.d.visible={update:function(e,t){var n=u.a.c(t()),r="none"!=e.style.display;n&&!r?e.style.display="":!n&&r&&(e.style.display="none")}},function(e){u.d[e]={init:function(t,n,r,i,s){return u.d.event.init.call(this,t,function(){var t={};return t[e]=n(),t},r,i,s)}}}("click"),u.H=function(){},u.H.prototype.renderTemplateSource=function(){throw Error("Override renderTemplateSource")},u.H.prototype.createJavaScriptEvaluatorBlock=function(){throw Error("Override createJavaScriptEvaluatorBlock")},u.H.prototype.makeTemplateSource=function(e,t){if("string"==typeof e){t=t||v;var n=t.getElementById(e);if(!n)throw Error("Cannot find template with ID "+e);return new u.r.l(n)}if(1==e.nodeType||8==e.nodeType)return new u.r.fa(e);throw Error("Unknown template type: "+e)},u.H.prototype.renderTemplate=function(e,t,n,r){return e=this.makeTemplateSource(e,r),this.renderTemplateSource(e,t,n)},u.H.prototype.isTemplateRewritten=function(e,t){return!1===this.allowTemplateRewriting?!0:this.makeTemplateSource(e,t).data("isRewritten")},u.H.prototype.rewriteTemplate=function(e,t,n){e=this.makeTemplateSource(e,n),t=t(e.text()),e.text(t),e.data("isRewritten",!0)},u.b("templateEngine",u.H),u.fb=function(){function e(e,t,n,r){e=u.h.Wa(e);for(var i=u.h.ha,s=0;s<e.length;s++){var o=e[s].key;if(i.hasOwnProperty(o)){var a=i[o];if("function"==typeof a){if(o=a(e[s].value))throw Error(o)}else if(!a)throw Error("This template engine does not support the '"+o+"' binding within its templates")}}return n="ko.__tr_ambtns(function($context,$element){return(function(){return{ "+u.h.ya(e,{valueAccessors:!0})+" } })()},'"+n.toLowerCase()+"')",r.createJavaScriptEvaluatorBlock(n)+t}var t=/(<([a-z]+\d*)(?:\s+(?!data-bind\s*=\s*)[a-z0-9\-]+(?:=(?:\"[^\"]*\"|\'[^\']*\'))?)*\s+)data-bind\s*=\s*(["'])([\s\S]*?)\3/gi,n=/\x3c!--\s*ko\b\s*([\s\S]*?)\s*--\x3e/g;return{ec:function(e,t,n){t.isTemplateRewritten(e,n)||t.rewriteTemplate(e,function(e){return u.fb.nc(e,t)},n)},nc:function(r,i){return r.replace(t,function(t,n,r,s,o){return e(o,n,r,i)}).replace(n,function(t,n){return e(n,"<!-- ko -->","#comment",i)})},Xb:function(e,t){return u.D.Ua(function(n,r){var i=n.nextSibling;i&&i.nodeName.toLowerCase()===t&&u.ra(i,e,r)})}}}(),u.b("__tr_ambtns",u.fb.Xb),function(){u.r={},u.r.l=function(e){this.l=e},u.r.l.prototype.text=function(){var e=u.a.t(this.l),e="script"===e?"text":"textarea"===e?"value":"innerHTML";if(0==arguments.length)return this.l[e];var t=arguments[0];"innerHTML"===e?u.a.$a(this.l,t):this.l[e]=t};var e=u.a.e.F()+"_";u.r.l.prototype.data=function(t){if(1===arguments.length)return u.a.e.get(this.l,e+t);u.a.e.set(this.l,e+t,arguments[1])};var t=u.a.e.F();u.r.fa=function(e){this.l=e},u.r.fa.prototype=new u.r.l,u.r.fa.prototype.text=function(){if(0==arguments.length){var e=u.a.e.get(this.l,t)||{};return e.gb===p&&e.Ga&&(e.gb=e.Ga.innerHTML),e.gb}u.a.e.set(this.l,t,{gb:arguments[0]})},u.r.l.prototype.nodes=function(){if(0==arguments.length)return(u.a.e.get(this.l,t)||{}).Ga;u.a.e.set(this.l,t,{Ga:arguments[0]})},u.b("templateSources",u.r),u.b("templateSources.domElement",u.r.l),u.b("templateSources.anonymousTemplate",u.r.fa)}(),function(){function e(e,t,n){var r;for(t=u.f.nextSibling(t);e&&(r=e)!==t;)e=u.f.nextSibling(r),n(r,e)}function t(t,n){if(t.length){var r=t[0],i=t[t.length-1],s=r.parentNode,o=u.J.instance,a=o.preprocessNode;if(a){e(r,i,function(e,t){var n=e.previousSibling,s=a.call(o,e);s&&(e===r&&(r=s[0]||t),e===i&&(i=s[s.length-1]||n))}),t.length=0;if(!r)return;r===i?t.push(r):(t.push(r,i),u.a.ka(t,s))}e(r,i,function(e){1!==e.nodeType&&8!==e.nodeType||u.pb(n,e)}),e(r,i,function(e){1!==e.nodeType&&8!==e.nodeType||u.D.Sb(e,[n])}),u.a.ka(t,s)}}function n(e){return e.nodeType?e:0<e.length?e[0]:null}function r(e,r,s,o,a){a=a||{};var f=e&&n(e),f=f&&f.ownerDocument,l=a.templateEngine||i;u.fb.ec(s,l,f),s=l.renderTemplate(s,o,a,f);if("number"!=typeof s.length||0<s.length&&"number"!=typeof s[0].nodeType)throw Error("Template engine must return an array of DOM nodes");f=!1;switch(r){case"replaceChildren":u.f.T(e,s),f=!0;break;case"replaceNode":u.a.Lb(e,s),f=!0;break;case"ignoreTargetNode":break;default:throw Error("Unknown renderMode: "+r)}return f&&(t(s,o),a.afterRender&&u.k.B(a.afterRender,null,[s,o.$data])),s}var i;u.ab=function(e){if(!(e==p||e instanceof u.H))throw Error("templateEngine must inherit from ko.templateEngine");i=e},u.Ya=function(e,t,s,o,a){s=s||{};if((s.templateEngine||i)==p)throw Error("Set a template engine before calling renderTemplate");a=a||"replaceChildren";if(o){var f=n(o);return u.j(function(){var i=t&&t instanceof u.N?t:new u.N(u.a.c(t)),l=u.C(e)?e():"function"==typeof e?e(i.$data,i):e,i=r(o,a,l,i,s);"replaceNode"==a&&(o=i,f=n(o))},null,{Ia:function(){return!f||!u.a.Ja(f)},o:f&&"replaceNode"==a?f.parentNode:f})}return u.D.Ua(function(n){u.Ya(e,t,s,n,"replaceNode")})},u.uc=function(e,n,i,s,o){function a(e,n){t(n,l),i.afterRender&&i.afterRender(n,e)}function f(t,n){l=o.createChildContext(t,i.as,function(e){e.$index=n});var s=u.C(e)?e():"function"==typeof e?e(t,l):e;return r(null,"ignoreTargetNode",s,l,i)}var l;return u.j(function(){var e=u.a.c(n)||[];"undefined"==typeof e.length&&(e=[e]),e=u.a.ta(e,function(e){return i.includeDestroyed||e===p||null===e||!u.a.c(e._destroy)}),u.k.B(u.a.Za,null,[s,e,f,i,a])},null,{o:s})};var s=u.a.e.F();u.d.template={init:function(e,t){var n=u.a.c(t());return"string"==typeof n||n.name?u.f.ja(e):(n=u.f.childNodes(e),n=u.a.oc(n),(new u.r.fa(e)).nodes(n)),{controlsDescendantBindings:!0}},update:function(e,t,n,r,i){var o=t(),a;t=u.a.c(o),n=!0,r=null,"string"==typeof t?t={}:(o=t.name,"if"in t&&(n=u.a.c(t["if"])),n&&"ifnot"in t&&(n=!u.a.c(t.ifnot)),a=u.a.c(t.data)),"foreach"in t?r=u.uc(o||e,n&&t.foreach||[],t,e,i):n?(i="data"in t?i.createChildContext(a,t.as):i,r=u.Ya(o||e,i,t,e)):u.f.ja(e),i=r,(a=u.a.e.get(e,s))&&"function"==typeof a.K&&a.K(),u.a.e.set(e,s,i&&i.Z()?i:p)}},u.h.ha.template=function(e){return e=u.h.Wa(e),1==e.length&&e[0].unknown||u.h.lc(e,"name")?null:"This template engine does not support anonymous templates nested within its templates"},u.f.Q.template=!0}(),u.b("setTemplateEngine",u.ab),u.b("renderTemplate",u.Ya),u.a.wb=function(e,t,n){if(e.length&&t.length){var r,i,s,o,u;for(r=i=0;(!n||r<n)&&(o=e[i]);++i){for(s=0;u=t[s];++s)if(o.value===u.value){o.moved=u.index,u.moved=o.index,t.splice(s,1),r=s=0;break}r+=s}}},u.a.Fa=function(){function e(e,t,n,r,i){var s=Math.min,o=Math.max,a=[],f,l=e.length,c,h=t.length,p=h-l||1,d=l+h+1,v,m,g;for(f=0;f<=l;f++)for(m=v,a.push(v=[]),g=s(h,f+p),c=o(0,f-1);c<=g;c++)v[c]=c?f?e[f-1]===t[c-1]?m[c-1]:s(m[c]||d,v[c-1]||d)+1:c+1:f+1;s=[],o=[],p=[],f=l;for(c=h;f||c;)h=a[f][c]-1,c&&h===a[f][c-1]?o.push(s[s.length]={status:n,value:t[--c],index:c}):f&&h===a[f-1][c]?p.push(s[s.length]={status:r,value:e[--f],index:f}):(--c,--f,i.sparse||s.push({status:"retained",value:t[c]}));return u.a.wb(o,p,10*l),s.reverse()}return function(t,n,r){return r="boolean"==typeof r?{dontLimitMoves:r}:r||{},t=t||[],n=n||[],t.length<=n.length?e(t,n,"added","deleted",r):e(n,t,"deleted","added",r)}}(),u.b("utils.compareArrays",u.a.Fa),function(){function e(e,t,n,r,i){var s=[],o=u.j(function(){var o=t(n,i,u.a.ka(s,e))||[];0<s.length&&(u.a.Lb(s,o),r&&u.k.B(r,null,[n,o,i])),s.length=0,u.a.ga(s,o)},null,{o:e,Ia:function(){return!u.a.ob(s)}});return{$:s,j:o.Z()?o:p}}var t=u.a.e.F();u.a.Za=function(n,r,i,s,o){function a(e,t){S=c[t],g!==t&&(E[e]=S),S.Na(g++),u.a.ka(S.$,n),v.push(S),w.push(S)}function f(e,t){if(e)for(var n=0,r=t.length;n<r;n++)t[n]&&u.a.u(t[n].$,function(r){e(r,n,t[n].sa)})}r=r||[],s=s||{};var l=u.a.e.get(n,t)===p,c=u.a.e.get(n,t)||[],h=u.a.Da(c,function(e){return e.sa}),d=u.a.Fa(h,r,s.dontLimitMoves),v=[],m=0,g=0,y=[],w=[];r=[];for(var E=[],h=[],S,x=0,T,N;T=d[x];x++)switch(N=T.moved,T.status){case"deleted":N===p&&(S=c[m],S.j&&S.j.K(),y.push.apply(y,u.a.ka(S.$,n)),s.beforeRemove&&(r[x]=S,w.push(S))),m++;break;case"retained":a(x,m++);break;case"added":N!==p?a(x,N):(S={sa:T.value,Na:u.p(g++)},v.push(S),w.push(S),l||(h[x]=S))}f(s.beforeMove,E),u.a.u(y,s.beforeRemove?u.R:u.removeNode);for(var x=0,l=u.f.firstChild(n),C;S=w[x];x++){S.$||u.a.extend(S,e(n,i,S.sa,o,S.Na));for(m=0;d=S.$[m];l=d.nextSibling,C=d,m++)d!==l&&u.f.Bb(n,d,C);!S.ic&&o&&(o(S.sa,S.$,S.Na),S.ic=!0)}f(s.beforeRemove,r),f(s.afterMove,E),f(s.afterAdd,h),u.a.e.set(n,t,v)}}(),u.b("utils.setDomNodeChildrenFromArrayMapping",u.a.Za),u.O=function(){this.allowTemplateRewriting=!1},u.O.prototype=new u.H,u.O.prototype.renderTemplateSource=function(e){var t=(9>u.a.L?0:e.nodes)?e.nodes():null;return t?u.a.S(t.cloneNode(!0).childNodes):(e=e.text(),u.a.ba(e))},u.O.Oa=new u.O,u.ab(u.O.Oa),u.b("nativeTemplateEngine",u.O),function(){u.Sa=function(){var e=this.kc=function(){if(!w||!w.tmpl)return 0;try{if(0<=w.tmpl.tag.tmpl.open.toString().indexOf("__"))return 2}catch(e){}return 1}();this.renderTemplateSource=function(t,n,r){r=r||{};if(2>e)throw Error("Your version of jQuery.tmpl is too old. Please upgrade to jQuery.tmpl 1.0.0pre or later.");var i=t.data("precompiled");return i||(i=t.text()||"",i=w.template(null,"{{ko_with $item.koBindingContext}}"+i+"{{/ko_with}}"),t.data("precompiled",i)),t=[n.$data],n=w.extend({koBindingContext:n},r.templateOptions),n=w.tmpl(i,t,n),n.appendTo(v.createElement("div")),w.fragments={},n},this.createJavaScriptEvaluatorBlock=function(e){return"{{ko_code ((function() { return "+e+" })()) }}"},this.addTemplate=function(e,t){v.write("<script type='text/html' id='"+e+"'>"+t+"</script>")},0<e&&(w.tmpl.tag.ko_code={open:"__.push($1 || '');"},w.tmpl.tag.ko_with={open:"with($1) {",close:"} "})},u.Sa.prototype=new u.H;var e=new u.Sa;0<e.kc&&u.ab(e),u.b("jqueryTmplTemplateEngine",u.Sa)}()})})()}(),function(e){"function"==typeof require&&"object"==typeof exports&&"object"==typeof module?e(require("knockout"),exports):"function"==typeof define&&define.amd?define("knockoutMapping",["knockout","exports"],e):e(ko,ko.mapping={})}(function(e,t){function n(e,r){var i,s;for(s in r)if(r.hasOwnProperty(s)&&r[s])if(i=t.getType(e[s]),s&&e[s]&&"array"!==i&&"string"!==i)n(e[s],r[s]);else if("array"===t.getType(e[s])&&"array"===t.getType(r[s])){i=e;for(var o=s,u=e[s],a=r[s],f={},l=u.length-1;0<=l;--l)f[u[l]]=u[l];for(l=a.length-1;0<=l;--l)f[a[l]]=a[l];u=[],a=void 0;for(a in f)u.push(f[a]);i[o]=u}else e[s]=r[s]}function r(e,t){var r={};return n(r,e),n(r,t),r}function i(e,t){for(var n=r({},e),i=w.length-1;0<=i;i--){var o=w[i];n[o]&&(n[""]instanceof Object||(n[""]={}),n[""][o]=n[o],delete n[o])}return t&&(n.ignore=s(t.ignore,n.ignore),n.include=s(t.include,n.include),n.copy=s(t.copy,n.copy),n.observe=s(t.observe,n.observe)),n.ignore=s(n.ignore,x.ignore),n.include=s(n.include,x.include),n.copy=s(n.copy,x.copy),n.observe=s(n.observe,x.observe),n.mappedProperties=n.mappedProperties||{},n.copiedProperties=n.copiedProperties||{},n}function s(n,r){return"array"!==t.getType(n)&&(n="undefined"===t.getType(n)?[]:[n]),"array"!==t.getType(r)&&(r="undefined"===t.getType(r)?[]:[r]),e.utils.arrayGetDistinctValues(n.concat(r))}function o(n,i,s,a,p,d,g){var w="array"===t.getType(e.utils.unwrapObservable(i));d=d||"";if(t.isMapped(n)){var S=e.utils.unwrapObservable(n)[v];s=r(S,s)}var x=g||p,T=function(){return s[a]&&s[a].create instanceof Function},k=function(t){var n=y,r=e.dependentObservable;return e.dependentObservable=function(t,r,i){i=i||{},t&&"object"==typeof t&&(i=t);var s=i.deferEvaluation,o=!1;i.deferEvaluation=!0,t=new m(t,r,i);if(!s){var u=t,s=e.dependentObservable;e.dependentObservable=m,t=e.isWriteableObservable(u),e.dependentObservable=s,s=m({read:function(){return o||(e.utils.arrayRemoveItem(n,u),o=!0),u.apply(u,arguments)},write:t&&function(e){return u(e)},deferEvaluation:!0}),s.__DO=u,t=s,n.push(t)}return t},e.dependentObservable.fn=m.fn,e.computed=e.dependentObservable,t=e.utils.unwrapObservable(p)instanceof Array?s[a].create({data:t||i,parent:x,skip:E}):s[a].create({data:t||i,parent:x}),e.dependentObservable=r,e.computed=e.dependentObservable,t},L=function(){return s[a]&&s[a].update instanceof Function},A=function(t,n){var r={data:n||i,parent:x,target:e.utils.unwrapObservable(t)};return e.isWriteableObservable(t)&&(r.observable=t),s[a].update(r)};if(g=b.get(i))return g;a=a||"";if(w){var w=[],M=!1,_=function(e){return e};s[a]&&s[a].key&&(_=s[a].key,M=!0),e.isObservable(n)||(n=e.observableArray([]),n.mappedRemove=function(e){var t="function"==typeof e?e:function(t){return t===_(e)};return n.remove(function(e){return t(_(e))})},n.mappedRemoveAll=function(t){var r=l(t,_);return n.remove(function(t){return-1!=e.utils.arrayIndexOf(r,_(t))})},n.mappedDestroy=function(e){var t="function"==typeof e?e:function(t){return t===_(e)};return n.destroy(function(e){return t(_(e))})},n.mappedDestroyAll=function(t){var r=l(t,_);return n.destroy(function(t){return-1!=e.utils.arrayIndexOf(r,_(t))})},n.mappedIndexOf=function(t){var r=l(n(),_);return t=_(t),e.utils.arrayIndexOf(r,t)},n.mappedGet=function(e){return n()[n.mappedIndexOf(e)]},n.mappedCreate=function(t){if(-1!==n.mappedIndexOf(t))throw Error("There already is an object with the key that you specified.");var r=T()?k(t):t;return L()&&(t=A(r,t),e.isWriteableObservable(r)?r(t):r=t),n.push(r),r}),g=l(e.utils.unwrapObservable(n),_).sort(),S=l(i,_),M&&S.sort(),M=e.utils.compareArrays(g,S),g={};var D,B=e.utils.unwrapObservable(i),j={},q=!0,S=0;for(D=B.length;S<D;S++){var R=_(B[S]);if(void 0===R||R instanceof Object){q=!1;break}j[R]=B[S]}var B=[],U=0,S=0;for(D=M.length;S<D;S++){var R=M[S],z,W=d+"["+S+"]";switch(R.status){case"added":var X=q?j[R.value]:f(e.utils.unwrapObservable(i),R.value,_);z=o(void 0,X,s,a,n,W,p),T()||(z=e.utils.unwrapObservable(z)),W=u(e.utils.unwrapObservable(i),X,g),z===E?U++:B[W-U]=z,g[W]=!0;break;case"retained":X=q?j[R.value]:f(e.utils.unwrapObservable(i),R.value,_),z=f(n,R.value,_),o(z,X,s,a,n,W,p),W=u(e.utils.unwrapObservable(i),X,g),B[W]=z,g[W]=!0;break;case"deleted":z=f(n,R.value,_)}w.push({event:R.status,item:z})}n(B),s[a]&&s[a].arrayChanged&&e.utils.arrayForEach(w,function(e){s[a].arrayChanged(e.event,e.item)})}else if(h(i)){n=e.utils.unwrapObservable(n);if(!n){if(T())return M=k(),L()&&(M=A(M)),M;if(L())return A(M);n={}}L()&&(n=A(n)),b.save(i,n);if(L())return n;c(i,function(t){var r=d.length?d+"."+t:t;if(-1==e.utils.arrayIndexOf(s.ignore,r))if(-1!=e.utils.arrayIndexOf(s.copy,r))n[t]=i[t];else if("object"!=typeof i[t]&&"array"!=typeof i[t]&&0<s.observe.length&&-1==e.utils.arrayIndexOf(s.observe,r))n[t]=i[t],s.copiedProperties[r]=!0;else{var u=b.get(i[t]),a=o(n[t],i[t],s,t,n,r,n),u=u||a;0<s.observe.length&&-1==e.utils.arrayIndexOf(s.observe,r)?(n[t]=u(),s.copiedProperties[r]=!0):(e.isWriteableObservable(n[t])?(u=e.utils.unwrapObservable(u),n[t]()!==u)&&n[t](u):(u=void 0===n[t]?u:e.utils.unwrapObservable(u),n[t]=u),s.mappedProperties[r]=!0)}})}else switch(t.getType(i)){case"function":L()?e.isWriteableObservable(i)?(i(A(i)),n=i):n=A(i):n=i;break;default:if(e.isWriteableObservable(n))return z=L()?A(n):e.utils.unwrapObservable(i),n(z),z;T()||L(),n=T()?k():e.observable(e.utils.unwrapObservable(i)),L()&&n(A(n))}return n}function u(e,t,n){for(var r=0,i=e.length;r<i;r++)if(!0!==n[r]&&e[r]===t)return r;return null}function a(n,r){var i;return r&&(i=r(n)),"undefined"===t.getType(i)&&(i=n),e.utils.unwrapObservable(i)}function f(t,n,r){t=e.utils.unwrapObservable(t);for(var i=0,s=t.length;i<s;i++){var o=t[i];if(a(o,r)===n)return o}throw Error("When calling ko.update*, the key '"+n+"' was not found!")}function l(t,n){return e.utils.arrayMap(e.utils.unwrapObservable(t),function(e){return n?a(e,n):e})}function c(e,n){if("array"===t.getType(e))for(var r=0;r<e.length;r++)n(r);else for(r in e)n(r)}function h(e){var n=t.getType(e);return("object"===n||"array"===n)&&null!==e}function p(){var t=[],n=[];this.save=function(r,i){var s=e.utils.arrayIndexOf(t,r);0<=s?n[s]=i:(t.push(r),n.push(i))},this.get=function(r){return r=e.utils.arrayIndexOf(t,r),0<=r?n[r]:void 0}}function d(){var e={},t=function(t){var n;try{n=t}catch(r){n="$$$"}return t=e[n],void 0===t&&(t=new p,e[n]=t),t};this.save=function(e,n){t(e).save(e,n)},this.get=function(e){return t(e).get(e)}}var v="__ko_mapping__",m=e.dependentObservable,g=0,y,b,w=["create","update","key","arrayChanged"],E={},S={include:["_destroy"],ignore:[],copy:[],observe:[]},x=S;t.isMapped=function(t){return(t=e.utils.unwrapObservable(t))&&t[v]},t.fromJS=function(e){if(0==arguments.length)throw Error("When calling ko.fromJS, pass the object you want to convert.");try{g++||(y=[],b=new d);var t,n;2==arguments.length&&(arguments[1][v]?n=arguments[1]:t=arguments[1]),3==arguments.length&&(t=arguments[1],n=arguments[2]),n&&(t=r(t,n[v])),t=i(t);var s=o(n,e,t);n&&(s=n);if(!--g)for(;y.length;){var u=y.pop();u&&(u(),u.__DO.throttleEvaluation=u.throttleEvaluation)}return s[v]=r(s[v],t),s}catch(a){throw g=0,a}},t.fromJSON=function(n){var r=e.utils.parseJson(n);return arguments[0]=r,t.fromJS.apply(this,arguments)},t.updateFromJS=function(){throw Error("ko.mapping.updateFromJS, use ko.mapping.fromJS instead. Please note that the order of parameters is different!")},t.updateFromJSON=function(){throw Error("ko.mapping.updateFromJSON, use ko.mapping.fromJSON instead. Please note that the order of parameters is different!")},t.toJS=function(n,r){x||t.resetDefaultOptions();if(0==arguments.length)throw Error("When calling ko.mapping.toJS, pass the object you want to convert.");if("array"!==t.getType(x.ignore))throw Error("ko.mapping.defaultOptions().ignore should be an array.");if("array"!==t.getType(x.include))throw Error("ko.mapping.defaultOptions().include should be an array.");if("array"!==t.getType(x.copy))throw Error("ko.mapping.defaultOptions().copy should be an array.");return r=i(r,n[v]),t.visitModel(n,function(t){return e.utils.unwrapObservable(t)},r)},t.toJSON=function(n,r){var i=t.toJS(n,r);return e.utils.stringifyJson(i)},t.defaultOptions=function(){if(!(0<arguments.length))return x;x=arguments[0]},t.resetDefaultOptions=function(){x={include:S.include.slice(0),ignore:S.ignore.slice(0),copy:S.copy.slice(0)}},t.getType=function(e){if(e&&"object"==typeof e){if(e.constructor===Date)return"date";if(e.constructor===Array)return"array"}return typeof e},t.visitModel=function(n,r,s){s=s||{},s.visitedObjects=s.visitedObjects||new d;var o,u=e.utils.unwrapObservable(n);if(!h(u))return r(n,s.parentName);s=i(s,u[v]),r(n,s.parentName),o="array"===t.getType(u)?[]:{},s.visitedObjects.save(n,o);var a=s.parentName;return c(u,function(n){if(!s.ignore||-1==e.utils.arrayIndexOf(s.ignore,n)){var i=u[n],f=s,l=a||"";"array"===t.getType(u)?a&&(l+="["+n+"]"):(a&&(l+="."),l+=n),f.parentName=l;if(!(-1===e.utils.arrayIndexOf(s.copy,n)&&-1===e.utils.arrayIndexOf(s.include,n)&&u[v]&&u[v].mappedProperties&&!u[v].mappedProperties[n]&&u[v].copiedProperties&&!u[v].copiedProperties[n]&&"array"!==t.getType(u)))switch(t.getType(e.utils.unwrapObservable(i))){case"object":case"array":case"undefined":f=s.visitedObjects.get(i),o[n]="undefined"!==t.getType(f)?f:t.visitModel(i,r,s);break;default:o[n]=r(i,s.parentName)}}}),o}}),define("views/index",["knockout","knockoutMapping"],function(e,t){e.mapping=t;var n=null,r=!1,i=null,s={all:$(".idxview"),load:$(".idxloading"),start:$(".idxstart"),signin:$(".idxsignin"),forgotInfo:$(".idxforgotinfo"),reg1:$(".idxregister1"),reg2:$(".idxregister2"),reg3:$(".idxregister3"),valEmail:$(".idxEmailValidate")},o=function(e,t,r){gdd.utils.slideTransitionView($(s.all),$(e),t,function(){switch(e){case s.addNew:$("#peopleHeader").html("Add New");break;case s.search:$("#peopleHeader").html("Search");break;case s.duplicates:$("#peopleHeader").html("Duplicates?");break;case s.selectedPerson:$("#peopleHeader").html("Person"),n.clb?$("#btnPeopleMapExisting").show():$("#btnPeopleMapExisting").hide()}r&&r()})},u=function(){$("#idxPortalList").listview("refresh"),$(".chooseportal").off().on(gdd.utils.click,function(){var e=$(this).attr("data-id"),t=$(this).attr("data-name");n.regInfo.portalId(e),n.regInfo.portalName(t),o(s.reg2,"left")})},a=function(){$("#idxPortalList").listview("refresh"),$(".chooseportal").off().on(gdd.utils.click,function(){var e=$(this).attr("data-id"),t=$(this).attr("data-name");gdd.showLoader("Connecting to '"+t+"'"),gdd.api.callApi("Security/CreateSession","POST",{portalId:e},{success:function(e){gdd.hideLoader(),gdd.storage.saveSessionInfo(e.gddData),gdd.session.startNewSession()},fail:function(e){gdd.hideLoader(),gdd.showErr(e.msg)}})})},f=function(){$("#btnIdxChurchMissing").off().on(gdd.utils.click,function(){gdd.utils.showPopup("popupMissingChurch")}),$("#btnRecoverInfo").off().on(gdd.utils.click,function(){var e=$("#txtRecover").val();if(e){var t="",n="";e.indexOf("@")>-1?(n=e,gdd.showLoader("Recovering using email...")):(gdd.showLoader("Recovering using username..."),t=e),gdd.api.callApi("Security/RecoverInfo","GET",{userName:t,email:n},{success:function(e){gdd.hideLoader(),gdd.showMsg(e.gddData,function(){o(s.signin,"down")})},fail:function(e){e.msg.indexOf("no user")>-1?(gdd.hideLoader(),t?gdd.showMsg("There is no matching username in the system."):gdd.showMsg("There is no matching user in the system with this email address.")):(gdd.hideLoader(),gdd.showErr(e.msg))}})}else gdd.showMsg("Please enter either your username or email address.")}),$("#btnResendEmail").off().on(gdd.utils.click,function(){gdd.showLoader("Sending email..."),gdd.api.callApi("Security/SendVerificationEmail","GET",{userId:gdd.session.auth.userId()},{success:function(e){gdd.hideLoader(),gdd.showMsg(e.gddData,function(){o(s.signin,"up")})},fail:function(e){gdd.hideLoader(),gdd.showErr(e.message)}})}),$("#btnRegisterAccount").off().on(gdd.utils.click,function(){n.regInfo.userName($("#txtRegUserName").val()),n.regInfo.password($("#txtRegPwd").val());var t=e.mapping.toJS(n.regInfo);if(t.userName||t.password){var r=!1,i=t.password.length;if(i<5)r=!1;else{var u=/(?!^[0-9]*$)(?!^[a-zA-Z]*$)^([a-zA-Z0-9]{5,20})$/g;r=u.test($("#txtRegPwd").val())}r?$("#txtRegPwd").val()===$("#txtRegPwdC").val()?(gdd.showLoader("Registering account..."),gdd.api.callApi("Security/RegisterNewUser","POST",t,{success:function(e){gdd.hideLoader();var t=function(){n.regInfo.firstName(""),n.regInfo.lastName(""),n.regInfo.email(""),n.regInfo.userName(""),n.regInfo.password(""),$(".regInput").val(""),o(s.signin,"up")};e.gddData.status===1?gdd.showMsg(e.gddData.message,t):e.gddData.status===2?gdd.showMsg(e.gddData.message,t):gdd.showErr("The server returned am undefined status. Please contact support.",t)},fail:function(e){gdd.hideLoader(),e.msg.indexOf("has already been taken")>-1?($("#usernamePopupTxt").html(n.regInfo.userName()),gdd.showPopup("popupUserNameExists")):gdd.showErr(e.msg)}})):gdd.showMsg("Your passwords do not match."):$("#popupPwdInfo").popup("open",{transition:"slideup"})}else gdd.showMsg("Please enter a valid username and password.")}),$("#frmReg2").validate({rules:{txtRegFName:{required:!0},txtRegLName:{required:!0},txtRegMobile:{required:!0},txtRegEmail:{required:!0,email:!0}},highlight:function(e){$(e).closest(".form-group").removeClass("has-success").addClass("has-error")},unhighlight:function(e){$(e).closest(".form-group").removeClass("has-error").addClass("has-success")},errorPlacement:function(e,t){return null}}),$("#btnSignIn").off().on(gdd.utils.click,function(){gdd.utils.activePage=gdd.pages.index;var t={};t.username=$("#txtUserName").val(),t.password=$("#txtPassword").val(),t.username&&t.password?(gdd.showLoader("Logging in..."),gdd.api.callApi("Security/Authenticate","POST",t,{success:function(t){gdd.hideLoader(),gdd.storage.saveAuthInfo(t.gddData),e.mapping.mergeFromJS(gdd.session.auth,t.gddData);if(t.gddData.sts=="1")if(t.gddData.authorizedPortals.length>0){var n=t.gddData.authorizedPortals[0].portalId,r=t.gddData.authorizedPortals[0].portalName;gdd.showLoader("Connecting to '"+r+"'"),gdd.session.endOldSession(),gdd.api.callApi("Security/CreateSession","POST",{portalId:n},{success:function(e){gdd.hideLoader(),gdd.storage.saveSessionInfo(e.gddData),gdd.session.startNewSession()},fail:function(e){gdd.hideLoader(),gdd.showErr(e.msg)}})}else gdd.showLoader("Loading church info..."),l(function(){o(s.reg1,"up"),gdd.hideLoader()},function(e){gdd.hideLoader(),gdd.showErr(e)},a);else t.gddData.sts=="2"?o(s.valEmail,"up"):gdd.showErr("Invalid return status, please contact support")},fail:function(e){gdd.hideLoader(),e.msg.indexOf("username and password")>-1?gdd.showMsg("The username/password combination you entered is not valid. Please try again."):gdd.showErr(e.msg)}})):gdd.showMsg("Please enter a valid username and password.")}),$(".btnLoginIn").off().on(gdd.utils.click,function(){o(s.signin,"up")}),$(".btnForgotInfo").off().on(gdd.utils.click,function(){o(s.forgotInfo,"up")}),$(".btnIdxHeaderCancel").on(gdd.tap(),function(){o(s.start,"down")}),$(".btnRegisterNewAccount").off().on(gdd.utils.click,function(){gdd.showLoader("Loading registration data..."),l(function(){if(gdd.cache.appPortals().length===1){var e=gdd.cache.appPortals()[0].portalId,t=gdd.cache.appPortals()[0].portalName;n.regInfo.portalId(e),n.regInfo.portalName(t),o(s.reg2,"left")}else o(s.reg1,"up");gdd.hideLoader()},function(e){gdd.hideLoader(),gdd.showErr(e)},u)}),$(".btnGoReg1").off().on(gdd.utils.click,function(){o(s.reg1,"right")}),$(".btnGoReg2").off().on(gdd.utils.click,function(){var e=$(this).attr("data-view");e==="1"?o(s.reg2,"left"):o(s.reg2,"right")}),$(".btnGoReg3").off().on(gdd.utils.click,function(){var e=$(this).attr("data-view");$("#frmReg2").valid()?(gdd.showLoader("Checking email..."),gdd.api.callApi("Security/EmailIsAvailable","GET",{email:n.regInfo.email()},{success:function(t){gdd.hideLoader(),t.gddData==="1"?e==="2"?o(s.reg3,"left"):o(s.reg3,"right"):($("#emailPopupTxt").html(n.regInfo.email()),gdd.showPopup("popupEmailExists"))},fail:function(e){gdd.hideLoader(),gdd.showErr(e.msg)}})):gdd.showMsg("Please provide valid entries for all the fields above.")})},l=function(e,t,n){gdd.cache.appPortals().length>0?(n(),e()):gdd.api.callApi("Admin/SearchPortals","GET",{searchstring:""},{success:function(r){gdd.cache.appPortals.removeAll(),$.each(r.gddData,function(e,t){gdd.cache.appPortals.push(t)}),gdd.hideLoader(),gdd.cache.appPortals().length>0?(n(),e()):t("This app has not been connected to any churches. Please contact support.")},fail:function(e){t(e.msg)}})};return{regInfo:{firstName:e.observable(""),lastName:e.observable(""),email:e.observable(""),userName:e.observable(""),password:e.observable(""),mobileNumber:e.observable(""),portalId:e.observable(""),portalName:e.observable("")},create:function(){n=this,gdd.utils.configMergeFromJs(e)},show:function(){function n(){gdd.utils.appReady()&&(clearInterval(t),gdd.session.signedIn()&&gdd.loadPage(gdd.pages.home))}gdd.utils.activePage=gdd.pages.index,r||(e.applyBindings(gdd,document.getElementById(gdd.utils.activePage.id)),r=!0),f(),$("#indexContent").show(),$(".idxview").hide(),o(s.start,"down",function(){i=$("#idxBxSlider").bxSlider({controls:!1,mode:"horizontal",useCSS:!0,easing:"easeOutBack",speed:1e3,pager:!0})});var t=setInterval(function(){n()},500)},beforeShow:function(){},beforeHide:function(){}}}),define("views/moreInfo",[],function(){var e=function(){$("#btnHome").on("click",function(){gdd.loadPage(gdd.pages.home)}),$("#btnBoucne").on("click",function(){$("#toggle").toggle("bounce",{times:3},"slow")})};return{create:function(){},show:function(){},beforeShow:function(){e()},beforeHide:function(){},endOldSession:function(){}}}),define("views/home",["knockout","knockoutMapping"],function(e,t){e.mapping=t;var n=null,r=function(){$("#btnHomeTestSMS").on(gdd.tap(),function(){try{var e=$("#smsNumbers").val(),t="Hello",n=$("#smsIntent").val(),r=function(){alert("Message sent successfully")},i=function(e){alert("Message Failed:"+e)};sms.send(e,t,n,r,i)}catch(s){alert("Error: "+JSON.stringify(s))}}),$("#btnHomeSignOut").on(gdd.tap(),function(){gdd.session.signOut()}),$(".btnGoSettings").off().on(gdd.click(),function(){var e={positionTo:$(this)};gdd.utils.showPopup("popupSettings",e)}),$(".btnGoNews").off().on(gdd.tap(),function(){gdd.loadPage(gdd.pages.news)}),$("#btnGoPortals").off().on(gdd.click(),function(){$("#popupSettings").one("popupafterclose",function(e,t){gdd.loadPage(gdd.pages.portals,!1)}),$("#popupSettings").popup("close")}),$(".btnGoTemp").off().on(gdd.tap(),function(){alert("Launch Module")}),$("#btnHomeTestPeople").off().on(gdd.tap(),function(){n=null,gdd.pages.people.view.clb=function(e){gdd.loadPage(gdd.pages.home,!0),n=e},gdd.loadPage(gdd.pages.people)})};return{create:function(){},show:function(){e.applyBindings(gdd,document.getElementById(gdd.utils.activePage.id)),n&&(alert(JSON.stringify(n)),n=null)},beforeShow:function(){r()},beforeHide:function(){},endOldSession:function(){}}}),define("views/portals",["knockout","knockoutMapping"],function(e,t){e.mapping=t;var n=null,r={all:".portalView",signin:".signInNewPortal",remove:".removePortal",add:".addNewPortal"},i=function(){$("#portalsRemoveList").listview("refresh"),$("#portalsSignInList").listview("refresh"),$(".currentportal").off().on(gdd.utils.click,function(){var e=$(this).attr("data-id"),t=$(this).attr("data-name"),n=$(this).closest("ul");n[0].id==="portalsRemoveList"?gdd.portalId()==e?gdd.showMsg("You cannot remove a database when you are signed into it. Please signout first."):u(e,!1):(gdd.showLoader("Connecting to '"+t+"'"),gdd.session.endOldSession(),gdd.api.callApi("Security/CreateSession","POST",{portalId:e},{success:function(e){gdd.hideLoader(),gdd.storage.saveSessionInfo(e.gddData),gdd.session.startNewSession()},fail:function(e){gdd.hideLoader(),gdd.showErr(e.msg)}}))})},s=function(){$("#portalsNewList").listview("refresh"),$(".addportal").off().on(gdd.utils.click,function(){var e=$(this).attr("data-id"),t=$(this).attr("data-name");u(e,!0)}),$("#portalsContent").fadeIn()},o=function(e,t,n){gdd.utils.slideTransitionView($(r.all),$(e),t,function(){switch(e){case r.signin:$("#portalHeader").html("Sign In");break;case r.remove:$("#portalHeader").html("Remove");break;case r.add:$("#portalHeader").html("Add")}n&&n()})},u=function(t,n){n?gdd.showLoader("Activating..."):gdd.showLoader("De-Activating..."),gdd.api.callApi("Security/ToggleUserPortalActiveStatus","GET",{portalId:t,isActive:n},{success:function(t){gdd.hideLoader();if(n){var r=$.grep(gdd.session.auth.authorizedPortals(),function(e,n){return e.portalId==t.gddData.portalId});r.length===0&&(gdd.session.auth.authorizedPortals.push({portalId:t.gddData.portalId,portalName:t.gddData.portalName}),gdd.storage.saveAuthInfo(e.mapping.toJS(gdd.session.auth)),$("#portalsRemoveList").listview("refresh"),$("#portalsSignInList").listview("refresh"))}else{var r=$.grep(gdd.session.auth.authorizedPortals(),function(e,n){return e.portalId==t.gddData.portalId});r.length>0&&(gdd.session.auth.authorizedPortals.splice(gdd.session.auth.authorizedPortals.indexOf(r[0]),1),gdd.storage.saveAuthInfo(e.mapping.toJS(gdd.session.auth)))}},fail:function(e){gdd.hideLoader(),gdd.showErr(err.msg)}})},a=function(){$(".btnShowRemovePortal").on(gdd.utils.tap,function(){o(r.remove,"left")}),$(".btnShowAddPortal").on(gdd.utils.tap,function(){o(r.add,"left")}),$(".btnSignInPortal").on(gdd.utils.tap,function(){o(r.signin,"right")})};return{create:function(){n=this,gdd.utils.configMergeFromJs(e),currView=r.signin,e.applyBindings(gdd,document.getElementById(gdd.utils.activePage.id)),a()},show:function(){i(),gdd.cache.appPortals().length>0?s():(gdd.showLoader("Loading churches..."),gdd.api.callApi("Admin/SearchPortals","GET",{searchstring:"f"},{success:function(e){gdd.cache.appPortals.removeAll(),$.each(e.gddData,function(e,t){gdd.cache.appPortals.push(t)}),gdd.hideLoader(),gdd.cache.appPortals().length>0?s():fail("This app has not been connected to any churches. Please contact support.")},fail:function(e){gdd.showErr(e.msg)}}))},beforeShow:function(){},beforeHide:function(){},endOldSession:function(){}}}),define("views/news",["knockout","knockoutMapping"],function(e,t){e.mapping=t;var n=null,r={all:".newsView",feed:".newsFeed",newsItem:".newsItem",noNews:".noNews",addNews:".newsFlashAdd"},i=0,s=10,o=function(e,t,n){gdd.utils.slideTransitionView($(r.all),$(e),t,function(){switch(e){case r.feed:$("#newsHeader").html("News"),gdd.session.activeSession.permissions.manageNewsItems?$(".btnGoToAddNewsFlash").show():$(".btnGoToAddNewsFlash").hide();break;case r.addNews:$("#newsHeader").html("Send News");break;case r.newsItem:$("#newsHeader").html("News Item")}n&&n()})},u=function(){if(gdd.utils.isNative()){var e="";n.selectedItem.url()?e=n.selectedItem.tagLine()+" ("+n.selectedItem.url()+") - via Godochurch":e=n.selectedItem.tagLine()+" - via Godochurch",window.plugins.socialsharing.share(e)}else gdd.showMsg("Sharing is only available in the native version of this application, not the browser version.")},a=function(){if(n.selectedItem.url())if(gdd.utils.isNative())try{$(".btnNewsItemWebUrl").attr("href","#").removeAttr("target"),$(".btnNewsItemWebUrl").one(gdd.tap(),function(){try{var e=window.open(n.selectedItem.url(),"_system","location=yes,closebuttoncaption=Done/Close")}catch(t){alert("We cannot load the browser on this device: "+t)}}),$(".btnNewsItemWebUrl").show()}catch(e){alert("We cannot load the browser on this device: "+e)}else $(".btnNewsItemWebUrl").attr("href",n.selectedItem.url()).attr("target","_blank"),$(".btnNewsItemWebUrl").show();else $(".btnNewsItemWebUrl").hide();o(r.newsItem,"left")},f=function(){$(".newsFeedClick").off().on(gdd.click(),function(){l($(this).attr("data-id")),a()}),$(".btnNewsItemShareFromList").off().on(gdd.click(),function(){l($(this).attr("data-id")),u()}),$(".btnShareNewsItemFromFeed").off().on(gdd.tap(),function(){l($(this).attr("data-id")),u()}),$(".preNewsContent").show(),$(".newsBubbleCount").html(n.newsItems().length).show()},l=function(t){var r=$.grep(n.newsItems(),function(e,n){return e.id==t});e.mapping.mergeFromJS(n.selectedItem,r[0])},c=function(e,t,r){$(".preNewsContent").hide(),$(".newsBubbleCount").html("").hide();var o=!1;n.newsItems().length===0&&(i=0,o=!0),r&&(o=!0),o?gdd.api.callApi("News/GetPersonsNewsFeed","GET",{personId:gdd.session.personId(),startRow:i,endRow:i+s},{success:function(t){$.each(t.gddData,function(e,t){n.newsItems.push(t),n.countries().indexOf(t.country)===-1&&n.countries.push(t.country),n.types().indexOf(t.type)===-1&&n.types.push(t.type)}),n.newsItems().length>0&&(f(),i=n.newsItems().length+1),$(".preNewsContent").show(),e()},fail:function(e){t(e.msg)}}):(f(),e())},h=function(){$("#btnTestLoadIMG").on("click",function(){var e=null,t=document.querySelector("#btnTESTIMGSelector").files[0],r=new FileReader;r.onloadend=function(){n.imgData=r.result,$("#imgNewsFlashPicture").prop("src",r.result),$("#newsImage").show()},t&&r.readAsDataURL(t)}),$("#btnNewsNewPhoto").on(gdd.click(),function(){$("#popupNewsPhotoSource").one("popupafterclose",function(e,t){var r={quality:49,destinationType:Camera.DestinationType.DATA_URL,sourceType:Camera.PictureSourceType.CAMERA,allowEdit:!0,encodingType:Camera.EncodingType.JPEG,saveToPhotoAlbum:!0};navigator.camera.getPicture(function(e){try{e="data:image/jpeg;base64,"+e,n.imgData=e,$("#imgNewsFlashPicture").prop("src",e),$("#newsImage").show(),$("#btnNewsAddNativePhoto").hide()}catch(t){alert(JSON.stringify(t))}},function(e){alert(e)},r)}),$("#popupNewsPhotoSource").popup("close")}),$("#btnNewsExistingPhoto").on(gdd.click(),function(){$("#popupNewsPhotoSource").one("popupafterclose",function(e,t){var r={quality:49,destinationType:Camera.DestinationType.DATA_URL,sourceType:Camera.PictureSourceType.PHOTOLIBRARY,allowEdit:!0,encodingType:Camera.EncodingType.JPEG,saveToPhotoAlbum:!0};navigator.camera.getPicture(function(e){e="data:image/jpeg;base64,"+e,n.imgData=e,$("#imgNewsFlashPicture").prop("src",e),$("#newsImage").show(),$("#btnNewsAddNativePhoto").hide()},function(e){alert(e)},r)}),$("#popupNewsPhotoSource").popup("close")}),$("#btnNewsAddNativePhoto").on(gdd.click(),function(){gdd.utils.isNative()?gdd.showPopup("popupNewsPhotoSource",{positionTo:$(this)}):gdd.showMsg("To add a photo, you must be running this application as a native application from your phone.")}),$("#btnAddNewNewsFlash").on(gdd.tap(),function(){var e={};e.id=-1,e.content=$("#txtAddNewsContent").val(),e.channelId=$("#ddlAddNewsChooseChannel").val(),e.sendPush=!0,e.deleteMe=!1,e.imgUrl="";var t=function(){gdd.showLoader("Sending..."),gdd.api.callApi("News/UpdateNewsFlash","POST",e,{success:function(e){gdd.hideLoader(),n.imgData=null,$("#newsImage").hide(),$("#btnNewsAddNativePhoto").show(),$("#txtAddNewsContent").val(""),o(r.feed,"down",function(){$(".btnRefreshNewsFeeds").first().trigger(gdd.tap())})},fail:function(e){gdd.hideLoader(),alert(e.msg)}})},i=function(){gdd.showLoader("Uploading photo...");var r={};r.image=n.imgData,r.id=$("#ddlAddNewsChooseChannel").val(),r.instruction=1,gdd.api.callApi("Admin/UploadPhoto","POST",r,{success:function(r){gdd.hideLoader(),e.imgUrl=r.gddData,n.imgData=null,t()},fail:function(e){gdd.hideLoader(),alert(e.msg)}})};e.content?n.imgData?i():t():alert("You have not entered any content for this newsflash.")}),$(".btnAddNewsBackToNews").on(gdd.click(),function(){o(r.feed,"right")}),$("#btnNewsRemoveImage").on(gdd.click(),function(){n.imgData=null,$("#newsImage").hide(),$("#btnNewsAddNativePhoto").show()}),$(".btnGoToAddNewsFlash").on(gdd.click(),function(){var e=!1;try{e=gdd.session.activeSession.permissions.manageNewsItems}catch(t){e=!1}e?n.refData.channels().length===0?(gdd.showLoader("Loading channels..."),gdd.api.callApi("News/GetNewsData","GET","",{success:function(e){gdd.hideLoader(),e.gddData.channels.length===0?alert("This database has no news channels. Create one using the admin interface which will enable this feature in the mobile application."):(n.refData.channels.removeAll(),$.each(e.gddData.channels,function(e,t){n.refData.channels.push(t)}),n.refData.newsTypes.removeAll(),$.each(e.gddData.newsTypes,function(e,t){n.refData.newsTypes.push(t)}),o(r.addNews,"left"))},fail:function(e){gdd.hideLoader(),alert(e.msg)}})):o(r.addNews,"left"):gdd.utils.requestPermission("Request permission to send news to subscribers from mobile application.")}),$("#btnNewsItemShare2").on(gdd.click(),function(){u()}),$(".btnGoToSubs").on(gdd.click(),function(){gdd.loadPage(gdd.pages.subs,!1,"slide")}),$(".btnNewsItemBackToFeed").on(gdd.click(),function(){o(r.feed,"right")}),$(".btnGoTemp").off().on(gdd.tap(),function(){alert("Launch Module")}),$(".btnRefreshNewsFeeds").on(gdd.tap(),function(){n.newsItems.removeAll(),gdd.showLoader("Refreshing..."),c(function(){n.newsItems().length===0?o(r.noNews,"left"):o(r.feed,"left"),gdd.hideLoader()},function(e){gdd.hideLoader(),alert(e)})}),$("#btnLoadMoreNewsItems").on(gdd.tap(),function(){gdd.showLoader("Loading more..."),c(function(){n.newsItems().length===0?o(r.noNews,"left"):o(r.feed,"left"),gdd.hideLoader()},function(e){gdd.hideLoader(),alert(e)},!0)})};return{imgData:null,selectedItem:{target:e.observable(""),publishStart:e.observable(""),publishEnd:e.observable(""),forNews:e.observable(!1),forPrayer:e.observable(!0),headerUrl:e.observable(""),feedImgUrl:e.observable(""),id:e.observable(-1),title:e.observable(""),content:e.observable(""),country:e.observable(""),type:e.observable(""),headerImgUrl:e.observable(""),headerVideoUrl:e.observable(""),displayHeader:e.observable(!0),channelName:e.observable(""),channelDescription:e.observable(""),channelId:e.observable(""),portalId:e.observable(""),portalName:e.observable(""),url:e.observable(""),headerIsImage:e.observable(!0),tagLine:e.observable("")},newsItems:e.observableArray(),countries:e.observableArray(),types:e.observableArray(),refData:{channels:e.observableArray(),newsTypes:e.observableArray()},create:function(){n=this,gdd.utils.configMergeFromJs(e),h(),e.applyBindings(gdd,document.getElementById(gdd.utils.activePage.id))},show:function(){gdd.showLoader("Loading news..."),c(function(){n.newsItems().length===0?o(r.noNews,"left"):o(r.feed,"left"),gdd.hideLoader()},function(e){gdd.hideLoader(),alert(e)})},beforeShow:function(){},beforeHide:function(){o(r.feed,"left")},endOldSession:function(){gdd.pages.news.view.refData.channels.removeAll()}}}),define("views/subs",["knockout","knockoutMapping"],function(e,t){e.mapping=t;var n=null,r={all:".subsView",none:".subsNone",active:".subsActive",inactive:".subsInActive"},i=function(e,t,n){gdd.utils.slideTransitionView($(r.all),$(e),t,function(){switch(e){case r.none:$("#subsHeader").html("Subscriptions");break;case r.active:$("#subsHeader").html("Active Subs");break;case r.inactive:$("#subsHeader").html("Subscribe")}n&&n()})},s=function(){$("#btnViewInActiveSubs").on(gdd.tap(),function(){i(r.inactive,"left")}),$("#btnViewActiveSubs").on(gdd.tap(),function(){i(r.active,"right")}),$("#btnWhereIsMyChurch").on(gdd.tap(),function(){gdd.showPopup("popupAddMyChurchNews")}),$("#btnSubsRefresh").on(gdd.click(),function(){n.subs.removeAll(),gdd.showLoader("Loading subscriptions..."),o(function(){gdd.hideLoader(),u()},function(e){gdd.hideLoader(),gdd.showErr(e)})})},o=function(e,t){var s=function(){$(".channelSubsFlipSwtch").flipswitch(),$(".channelSubsFlipSwtch").flipswitch("refresh");var t=function(e,t,r,i){gdd.showLoader(i);var s={};s.personId=gdd.session.personId(),s.subscribed=t,s.sendEmail=r,s.channelId=e,gdd.api.callApi("News/UpdatePersonsChannelSubscription","POST",s,{success:function(r){gdd.hideLoader(),gdd.pages.news.view.newsItems.removeAll(),$.each(n.subs(),function(n,r){$.each(r.channels,function(n,r){r.channelId==e&&(r.subscribed=t)})})},fail:function(e){gdd.hideLoader(),gdd.showErr(e.msg)}})};$(".btnSubscribeToPortal").on(gdd.click(),function(){var e=$(this).attr("data-id"),t=$.grep(n.subs(),function(t,n){return t.portalId==e});t[0].hasSub=!0,n.subs.splice(n.subs.indexOf(t[0]),1,t[0]),s(),i(r.active,"right")}),$(".channelSubsFlipSwtch").on("change",function(){var e=$(this).attr("data-id"),n=$(this).prop("checked");n?t(e,!0,!1,"Subscribing..."):t(e,!1,!1,"Unsubscribing...")}),e()},o=!1;n.subs().length===0&&(o=!0),o?gdd.api.callApi("News/GetPersonsNewsSubsProfile","GET",{personId:gdd.session.personId},{success:function(e){n.subs.removeAll();var t=e.gddData;$.each(t,function(e,t){n.subs.push(t)}),s()},fail:function(e){t(e.msg)}}):(s(),e())},u=function(){if(n.subs().length===0)i(r.none,"up");else{var e=!1;$.each(n.subs(),function(t,n){n.hasSub&&(e=!0)}),e?i(r.active,"up"):i(r.inactive,"up")}};return{subs:e.observableArray(),create:function(){n=this,gdd.utils.configMergeFromJs(e),s(),e.applyBindings(gdd,document.getElementById(gdd.utils.activePage.id))},show:function(){gdd.showLoader("Loading subscriptions..."),o(function(){gdd.hideLoader(),u()},function(e){gdd.hideLoader(),gdd.showErr(e)})},beforeShow:function(){},beforeHide:function(){},endOldSession:function(){gdd.pages.subs.view.subs.removeAll()}}}),define("views/people",["knockout","knockoutMapping"],function(e,t){e.mapping=t;var n=null,r={all:".peopleView",addNew:".peopleAddNewView",search:".peopleSearchView",duplicates:".peopleDuplicateView",selectedPerson:".selectedPersonView"},i=function(e,t,n){gdd.utils.slideTransitionView($(r.all),$(e),t,function(){switch(e){case r.addNew:$("#peopleHeader").html("Add New");break;case r.search:$("#peopleHeader").html("Search");break;case r.duplicates:$("#peopleHeader").html("Duplicates?");break;case r.selectedPerson:$("#peopleHeader").html("Person")}n&&n()})},s=function(){$(".btnPeopleSearchView").off().on(gdd.tap(),function(){var e=$(this).attr("data-id"),t=$.grep(n.people(),function(t,n){return t.id==e});n.selectedPerson.id(t[0].id),n.selectedPerson.firstName(t[0].firstName),n.selectedPerson.lastName(t[0].lastName),n.selectedPerson.email(t[0].email),n.selectedPerson.mobileNumber(t[0].mobileNumber),n.selectedPerson.fbId(t[0].facebookId),n.selectedPerson.fbPicUrl("https://graph.facebook.com/"+t[0].facebookId+"/picture?type=large"),$(".selectedPersonViewBack").one(gdd.tap(),function(){i(r.search,"right")}),$("#selectPersonText").html("Select this person"),i(r.selectedPerson,"left")}),$(".btnPeopleSearchSelect").off().on(gdd.tap(),function(){var t=$(this).attr("data-id"),s=$.grep(n.people(),function(e,n){return e.id==t});n.selectedPerson.id(s[0].id),n.selectedPerson.firstName(s[0].firstName),n.selectedPerson.lastName(s[0].lastName),n.selectedPerson.email(s[0].email),n.selectedPerson.mobileNumber(s[0].mobileNumber),n.selectedPerson.fbId(s[0].facebookId),n.selectedPerson.fbPicUrl("https://graph.facebook.com/"+s[0].facebookId+"/picture?type=large"),gdd.pages.people.view.clb?(gdd.pages.people.view.clb(e.mapping.toJS(n.selectedPerson)),gdd.pages.people.view.clb=null):($(".selectedPersonViewBack").one(gdd.tap(),function(){i(r.search,"right")}),$("#selectPersonText").html("Select this person"),i(r.selectedPerson,"left"))})},o=function(){$("#btnPeopleMapExisting").on(gdd.click(),function(t){gdd.showLoader("Working..."),gdd.api.callApi("Person/MapPerson","GET",{personId:n.selectedPerson.id()},{success:function(t){gdd.hideLoader(),n.clb?(n.clb(e.mapping.toJS(n.selectedPerson)),n.clb=null):i(r.search,"right")},fail:function(e){gdd.hideLoader(),gdd.showErr(e.msg)}})}),$("#btnDuplicateNotHere").on(gdd.tap(),function(){n.newPerson.skipDupCheck("1"),u(function(t){n.selectedPerson.id(t.id),n.selectedPerson.firstName(t.firstName),n.selectedPerson.lastName(t.lastName),n.selectedPerson.email(t.email1),n.selectedPerson.mobileNumber(t.mobileNumber),n.selectedPerson.fbId(t.facebookId),n.selectedPerson.fbPicUrl(t.facebookProfilePicLg),n.clb?n.clb(e.mapping.toJS(n.selectedPerson)):i(r.search,"right")},function(e){i(r.duplicates,"left",function(){gdd.showPopup("popupDupFound")})},function(e){gdd.showErr(e)})}),$(".peopleDupViewBack").on(gdd.tap(),function(){i(r.addNew,"right")}),$("#btnPersonBackToAdd").on(gdd.tap(),function(){i(r.addNew,"right")}),$("#btnAddPerson").on(gdd.tap(),function(){n.newPerson.skipDupCheck("0"),u(function(t){n.selectedPerson.id(t.id),n.selectedPerson.firstName(t.firstName),n.selectedPerson.lastName(t.lastName),n.selectedPerson.email(t.email1),n.selectedPerson.mobileNumber(t.mobileNumber),n.selectedPerson.fbId(t.facebookId),n.selectedPerson.fbPicUrl(t.facebookProfilePicLg),n.clb(e.mapping.toJS(n.selectedPerson))},function(e){i(r.duplicates,"left",function(){gdd.showPopup("popupDupFound")})},function(e){gdd.showErr(e)})}),$(".btnAddNewPerson").on(gdd.tap(),function(){i(r.addNew,"up")}),$(".btnSearchPerson").on(gdd.tap(),function(){i(r.search,"down")}),$("#peopleList").on("filterablebeforefilter",function(e,t){var r=$(this),i=$(t.input),o=i.val(),u={};u.scopeGlobal=!1,u.scopeOrg=!1,u.searchString=o,o&&o.length>2&&(gdd.showLoader("Searching..."),gdd.api.callApi("Person/QuickSearch","POST",u,{success:function(e){gdd.hideLoader();var t=e.gddData;n.people.removeAll(),$.each(t,function(e,t){n.people.push(t)}),r.listview("refresh"),r.trigger("updatelayout"),s()},fail:function(e){gdd.hideLoader(),gdd.showErr(e.msg)}}))})},u=function(t,s,o){var u=e.mapping.toJS(n.newPerson);u.firstName&&u.lastName?!u.email1&&!u.mobileNumber?gdd.showMsg("You provide either a mobile number or email address or both."):(gdd.showLoader("Adding..."),gdd.api.callApi("Person/AddPerson","POST",e.mapping.toJS(n.newPerson),{success:function(e){gdd.hideLoader(),e.gddData.resultCode=="1"?t(e.gddData.results[0]):(n.duplicates.removeAll(),$.each(e.gddData.results,function(e,t){n.duplicates.push(t)}),$(".selectDuplicate").off().on(gdd.tap(),function(){var e=$(this).attr("data-id"),t=$.grep(n.duplicates(),function(t,n){return t.id==e});n.selectedPerson.id(t[0].id),n.selectedPerson.firstName(t[0].firstName),n.selectedPerson.lastName(t[0].lastName),n.selectedPerson.email(t[0].email1),n.selectedPerson.mobileNumber(t[0].mobileNumber),n.selectedPerson.fbId(t[0].facebookId),n.selectedPerson.fbPicUrl(t[0].facebookProfilePicLg),$(".selectedPersonViewBack").one(gdd.tap(),function(){i(r.duplicates,"right")}),$("#selectPersonText").html("This is the person"),i(r.selectedPerson,"left")}),$("#peopleDuplicateList").listview("refresh"),s())},fail:function(e){gdd.hideLoader(),o(e.msg)}})):gdd.showMsg("You must provide both a first and last name.")};return{duplicates:e.observableArray(),newPerson:{id:e.observable("-1"),firstName:e.observable(""),lastName:e.observable(""),mobileNumber:e.observable(""),email1:e.observable(""),skipDupCheck:e.observable("0")},clb:null,selectedPerson:{id:e.observable(""),firstName:e.observable(""),lastName:e.observable(""),email:e.observable(""),mobileNumber:e.observable(""),fbId:e.observable(""),fbPicUrl:e.observable("")},people:e.observableArray(),create:function(){n=gdd.utils.activePage.view,gdd.utils.configMergeFromJs(e),o(),e.applyBindings(gdd,document.getElementById(gdd.utils.activePage.id))},show:function(){n.people().length>0&&($("#peopleList").listview("refresh"),$("#peopleList").trigger("updatelayout"),s())},beforeShow:function(){},beforeHide:function(){gdd.pages.people.clb=null},endOldSession:function(){gdd.pages.people.view.people.removeAll(),gdd.pages.people.view.duplicates.removeAll()}}}),function(e,t){function s(e){var t,n;while(e.length&&e[0]!==document){t=e.css("position");if(t==="absolute"||t==="relative"||t==="fixed"){n=parseInt(e.css("zIndex"),10);if(!isNaN(n)&&n!==0)return n}e=e.parent()}return 0}function o(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},e.extend(this._defaults,this.regional[""]),this.dpDiv=u(e("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}function u(t){var n="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return t.delegate(n,"mouseout",function(){e(this).removeClass("ui-state-hover"),this.className.indexOf("ui-datepicker-prev")!==-1&&e(this).removeClass("ui-datepicker-prev-hover"),this.className.indexOf("ui-datepicker-next")!==-1&&e(this).removeClass("ui-datepicker-next-hover")}).delegate(n,"mouseover",function(){e.datepicker._isDisabledDatepicker(i.inline?t.parent()[0]:i.input[0])||(e(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),e(this).addClass("ui-state-hover"),this.className.indexOf("ui-datepicker-prev")!==-1&&e(this).addClass("ui-datepicker-prev-hover"),this.className.indexOf("ui-datepicker-next")!==-1&&e(this).addClass("ui-datepicker-next-hover"))})}function a(t,n){e.extend(t,n);for(var r in n)n[r]==null&&(t[r]=n[r]);return t}e.extend(e.ui,{datepicker:{version:"@VERSION"}});var n="datepicker",r=(new Date).getTime(),i;e.extend(o.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(e){return a(this._defaults,e||{}),this},_attachDatepicker:function(t,n){var r,i,s;r=t.nodeName.toLowerCase(),i=r==="div"||r==="span",t.id||(this.uuid+=1,t.id="dp"+this.uuid),s=this._newInst(e(t),i),s.settings=e.extend({},n||{}),r==="input"?this._connectDatepicker(t,s):i&&this._inlineDatepicker(t,s)},_newInst:function(t,n){var r=t[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1");return{id:r,input:t,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:n,dpDiv:n?u(e("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):this.dpDiv}},_connectDatepicker:function(t,r){var i=e(t);r.append=e([]),r.trigger=e([]);if(i.hasClass(this.markerClassName))return;this._attachments(i,r),i.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp),this._autoSize(r),e.data(t,n,r),r.settings.disabled&&this._disableDatepicker(t)},_attachments:function(t,n){var r,i,s,o=this._get(n,"appendText"),u=this._get(n,"isRTL");n.append&&n.append.remove(),o&&(n.append=e("<span class='"+this._appendClass+"'>"+o+"</span>"),t[u?"before":"after"](n.append)),t.unbind("focus",this._showDatepicker),n.trigger&&n.trigger.remove(),r=this._get(n,"showOn"),(r==="focus"||r==="both")&&t.focus(this._showDatepicker);if(r==="button"||r==="both")i=this._get(n,"buttonText"),s=this._get(n,"buttonImage"),n.trigger=e(this._get(n,"buttonImageOnly")?e("<img/>").addClass(this._triggerClass).attr({src:s,alt:i,title:i}):e("<button type='button'></button>").addClass(this._triggerClass).html(s?e("<img/>").attr({src:s,alt:i,title:i}):i)),t[u?"before":"after"](n.trigger),n.trigger.click(function(){return e.datepicker._datepickerShowing&&e.datepicker._lastInput===t[0]?e.datepicker._hideDatepicker():e.datepicker._datepickerShowing&&e.datepicker._lastInput!==t[0]?(e.datepicker._hideDatepicker(),e.datepicker._showDatepicker(t[0])):e.datepicker._showDatepicker(t[0]),!1})},_autoSize:function(e){if(this._get(e,"autoSize")&&!e.inline){var t,n,r,i,s=new Date(2009,11,20),o=this._get(e,"dateFormat");o.match(/[DM]/)&&(t=function(e){n=0,r=0;for(i=0;i<e.length;i++)e[i].length>n&&(n=e[i].length,r=i);return r},s.setMonth(t(this._get(e,o.match(/MM/)?"monthNames":"monthNamesShort"))),s.setDate(t(this._get(e,o.match(/DD/)?"dayNames":"dayNamesShort"))+20-s.getDay())),e.input.attr("size",this._formatDate(e,s).length)}},_inlineDatepicker:function(t,r){var i=e(t);if(i.hasClass(this.markerClassName))return;i.addClass(this.markerClassName).append(r.dpDiv),e.data(t,n,r),this._setDate(r,this._getDefaultDate(r),!0),this._updateDatepicker(r),this._updateAlternate(r),r.settings.disabled&&this._disableDatepicker(t),r.dpDiv.css("display","block")},_dialogDatepicker:function(t,r,i,s,o){var u,f,l,c,h,p=this._dialogInst;return p||(this.uuid+=1,u="dp"+this.uuid,this._dialogInput=e("<input type='text' id='"+u+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.keydown(this._doKeyDown),e("body").append(this._dialogInput),p=this._dialogInst=this._newInst(this._dialogInput,!1),p.settings={},e.data(this._dialogInput[0],n,p)),a(p.settings,s||{}),r=r&&r.constructor===Date?this._formatDate(p,r):r,this._dialogInput.val(r),this._pos=o?o.length?o:[o.pageX,o.pageY]:null,this._pos||(f=document.documentElement.clientWidth,l=document.documentElement.clientHeight,c=document.documentElement.scrollLeft||document.body.scrollLeft,h=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[f/2-100+c,l/2-150+h]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),p.settings.onSelect=i,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),e.blockUI&&e.blockUI(this.dpDiv),e.data(this._dialogInput[0],n,p),this},_destroyDatepicker:function(t){var r,i=e(t),s=e.data(t,n);if(!i.hasClass(this.markerClassName))return;r=t.nodeName.toLowerCase(),e.removeData(t,n),r==="input"?(s.append.remove(),s.trigger.remove(),i.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):(r==="div"||r==="span")&&i.removeClass(this.markerClassName).empty()},_enableDatepicker:function(t){var r,i,s=e(t),o=e.data(t,n);if(!s.hasClass(this.markerClassName))return;r=t.nodeName.toLowerCase();if(r==="input")t.disabled=!1,o.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""});else if(r==="div"||r==="span")i=s.children("."+this._inlineClass),i.children().removeClass("ui-state-disabled"),i.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1);this._disabledInputs=e.map(this._disabledInputs,function(e){return e===t?null:e})},_disableDatepicker:function(t){var r,i,s=e(t),o=e.data(t,n);if(!s.hasClass(this.markerClassName))return;r=t.nodeName.toLowerCase();if(r==="input")t.disabled=!0,o.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"});else if(r==="div"||r==="span")i=s.children("."+this._inlineClass),i.children().addClass("ui-state-disabled"),i.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0);this._disabledInputs=e.map(this._disabledInputs,function(e){return e===t?null:e}),this._disabledInputs[this._disabledInputs.length]=t},_isDisabledDatepicker:function(e){if(!e)return!1;for(var t=0;t<this._disabledInputs.length;t++)if(this._disabledInputs[t]===e)return!0;return!1},_getInst:function(t){try{return e.data(t,n)}catch(r){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(n,r,i){var s,o,u,f,l=this._getInst(n);if(arguments.length===2&&typeof r=="string")return r==="defaults"?e.extend({},e.datepicker._defaults):l?r==="all"?e.extend({},l.settings):this._get(l,r):null;s=r||{},typeof r=="string"&&(s={},s[r]=i),l&&(this._curInst===l&&this._hideDatepicker(),o=this._getDateDatepicker(n,!0),u=this._getMinMaxDate(l,"min"),f=this._getMinMaxDate(l,"max"),a(l.settings,s),u!==null&&s.dateFormat!==t&&s.minDate===t&&(l.settings.minDate=this._formatDate(l,u)),f!==null&&s.dateFormat!==t&&s.maxDate===t&&(l.settings.maxDate=this._formatDate(l,f)),"disabled"in s&&(s.disabled?this._disableDatepicker(n):this._enableDatepicker(n)),this._attachments(e(n),l),this._autoSize(l),this._setDate(l,o),this._updateAlternate(l),this._updateDatepicker(l))},_changeDatepicker:function(e,t,n){this._optionDatepicker(e,t,n)},_refreshDatepicker:function(e){var t=this._getInst(e);t&&this._updateDatepicker(t)},_setDateDatepicker:function(e,t){var n=this._getInst(e);n&&(this._setDate(n,t),this._updateDatepicker(n),this._updateAlternate(n))},_getDateDatepicker:function(e,t){var n=this._getInst(e);return n&&!n.inline&&this._setDateFromField(n,t),n?this._getDate(n):null},_doKeyDown:function(t){var n,r,i,s=e.datepicker._getInst(t.target),o=!0,u=s.dpDiv.is(".ui-datepicker-rtl");s._keyEvent=!0;if(e.datepicker._datepickerShowing)switch(t.keyCode){case 9:e.datepicker._hideDatepicker(),o=!1;break;case 13:return i=e("td."+e.datepicker._dayOverClass+":not(."+e.datepicker._currentClass+")",s.dpDiv),i[0]&&e.datepicker._selectDay(t.target,s.selectedMonth,s.selectedYear,i[0]),n=e.datepicker._get(s,"onSelect"),n?(r=e.datepicker._formatDate(s),n.apply(s.input?s.input[0]:null,[r,s])):e.datepicker._hideDatepicker(),!1;case 27:e.datepicker._hideDatepicker();break;case 33:e.datepicker._adjustDate(t.target,t.ctrlKey?-e.datepicker._get(s,"stepBigMonths"):-e.datepicker._get(s,"stepMonths"),"M");break;case 34:e.datepicker._adjustDate(t.target,t.ctrlKey?+e.datepicker._get(s,"stepBigMonths"):+e.datepicker._get(s,"stepMonths"),"M");break;case 35:(t.ctrlKey||t.metaKey)&&e.datepicker._clearDate(t.target),o=t.ctrlKey||t.metaKey;break;case 36:(t.ctrlKey||t.metaKey)&&e.datepicker._gotoToday(t.target),o=t.ctrlKey||t.metaKey;break;case 37:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,u?1:-1,"D"),o=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&e.datepicker._adjustDate(t.target,t.ctrlKey?-e.datepicker._get(s,"stepBigMonths"):-e.datepicker._get(s,"stepMonths"),"M");break;case 38:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,-7,"D"),o=t.ctrlKey||t.metaKey;break;case 39:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,u?-1:1,"D"),o=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&e.datepicker._adjustDate(t.target,t.ctrlKey?+e.datepicker._get(s,"stepBigMonths"):+e.datepicker._get(s,"stepMonths"),"M");break;case 40:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,7,"D"),o=t.ctrlKey||t.metaKey;break;default:o=!1}else t.keyCode===36&&t.ctrlKey?e.datepicker._showDatepicker(this):o=!1;o&&(t.preventDefault(),t.stopPropagation())},_doKeyPress:function(t){var n,r,i=e.datepicker._getInst(t.target);if(e.datepicker._get(i,"constrainInput"))return n=e.datepicker._possibleChars(e.datepicker._get(i,"dateFormat")),r=String.fromCharCode(t.charCode==null?t.keyCode:t.charCode),t.ctrlKey||t.metaKey||r<" "||!n||n.indexOf(r)>-1},_doKeyUp:function(t){var n,r=e.datepicker._getInst(t.target);if(r.input.val()!==r.lastVal)try{n=e.datepicker.parseDate(e.datepicker._get(r,"dateFormat"),r.input?r.input.val():null,e.datepicker._getFormatConfig(r)),n&&(e.datepicker._setDateFromField(r),e.datepicker._updateAlternate(r),e.datepicker._updateDatepicker(r))}catch(i){}return!0},_showDatepicker:function(t){t=t.target||t,t.nodeName.toLowerCase()!=="input"&&(t=e("input",t.parentNode)[0]);if(e.datepicker._isDisabledDatepicker(t)||e.datepicker._lastInput===t)return;var n,r,i,o,u,f,l;n=e.datepicker._getInst(t),e.datepicker._curInst&&e.datepicker._curInst!==n&&(e.datepicker._curInst.dpDiv.stop(!0,!0),n&&e.datepicker._datepickerShowing&&e.datepicker._hideDatepicker(e.datepicker._curInst.input[0])),r=e.datepicker._get(n,"beforeShow"),i=r?r.apply(t,[t,n]):{};if(i===!1)return;a(n.settings,i),n.lastVal=null,e.datepicker._lastInput=t,e.datepicker._setDateFromField(n),e.datepicker._inDialog&&(t.value=""),e.datepicker._pos||(e.datepicker._pos=e.datepicker._findPos(t),e.datepicker._pos[1]+=t.offsetHeight),o=!1,e(t).parents().each(function(){return o|=e(this).css("position")==="fixed",!o}),u={left:e.datepicker._pos[0],top:e.datepicker._pos[1]},e.datepicker._pos=null,n.dpDiv.empty(),n.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),e.datepicker._updateDatepicker(n),u=e.datepicker._checkOffset(n,u,o),n.dpDiv.css({position:e.datepicker._inDialog&&e.blockUI?"static":o?"fixed":"absolute",display:"none",left:u.left+"px",top:u.top+"px"}),n.inline||(f=e.datepicker._get(n,"showAnim"),l=e.datepicker._get(n,"duration"),n.dpDiv.css("z-index",s(e(t))+1),e.datepicker._datepickerShowing=!0,e.effects&&e.effects.effect[f]?n.dpDiv.show(f,e.datepicker._get(n,"showOptions"),l):n.dpDiv[f||"show"](f?l:null),n.input.is(":visible")&&!n.input.is(":disabled")&&n.input.focus(),e.datepicker._curInst=n)},_updateDatepicker:function(t){this.maxRows=4,i=t,t.dpDiv.empty().append(this._generateHTML(t)),this._attachHandlers(t),t.dpDiv.find("."+this._dayOverClass+" a").mouseover();var n,r=this._getNumberOfMonths(t),s=r[1],o=17;t.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),s>1&&t.dpDiv.addClass("ui-datepicker-multi-"+s).css("width",o*s+"em"),t.dpDiv[(r[0]!==1||r[1]!==1?"add":"remove")+"Class"]("ui-datepicker-multi"),t.dpDiv[(this._get(t,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),t===e.datepicker._curInst&&e.datepicker._datepickerShowing&&t.input&&t.input.is(":visible")&&!t.input.is(":disabled")&&t.input[0]!==document.activeElement&&t.input.focus(),t.yearshtml&&(n=t.yearshtml,setTimeout(function(){n===t.yearshtml&&t.yearshtml&&t.dpDiv.find("select.ui-datepicker-year:first").replaceWith(t.yearshtml),n=t.yearshtml=null},0))},_getBorders:function(e){var t=function(e){return{thin:1,medium:2,thick:3}[e]||e};return[parseFloat(t(e.css("border-left-width"))),parseFloat(t(e.css("border-top-width")))]},_checkOffset:function(t,n,r){var i=t.dpDiv.outerWidth(),s=t.dpDiv.outerHeight(),o=t.input?t.input.outerWidth():0,u=t.input?t.input.outerHeight():0,a=document.documentElement.clientWidth+(r?0:e(document).scrollLeft()),f=document.documentElement.clientHeight+(r?0:e(document).scrollTop());return n.left-=this._get(t,"isRTL")?i-o:0,n.left-=r&&n.left===t.input.offset().left?e(document).scrollLeft():0,n.top-=r&&n.top===t.input.offset().top+u?e(document).scrollTop():0,n.left-=Math.min(n.left,n.left+i>a&&a>i?Math.abs(n.left+i-a):0),n.top-=Math.min(n.top,n.top+s>f&&f>s?Math.abs(s+u):0),n},_findPos:function(t){var n,r=this._getInst(t),i=this._get(r,"isRTL");while(t&&(t.type==="hidden"||t.nodeType!==1||e.expr.filters.hidden(t)))t=t[i?"previousSibling":"nextSibling"];return n=e(t).offset(),[n.left,n.top]},_hideDatepicker:function(t){var r,i,s,o,u=this._curInst;if(!u||t&&u!==e.data(t,n))return;this._datepickerShowing&&(r=this._get(u,"showAnim"),i=this._get(u,"duration"),s=function(){e.datepicker._tidyDialog(u)},e.effects&&(e.effects.effect[r]||e.effects[r])?u.dpDiv.hide(r,e.datepicker._get(u,"showOptions"),i,s):u.dpDiv[r==="slideDown"?"slideUp":r==="fadeIn"?"fadeOut":"hide"](r?i:null,s),r||s(),this._datepickerShowing=!1,o=this._get(u,"onClose"),o&&o.apply(u.input?u.input[0]:null,[u.input?u.input.val():"",u]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),e.blockUI&&(e.unblockUI(),e("body").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(e){e.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(t){if(!e.datepicker._curInst)return;var n=e(t.target),r=e.datepicker._getInst(n[0]);(n[0].id!==e.datepicker._mainDivId&&n.parents("#"+e.datepicker._mainDivId).length===0&&!n.hasClass(e.datepicker.markerClassName)&&!n.closest("."+e.datepicker._triggerClass).length&&e.datepicker._datepickerShowing&&(!e.datepicker._inDialog||!e.blockUI)||n.hasClass(e.datepicker.markerClassName)&&e.datepicker._curInst!==r)&&e.datepicker._hideDatepicker()},_adjustDate:function(t,n,r){var i=e(t),s=this._getInst(i[0]);if(this._isDisabledDatepicker(i[0]))return;this._adjustInstDate(s,n+(r==="M"?this._get(s,"showCurrentAtPos"):0),r),this._updateDatepicker(s)},_gotoToday:function(t){var n,r=e(t),i=this._getInst(r[0]);this._get(i,"gotoCurrent")&&i.currentDay?(i.selectedDay=i.currentDay,i.drawMonth=i.selectedMonth=i.currentMonth,i.drawYear=i.selectedYear=i.currentYear):(n=new Date,i.selectedDay=n.getDate(),i.drawMonth=i.selectedMonth=n.getMonth(),i.drawYear=i.selectedYear=n.getFullYear()),this._notifyChange(i),this._adjustDate(r)},_selectMonthYear:function(t,n,r){var i=e(t),s=this._getInst(i[0]);s["selected"+(r==="M"?"Month":"Year")]=s["draw"+(r==="M"?"Month":"Year")]=parseInt(n.options[n.selectedIndex].value,10),this._notifyChange(s),this._adjustDate(i)},_selectDay:function(t,n,r,i){var s,o=e(t);if(e(i).hasClass(this._unselectableClass)||this._isDisabledDatepicker(o[0]))return;s=this._getInst(o[0]),s.selectedDay=s.currentDay=e("a",i).html(),s.selectedMonth=s.currentMonth=n,s.selectedYear=s.currentYear=r,this._selectDate(t,this._formatDate(s,s.currentDay,s.currentMonth,s.currentYear))},_clearDate:function(t){var n=e(t);this._selectDate(n,"")},_selectDate:function(t,n){var r,i=e(t),s=this._getInst(i[0]);n=n!=null?n:this._formatDate(s),s.input&&s.input.val(n),this._updateAlternate(s),r=this._get(s,"onSelect"),r?r.apply(s.input?s.input[0]:null,[n,s]):s.input&&s.input.trigger("change"),s.inline?this._updateDatepicker(s):(this._hideDatepicker(),this._lastInput=s.input[0],typeof s.input[0]!="object"&&s.input.focus(),this._lastInput=null)},_updateAlternate:function(t){var n,r,i,s=this._get(t,"altField");s&&(n=this._get(t,"altFormat")||this._get(t,"dateFormat"),r=this._getDate(t),i=this.formatDate(n,r,this._getFormatConfig(t)),e(s).each(function(){e(this).val(i)}))},noWeekends:function(e){var t=e.getDay();return[t>0&&t<6,""]},iso8601Week:function(e){var t,n=new Date(e.getTime());return n.setDate(n.getDate()+4-(n.getDay()||7)),t=n.getTime(),n.setMonth(0),n.setDate(1),Math.floor(Math.round((t-n)/864e5)/7)+1},parseDate:function(t,n,r){if(t==null||n==null)throw"Invalid arguments";n=typeof n=="object"?n.toString():n+"";if(n==="")return null;var i,s,o,u=0,a=(r?r.shortYearCutoff:null)||this._defaults.shortYearCutoff,f=typeof a!="string"?a:(new Date).getFullYear()%100+parseInt(a,10),l=(r?r.dayNamesShort:null)||this._defaults.dayNamesShort,c=(r?r.dayNames:null)||this._defaults.dayNames,h=(r?r.monthNamesShort:null)||this._defaults.monthNamesShort,p=(r?r.monthNames:null)||this._defaults.monthNames,d=-1,v=-1,m=-1,g=-1,y=!1,b,w=function(e){var n=i+1<t.length&&t.charAt(i+1)===e;return n&&i++,n},E=function(e){var t=w(e),r=e==="@"?14:e==="!"?20:e==="y"&&t?4:e==="o"?3:2,i=new RegExp("^\\d{1,"+r+"}"),s=n.substring(u).match(i);if(!s)throw"Missing number at position "+u;return u+=s[0].length,parseInt(s[0],10)},S=function(t,r,i){var s=-1,o=e.map(w(t)?i:r,function(e,t){return[[t,e]]}).sort(function(e,t){return-(e[1].length-t[1].length)});e.each(o,function(e,t){var r=t[1];if(n.substr(u,r.length).toLowerCase()===r.toLowerCase())return s=t[0],u+=r.length,!1});if(s!==-1)return s+1;throw"Unknown name at position "+u},x=function(){if(n.charAt(u)!==t.charAt(i))throw"Unexpected literal at position "+u;u++};for(i=0;i<t.length;i++)if(y)t.charAt(i)==="'"&&!w("'")?y=!1:x();else switch(t.charAt(i)){case"d":m=E("d");break;case"D":S("D",l,c);break;case"o":g=E("o");break;case"m":v=E("m");break;case"M":v=S("M",h,p);break;case"y":d=E("y");break;case"@":b=new Date(E("@")),d=b.getFullYear(),v=b.getMonth()+1,m=b.getDate();break;case"!":b=new Date((E("!")-this._ticksTo1970)/1e4),d=b.getFullYear(),v=b.getMonth()+1,m=b.getDate();break;case"'":w("'")?x():y=!0;break;default:x()}if(u<n.length){o=n.substr(u);if(!/^\s+/.test(o))throw"Extra/unparsed characters found in date: "+o}d===-1?d=(new Date).getFullYear():d<100&&(d+=(new Date).getFullYear()-(new Date).getFullYear()%100+(d<=f?0:-100));if(g>-1){v=1,m=g;do{s=this._getDaysInMonth(d,v-1);if(m<=s)break;v++,m-=s}while(!0)}b=this._daylightSavingAdjust(new Date(d,v-1,m));if(b.getFullYear()!==d||b.getMonth()+1!==v||b.getDate()!==m)throw"Invalid date";return b},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925))*24*60*60*1e7,formatDate:function(e,t,n){if(!t)return"";var r,i=(n?n.dayNamesShort:null)||this._defaults.dayNamesShort,s=(n?n.dayNames:null)||this._defaults.dayNames,o=(n?n.monthNamesShort:null)||this._defaults.monthNamesShort,u=(n?n.monthNames:null)||this._defaults.monthNames,a=function(t){var n=r+1<e.length&&e.charAt(r+1)===t;return n&&r++,n},f=function(e,t,n){var r=""+t;if(a(e))while(r.length<n)r="0"+r;return r},l=function(e,t,n,r){return a(e)?r[t]:n[t]},c="",h=!1;if(t)for(r=0;r<e.length;r++)if(h)e.charAt(r)==="'"&&!a("'")?h=!1:c+=e.charAt(r);else switch(e.charAt(r)){case"d":c+=f("d",t.getDate(),2);break;case"D":c+=l("D",t.getDay(),i,s);break;case"o":c+=f("o",Math.round(((new Date(t.getFullYear(),t.getMonth(),t.getDate())).getTime()-(new Date(t.getFullYear(),0,0)).getTime())/864e5),3);break;case"m":c+=f("m",t.getMonth()+1,2);break;case"M":c+=l("M",t.getMonth(),o,u);break;case"y":c+=a("y")?t.getFullYear():(t.getYear()%100<10?"0":"")+t.getYear()%100;break;case"@":c+=t.getTime();break;case"!":c+=t.getTime()*1e4+this._ticksTo1970;break;case"'":a("'")?c+="'":h=!0;break;default:c+=e.charAt(r)}return c},_possibleChars:function(e){var t,n="",r=!1,i=function(n){var r=t+1<e.length&&e.charAt(t+1)===n;return r&&t++,r};for(t=0;t<e.length;t++)if(r)e.charAt(t)==="'"&&!i("'")?r=!1:n+=e.charAt(t);else switch(e.charAt(t)){case"d":case"m":case"y":case"@":n+="0123456789";break;case"D":case"M":return null;case"'":i("'")?n+="'":r=!0;break;default:n+=e.charAt(t)}return n},_get:function(e,n){return e.settings[n]!==t?e.settings[n]:this._defaults[n]},_setDateFromField:function(e,t){if(e.input.val()===e.lastVal)return;var n=this._get(e,"dateFormat"),r=e.lastVal=e.input?e.input.val():null,i=this._getDefaultDate(e),s=i,o=this._getFormatConfig(e);try{s=this.parseDate(n,r,o)||i}catch(u){r=t?"":r}e.selectedDay=s.getDate(),e.drawMonth=e.selectedMonth=s.getMonth(),e.drawYear=e.selectedYear=s.getFullYear(),e.currentDay=r?s.getDate():0,e.currentMonth=r?s.getMonth():0,e.currentYear=r?s.getFullYear():0,this._adjustInstDate(e)},_getDefaultDate:function(e){return this._restrictMinMax(e,this._determineDate(e,this._get(e,"defaultDate"),new Date))},_determineDate:function(t,n,r){var i=function(e){var t=new Date;return t.setDate(t.getDate()+e),t},s=function(n){try{return e.datepicker.parseDate(e.datepicker._get(t,"dateFormat"),n,e.datepicker._getFormatConfig(t))}catch(r){}var i=(n.toLowerCase().match(/^c/)?e.datepicker._getDate(t):null)||new Date,s=i.getFullYear(),o=i.getMonth(),u=i.getDate(),a=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,f=a.exec(n);while(f){switch(f[2]||"d"){case"d":case"D":u+=parseInt(f[1],10);break;case"w":case"W":u+=parseInt(f[1],10)*7;break;case"m":case"M":o+=parseInt(f[1],10),u=Math.min(u,e.datepicker._getDaysInMonth(s,o));break;case"y":case"Y":s+=parseInt(f[1],10),u=Math.min(u,e.datepicker._getDaysInMonth(s,o))}f=a.exec(n)}return new Date(s,o,u)},o=n==null||n===""?r:typeof n=="string"?s(n):typeof n=="number"?isNaN(n)?r:i(n):new Date(n.getTime());return o=o&&o.toString()==="Invalid Date"?r:o,o&&(o.setHours(0),o.setMinutes(0),o.setSeconds(0),o.setMilliseconds(0)),this._daylightSavingAdjust(o)},_daylightSavingAdjust:function(e){return e?(e.setHours(e.getHours()>12?e.getHours()+2:0),e):null},_setDate:function(e,t,n){var r=!t,i=e.selectedMonth,s=e.selectedYear,o=this._restrictMinMax(e,this._determineDate(e,t,new Date));e.selectedDay=e.currentDay=o.getDate(),e.drawMonth=e.selectedMonth=e.currentMonth=o.getMonth(),e.drawYear=e.selectedYear=e.currentYear=o.getFullYear(),(i!==e.selectedMonth||s!==e.selectedYear)&&!n&&this._notifyChange(e),this._adjustInstDate(e),e.input&&e.input.val(r?"":this._formatDate(e))},_getDate:function(e){var t=!e.currentYear||e.input&&e.input.val()===""?null:this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return t},_attachHandlers:function(t){var n=this._get(t,"stepMonths"),i="#"+t.id.replace(/\\\\/g,"\\");t.dpDiv.find("[data-handler]").map(function(){var t={prev:function(){window["DP_jQuery_"+r].datepicker._adjustDate(i,-n,"M")},next:function(){window["DP_jQuery_"+r].datepicker._adjustDate(i,+n,"M")},hide:function(){window["DP_jQuery_"+r].datepicker._hideDatepicker()},today:function(){window["DP_jQuery_"+r].datepicker._gotoToday(i)},selectDay:function(){return window["DP_jQuery_"+r].datepicker._selectDay(i,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return window["DP_jQuery_"+r].datepicker._selectMonthYear(i,this,"M"),!1},selectYear:function(){return window["DP_jQuery_"+r].datepicker._selectMonthYear(i,this,"Y"),!1}};e(this).bind(this.getAttribute("data-event"),t[this.getAttribute("data-handler")])})},_generateHTML:function(e){var t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q=new Date,R=this._daylightSavingAdjust(new Date(q.getFullYear(),q.getMonth(),q.getDate())),U=this._get(e,"isRTL"),z=this._get(e,"showButtonPanel"),W=this._get(e,"hideIfNoPrevNext"),X=this._get(e,"navigationAsDateFormat"),V=this._getNumberOfMonths(e),$=this._get(e,"showCurrentAtPos"),J=this._get(e,"stepMonths"),K=V[0]!==1||V[1]!==1,Q=this._daylightSavingAdjust(e.currentDay?new Date(e.currentYear,e.currentMonth,e.currentDay):new Date(9999,9,9)),G=this._getMinMaxDate(e,"min"),Y=this._getMinMaxDate(e,"max"),Z=e.drawMonth-$,et=e.drawYear;Z<0&&(Z+=12,et--);if(Y){t=this._daylightSavingAdjust(new Date(Y.getFullYear(),Y.getMonth()-V[0]*V[1]+1,Y.getDate())),t=G&&t<G?G:t;while(this._daylightSavingAdjust(new Date(et,Z,1))>t)Z--,Z<0&&(Z=11,et--)}e.drawMonth=Z,e.drawYear=et,n=this._get(e,"prevText"),n=X?this.formatDate(n,this._daylightSavingAdjust(new Date(et,Z-J,1)),this._getFormatConfig(e)):n,r=this._canAdjustMonth(e,-1,et,Z)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+n+"'><span class='ui-icon ui-icon-circle-triangle-"+(U?"e":"w")+"'>"+n+"</span></a>":W?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+n+"'><span class='ui-icon ui-icon-circle-triangle-"+(U?"e":"w")+"'>"+n+"</span></a>",i=this._get(e,"nextText"),i=X?this.formatDate(i,this._daylightSavingAdjust(new Date(et,Z+J,1)),this._getFormatConfig(e)):i,s=this._canAdjustMonth(e,1,et,Z)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(U?"w":"e")+"'>"+i+"</span></a>":W?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(U?"w":"e")+"'>"+i+"</span></a>",o=this._get(e,"currentText"),u=this._get(e,"gotoCurrent")&&e.currentDay?Q:R,o=X?this.formatDate(o,u,this._getFormatConfig(e)):o,a=e.inline?"":"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(e,"closeText")+"</button>",f=z?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(U?a:"")+(this._isInRange(e,u)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+o+"</button>":"")+(U?"":a)+"</div>":"",l=parseInt(this._get(e,"firstDay"),10),l=isNaN(l)?0:l,c=this._get(e,"showWeek"),h=this._get(e,"dayNames"),p=this._get(e,"dayNamesMin"),d=this._get(e,"monthNames"),v=this._get(e,"monthNamesShort"),m=this._get(e,"beforeShowDay"),g=this._get(e,"showOtherMonths"),y=this._get(e,"selectOtherMonths"),b=this._getDefaultDate(e),w="",E;for(S=0;S<V[0];S++){x="",this.maxRows=4;for(T=0;T<V[1];T++){N=this._daylightSavingAdjust(new Date(et,Z,e.selectedDay)),C=" ui-corner-all",k="";if(K){k+="<div class='ui-datepicker-group";if(V[1]>1)switch(T){case 0:k+=" ui-datepicker-group-first",C=" ui-corner-"+(U?"right":"left");break;case V[1]-1:k+=" ui-datepicker-group-last",C=" ui-corner-"+(U?"left":"right");break;default:k+=" ui-datepicker-group-middle",C=""}k+="'>"}k+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+C+"'>"+(/all|left/.test(C)&&S===0?U?s:r:"")+(/all|right/.test(C)&&S===0?U?r:s:"")+this._generateMonthYearHeader(e,Z,et,G,Y,S>0||T>0,d,v)+"</div><table class='ui-datepicker-calendar'><thead>"+"<tr>",L=c?"<th class='ui-datepicker-week-col'>"+this._get(e,"weekHeader")+"</th>":"";for(E=0;E<7;E++)A=(E+l)%7,L+="<th"+((E+l+6)%7>=5?" class='ui-datepicker-week-end'":"")+">"+"<span title='"+h[A]+"'>"+p[A]+"</span></th>";k+=L+"</tr></thead><tbody>",O=this._getDaysInMonth(et,Z),et===e.selectedYear&&Z===e.selectedMonth&&(e.selectedDay=Math.min(e.selectedDay,O)),M=(this._getFirstDayOfMonth(et,Z)-l+7)%7,_=Math.ceil((M+O)/7),D=K?this.maxRows>_?this.maxRows:_:_,this.maxRows=D,P=this._daylightSavingAdjust(new Date(et,Z,1-M));for(H=0;H<D;H++){k+="<tr>",B=c?"<td class='ui-datepicker-week-col'>"+this._get(e,"calculateWeek")(P)+"</td>":"";for(E=0;E<7;E++)j=m?m.apply(e.input?e.input[0]:null,[P]):[!0,""],F=P.getMonth()!==Z,I=F&&!y||!j[0]||G&&P<G||Y&&P>Y,B+="<td class='"+((E+l+6)%7>=5?" ui-datepicker-week-end":"")+(F?" ui-datepicker-other-month":"")+(P.getTime()===N.getTime()&&Z===e.selectedMonth&&e._keyEvent||b.getTime()===P.getTime()&&b.getTime()===N.getTime()?" "+this._dayOverClass:"")+(I?" "+this._unselectableClass+" ui-state-disabled":"")+(F&&!g?"":" "+j[1]+(P.getTime()===Q.getTime()?" "+this._currentClass:"")+(P.getTime()===R.getTime()?" ui-datepicker-today":""))+"'"+((!F||g)&&j[2]?" title='"+j[2].replace(/'/g,"&#39;")+"'":"")+(I?"":" data-handler='selectDay' data-event='click' data-month='"+P.getMonth()+"' data-year='"+P.getFullYear()+"'")+">"+(F&&!g?"&#xa0;":I?"<span class='ui-state-default'>"+P.getDate()+"</span>":"<a class='ui-state-default"+(P.getTime()===R.getTime()?" ui-state-highlight":"")+(P.getTime()===Q.getTime()?" ui-state-active":"")+(F?" ui-priority-secondary":"")+"' href='#'>"+P.getDate()+"</a>")+"</td>",P.setDate(P.getDate()+1),P=this._daylightSavingAdjust(P);k+=B+"</tr>"}Z++,Z>11&&(Z=0,et++),k+="</tbody></table>"+(K?"</div>"+(V[0]>0&&T===V[1]-1?"<div class='ui-datepicker-row-break'></div>":""):""),x+=k}w+=x}return w+=f,e._keyEvent=!1,w},_generateMonthYearHeader:function(e,t,n,r,i,s,o,u){var a,f,l,c,h,p,d,v,m=this._get(e,"changeMonth"),g=this._get(e,"changeYear"),y=this._get(e,"showMonthAfterYear"),b="<div class='ui-datepicker-title'>",w="";if(s||!m)w+="<span class='ui-datepicker-month'>"+o[t]+"</span>";else{a=r&&r.getFullYear()===n,f=i&&i.getFullYear()===n,w+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>";for(l=0;l<12;l++)(!a||l>=r.getMonth())&&(!f||l<=i.getMonth())&&(w+="<option value='"+l+"'"+(l===t?" selected='selected'":"")+">"+u[l]+"</option>");w+="</select>"}y||(b+=w+(s||!m||!g?"&#xa0;":""));if(!e.yearshtml){e.yearshtml="";if(s||!g)b+="<span class='ui-datepicker-year'>"+n+"</span>";else{c=this._get(e,"yearRange").split(":"),h=(new Date).getFullYear(),p=function(e){var t=e.match(/c[+\-].*/)?n+parseInt(e.substring(1),10):e.match(/[+\-].*/)?h+parseInt(e,10):parseInt(e,10);return isNaN(t)?h:t},d=p(c[0]),v=Math.max(d,p(c[1]||"")),d=r?Math.max(d,r.getFullYear()):d,v=i?Math.min(v,i.getFullYear()):v,e.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";for(;d<=v;d++)e.yearshtml+="<option value='"+d+"'"+(d===n?" selected='selected'":"")+">"+d+"</option>";e.yearshtml+="</select>",b+=e.yearshtml,e.yearshtml=null}}return b+=this._get(e,"yearSuffix"),y&&(b+=(s||!m||!g?"&#xa0;":"")+w),b+="</div>",b},_adjustInstDate:function(e,t,n){var r=e.drawYear+(n==="Y"?t:0),i=e.drawMonth+(n==="M"?t:0),s=Math.min(e.selectedDay,this._getDaysInMonth(r,i))+(n==="D"?t:0),o=this._restrictMinMax(e,this._daylightSavingAdjust(new Date(r,i,s)));e.selectedDay=o.getDate(),e.drawMonth=e.selectedMonth=o.getMonth(),e.drawYear=e.selectedYear=o.getFullYear(),(n==="M"||n==="Y")&&this._notifyChange(e)},_restrictMinMax:function(e,t){var n=this._getMinMaxDate(e,"min"),r=this._getMinMaxDate(e,"max"),i=n&&t<n?n:t;return r&&i>r?r:i},_notifyChange:function(e){var t=this._get(e,"onChangeMonthYear");t&&t.apply(e.input?e.input[0]:null,[e.selectedYear,e.selectedMonth+1,e])},_getNumberOfMonths:function(e){var t=this._get(e,"numberOfMonths");return t==null?[1,1]:typeof t=="number"?[1,t]:t},_getMinMaxDate:function(e,t){return this._determineDate(e,this._get(e,t+"Date"),null)},_getDaysInMonth:function(e,t){return 32-this._daylightSavingAdjust(new Date(e,t,32)).getDate()},_getFirstDayOfMonth:function(e,t){return(new Date(e,t,1)).getDay()},_canAdjustMonth:function(e,t,n,r){var i=this._getNumberOfMonths(e),s=this._daylightSavingAdjust(new Date(n,r+(t<0?t:i[0]*i[1]),1));return t<0&&s.setDate(this._getDaysInMonth(s.getFullYear(),s.getMonth())),this._isInRange(e,s)},_isInRange:function(e,t){var n,r,i=this._getMinMaxDate(e,"min"),s=this._getMinMaxDate(e,"max"),o=null,u=null,a=this._get(e,"yearRange");return a&&(n=a.split(":"),r=(new Date).getFullYear(),o=parseInt(n[0],10),u=parseInt(n[1],10),n[0].match(/[+\-].*/)&&(o+=r),n[1].match(/[+\-].*/)&&(u+=r)),(!i||t.getTime()>=i.getTime())&&(!s||t.getTime()<=s.getTime())&&(!o||t.getFullYear()>=o)&&(!u||t.getFullYear()<=u)},_getFormatConfig:function(e){var t=this._get(e,"shortYearCutoff");return t=typeof t!="string"?t:(new Date).getFullYear()%100+parseInt(t,10),{shortYearCutoff:t,dayNamesShort:this._get(e,"dayNamesShort"),dayNames:this._get(e,"dayNames"),monthNamesShort:this._get(e,"monthNamesShort"),monthNames:this._get(e,"monthNames")}},_formatDate:function(e,t,n,r){t||(e.currentDay=e.selectedDay,e.currentMonth=e.selectedMonth,e.currentYear=e.selectedYear);var i=t?typeof t=="object"?t:this._daylightSavingAdjust(new Date(r,n,t)):this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return this.formatDate(this._get(e,"dateFormat"),i,this._getFormatConfig(e))}}),e.fn.datepicker=function(t){if(!this.length)return this;e.datepicker.initialized||(e(document).mousedown(e.datepicker._checkExternalClick),e.datepicker.initialized=!0),e("#"+e.datepicker._mainDivId).length===0&&e("body").append(e.datepicker.dpDiv);var n=Array.prototype.slice.call(arguments,1);return typeof t!="string"||t!=="isDisabled"&&t!=="getDate"&&t!=="widget"?t==="option"&&arguments.length===2&&typeof arguments[1]=="string"?e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this[0]].concat(n)):this.each(function(){typeof t=="string"?e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this].concat(n)):e.datepicker._attachDatepicker(this,t)}):e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this[0]].concat(n))},e.datepicker=new o,e.datepicker.initialized=!1,e.datepicker.uuid=(new Date).getTime(),e.datepicker.version="@VERSION",window["DP_jQuery_"+r]=e}(jQuery),define("jquidatepicker",function(){}),define("views/groups",["knockout","knockoutMapping","jquidatepicker"],function(e,t,n){e.mapping=t;var r=null,i=null,s=null,o={all:".grpView",grpList:".grpList",grpEdit1:".grpEdit1",grpEdit2:".grpEdit2",grpEdit3:".grpEdit3",grpEdit4:".grpEdit4",grpMembers:".grpMembers",grpMemDeActivate:".grpMemDeActivate",grpSessions:".grpSessions",grpSessionEdit:".grpSessionEdit",grpSessionAtt:".grpSessionAtt",grpDeActivate:".grpDeActivate",grpSearch:".grpSearch",grpSearchResults:".grpSearchResults"},u=null,a=null,f=function(e,t,n){gdd.utils.slideTransitionView($(o.all),$(e),t,function(){$("select").selectmenu(),$("select").selectmenu("refresh");switch(e){case o.grpList:$("#grpHeaderText").html("Groups"),r.groups().length>0?$("#grpsNone").hide():$("#grpsNone").show();break;case o.grpEdit1:$("#grpHeaderText").html("1 of 4");break;case o.grpSearch:$("#grpHeaderText").html("Search");break;case o.grpSearchResults:$("#grpHeaderText").html("Results");break;case o.grpEdit2:$("#grpHeaderText").html("2 of 4"),r.selectedGroup.geoLat()?$(".grpEdit2GoTo4").show():$(".grpEdit2GoTo4").hide();break;case o.grpEdit3:$("#grpHeaderText").html("3 of 4"),gdd.session.activeSession.portalSettings.allowGroupStreetAddresses?($("#grpEditShowStreetInfo").show(),$("#grpEditHideStreetInfo").hide()):($("#grpEditShowStreetInfo").hide(),$("#grpEditHideStreetInfo").show()),r.selectedGroup.suburb()?$("#grpEditSuburb").hide():$("#grpEditSuburb").show();break;case o.grpEdit4:$("#grpHeaderText").html("4 of 4");break;case o.grpMembers:$("#grpHeaderText").html("Members");break;case o.grpMemDeActivate:$("#grpHeaderText").html("DeActivate"),gdd.session.activeSession.portalSettings.allowGroupMemberDelete?$("#btnDeleteMemberForever").show():$("#btnDeleteMemberForever").hide();break;case o.grpSessions:$("#grpHeaderText").html("Sessions");break;case o.grpSessionEdit:$("#grpHeaderText").html("Edit"),r.selectedGroupSession.id()<0?$("#btnGrpDeleteSession").hide():$("#btnGrpDeleteSession").show();break;case o.grpSessionAtt:$("#grpHeaderText").html("Attendance");break;case o.grpDeActivate:$("#grpHeaderText").html("DeActivate")}n&&n()})},l=function(){r.refData.typesAllowed().length===0?gdd.utils.requestPermission("Request permission to add a group."):(r.selectedGroup.groupTypeId(r.refData.typesAllowed()[0].typeId),r.selectedGroup.groupType(r.refData.typesAllowed()[0].typeName),r.selectedGroup.categoryId(r.refData.typesAllowed()[0].catId),r.selectedGroup.categoryName(r.refData.typesAllowed()[0].catName),r.selectedGroup.leaderId(gdd.session.personId()),r.selectedGroup.id(-1),r.selectedGroup.gender("M/F"),r.selectedGroup.meetingDay("Unknown"),r.selectedGroup.meetingTime(""),r.selectedGroup.meetingFrequency("Weekly"),r.selectedGroup.groupName(""),r.selectedGroup.groupDescription(""),r.selectedGroup.geoLocationId(-1),r.selectedGroup.geoLat(null),r.selectedGroup.geoLng(null),r.selectedGroup.ageProfileId(r.refData.ageProfiles()[0].id),r.selectedGroup.ageProfile(r.refData.ageProfiles()[0].name),r.selectedGroup.isActive(!0),r.selectedGroup.isPrivate(!1),r.selectedGroup.openMembership(!0),r.selectedGroup.members.removeAll(),r.selectedGroup.sessions.removeAll(),r.selectedGroup.regionId(r.refData.regions()[0].id),r.selectedGroup.regionName(r.refData.regions()[0].name),f(o.grpEdit1,"left"))},c=function(){if(r.refData.typesAllowed().length===0)gdd.utils.requestPermission("Request permission to edit groups.");else{var e=$.grep(r.refData.typesAllowed(),function(e,t){return e.typeId==r.selectedGroup.groupTypeId});e.length===0&&(r.selectedGroup.groupTypeId(r.refData.typesAllowed()[0].typeId),r.selectedGroup.groupType(r.refData.typesAllowed()[0].typeName),r.selectedGroup.categoryId(r.refData.typesAllowed()[0].catId),r.selectedGroup.categoryName(r.refData.typesAllowed()[0].catName)),$.when($(o.all).hide("slide",{direction:"left"})).then(function(){$(o.grpEdit1).show("slide",{direction:"right"})})}},h=function(e,t){if(r.groups().length>0)p(),e();else{var n={};n.leaderId=gdd.session.personId(),gdd.api.callApi("Groups/SearchGroups","POST",n,{success:function(t){r.groups.removeAll(),$.each(t.gddData,function(e,t){r.groups.push(t)}),p(),e()},fail:function(e){t(e.msg)}})}},p=function(){$(".grpListCollSet").collapsibleset("refresh");var t=function(t){if(t!=r.selectedGroup.id()){r.selectedGroup.sessions.removeAll(),r.selectedGroup.members.removeAll();var n=$.grep(r.groups(),function(e,n){return e.id==t});e.mapping.mergeFromJS(r.selectedGroup,e.mapping.toJS(n[0]))}};$(".btnGroupMenu").off().on(gdd.click(),function(){t($(this).attr("data-id")),gdd.showPopup("popupGrpMenu")}),$(".btnActivateGroup").off().on(gdd.tap(),function(){t($(this).attr("data-id")),r.selectedGroup.isActive(!0),c()})},d=function(){r.selectedGroupSession.attendance.removeAll(),$.each(r.groups,function(e,t){t.sessions&&$.each(t.sessions,function(e,t){t.attendance&&(t.attendance.length=0)})})},v=function(e){e||(e=o.grpList),r.selectedGroup.members().length>0?(g(),f(o.grpMembers,"up",function(){$(".grpMembersBack").off().one(gdd.tap(),function(){f(e,"down")})})):(gdd.showLoader("Loading members..."),T(function(){gdd.hideLoader(),g(),f(o.grpMembers,"up",function(){$(".grpMembersBack").off().one(gdd.tap(),function(){f(e,"down")})})},function(e){gdd.hideLoader(),gdd.showErr(e)}))},m=function(){r.selectedGroup.sessions().length>0?(f(o.grpSessions,"down",function(){$(".grpSessionsBack").off().on(gdd.tap(),function(){f(o.grpList,"right")})}),y()):(gdd.showLoader("Loading sessions..."),gdd.api.callApi("Groups/GetGroupsSessions","GET",{groupId:r.selectedGroup.id()},{success:function(e){gdd.hideLoader(),r.selectedGroup.sessions.removeAll();var t=r.selectedGroup.sourceRecord();t.sessions||(t.sessions=new Array),t.sessions.length=0,$.each(e.gddData,function(e,n){t.sessions.push(n),r.selectedGroup.sessions.push(n)}),y(),r.selectedGroup.sessions().length===0?gdd.showMsg("Let's add your first session for this group.",function(){b(),$(".grpSessionsBack").off().on(gdd.tap(),function(){f(o.grpList,"right")})}):f(o.grpSessions,"down",function(){$(".grpSessionsBack").off().on(gdd.tap(),function(){f(o.grpList,"right")})})},fail:function(e){gdd.hideLoader(),gdd.showErr(e.msg)}}))},g=function(){var t=function(t){var n=$.grep(r.selectedGroup.members(),function(e,n){return e.id==t});e.mapping.mergeFromJS(r.selectedGroupMember,e.mapping.toJS(n[0]))};$(".memberDelete").off().on(gdd.click(),function(){t($(this).attr("data-id")),r.selectedGroupMember.personId()==r.selectedGroup.leaderId()?gdd.showMsg("You cannot de-activate the leader of the group."):f(o.grpMemDeActivate,"up",function(){$(".grpMemDeActivateBack").off().one(gdd.tap(),function(){f(o.grpMembers,"down")})})}),$(".memberActivate").off().on(gdd.click(),function(){t($(this).attr("data-id")),gdd.showLoader("Activating..."),N(r.selectedGroupMember.personId(),r.selectedGroup.id(),!0,"","",function(e){gdd.hideLoader()},function(e){gdd.hideLoader(),gdd.showErr(e)})})},y=function(){var t=function(t){var n=$.grep(r.selectedGroup.sessions(),function(e,n){return e.id==t});e.mapping.mergeFromJS(r.selectedGroupSession,e.mapping.toJS(n[0]))};$(".btnGrpSessionEdit").off().on(gdd.click(),function(){t($(this).attr("data-id")),f(o.grpSessionEdit,"up",function(){$(".grpSessionEditBack").off().one(gdd.tap(),function(){f(o.grpSessions,"down")})})}),$(".btnGrpSessionRegister").off().on(gdd.tap(),function(){var e=$(this).attr("data-id");e!=r.selectedGroupSession.id()&&(r.selectedGroupSession.attendance.removeAll(),t(e)),S()})},b=function(){var e=gdd.utils.getDt();r.selectedGroupSession.id(-1),r.selectedGroupSession.name(""),r.selectedGroupSession.moreInfo(""),r.selectedGroupSession.unixSessionDate(e.unix),r.selectedGroupSession.sessionDateDisplay(e.display),r.selectedGroupSession.groupId(r.selectedGroup.id()),r.selectedGroupSession.attendance.removeAll(),f(o.grpSessionEdit,"up",function(){$(".grpSessionEditBack").off().one(gdd.tap(),function(){f(o.grpSessions,"down")})})},w=function(e,t){if(r.refData.groupMeetingFrequencies().length>0)e();else{var n=function(t){var n=gdd.permissions().secLevel;r.refData.categories.removeAll(),r.refData.typesAllowed.removeAll();var i=new Array;$.each(t.groupCategories,function(e,t){r.refData.categories.push(t),n>=t.editMinSecLevel&&$.each(t.types,function(e,r){if(n>=r.editMinSecLevel){var s={};s.typeId=r.id,s.typeName=r.name,s.name=r.name,s.catId=r.categoryId,s.catName=t.name,s.description=r.description,s.editLabel=r.mobileAppAssignLabel,i.push(s)}})}),i.sort(function(t,n){return t.name<n.name?-1:t.name>n.name?1:0}),$.each(i,function(e,t){r.refData.typesAllowed.push(t)}),r.refData.suburbs.removeAll(),$.each(t.groupSuburbs,function(e,t){r.refData.suburbs.push(t)}),r.refData.ageProfiles.removeAll(),$.each(t.ageProfiles,function(e,t){r.refData.ageProfiles.push(t)}),r.refData.regions.removeAll(),$.each(t.regions,function(e,t){t.targetGrps&&r.refData.regions.push(t)}),r.refData.groupsInActiveReasons.removeAll(),$.each(t.groupsInActiveReasons,function(e,t){r.refData.groupsInActiveReasons.push(t)}),r.refData.groupMeetingFrequencies.removeAll(),$.each(t.groupMeetingFrequencies,function(e,t){r.refData.groupMeetingFrequencies.push(t)}),r.refData.groupMembersInActiveReasons.removeAll(),$.each(t.groupMembersInActiveReasons,function(e,t){r.refData.groupMembersInActiveReasons.push(t)}),e()},i={};i.groupCategories="1",i.ageProfiles="1",i.groupSuburbs="1",i.groupsInActiveReasons="1",i.groupMembersInActiveReasons="1",i.regions="1",i.groupNamingConventions="1",i.groupMeetingFrequency="1";var s=!1,o=gdd.storage.getGrpRefData()||new Array;if(o)try{o.groupCategories.length>0&&o.groupMeetingFrequencies.length>0&&o.groupNamingConventions.length>0&&o.regions.length>0&&o.ageProfiles.length>0&&o.groupSuburbs.length>0&&o.groupsInActiveReasons.length>0&&o.groupMembersInActiveReasons.length>0?(s=!1,n(o)):s=!0}catch(u){s=!0}else s=!0;s&&gdd.api.callApi("RefData/GetRefData","POST",i,{success:function(e){gdd.storage.saveGrpRefData(e.gddData),n(e.gddData)},fail:function(e){t(e.msg)}})}},E=function(){$(".grpAttendanceList").listview("refresh"),$(".grpSessionAttFlipSwtch").flipswitch(),$(".grpSessionAttFlipSwtch").flipswitch("refresh"),$(".grpSessionAttFlipSwtch").off().on("change",function(t){var n=$(this).attr("data-id"),i=$.grep(r.selectedGroupSession.attendance(),function(e,t){return e.id==n});e.mapping.mergeFromJS(r.selectedSessionAttendanceRecord,i[0]);var s=null;$(this).is(":checked")?s=!0:s=!1,gdd.showLoader("Working..."),gdd.api.callApi("Groups/UpdateGroupsSessionAttendance","GET",{sessionId:r.selectedGroupSession.id(),personId:r.selectedSessionAttendanceRecord.personId(),attended:s},{success:function(e){gdd.hideLoader();var t=$.grep(r.selectedGroupSession.attendance(),function(e,t){return e.id==r.selectedSessionAttendanceRecord.id()});t[0].attended=s},fail:function(e){gdd.hideLoader(),gdd.showErr(e.msg)}})})},S=function(){r.selectedGroupSession.attendance().length>0?(E(),f(o.grpSessionAtt,"up",function(){$(".grpSessionAttBack").off().one(gdd.tap(),function(){m()})})):(gdd.showLoader("Loading..."),gdd.api.callApi("Groups/GetSessionAttendanceRegister","GET",{sessionId:r.selectedGroupSession.id()},{success:function(e){gdd.hideLoader(),$.each(e.gddData,function(e,t){r.selectedGroupSession.attendance.push(t)}),E(),f(o.grpSessionAtt,"up",function(){$(".grpSessionAttBack").off().one(gdd.tap(),function(){m()})})},fail:function(e){gdd.hideLoader(),gdd.showErr(e.msg)}}))},x=function(t,n){var i=e.mapping.toJS(r.selectedGroup);gdd.api.callApi("Groups/UpdateGroup","POST",i,{success:function(e){gdd.hideLoader();var n=e.gddData[0],i=$.grep(r.groups(),function(e,t){return e.id==n.id}),s=0;i.length>0&&(s=r.groups.indexOf(i[0]),r.groups.splice(s,1)),r.groups.splice(s,0,n),p(),t()},fail:function(e){n(e.msg)}})},T=function(e,t){r.selectedGroup.members().length>0?e():gdd.api.callApi("Groups/GetGroupMembers","GET",{groupId:r.selectedGroup.id()},{success:function(t){r.selectedGroup.members.removeAll();var n=r.selectedGroup.sourceRecord();n.members||(n.members=new Array),n.members.length=0,$.each(t.gddData,function(e,t){r.selectedGroup.members.push(t),n.members.push(t)}),e()},fail:function(e){t(e.msg)}})},N=function(e,t,n,i,s,o,u){var a={};a.personId=e,a.groupId=t,a.isActive=n,a.inActiveReasonId=i,a.moreInfo=s,gdd.api.callApi("Groups/UpdateGroupMemberStatus","POST",a,{success:function(e){var t=e.gddData[0],n=$.grep(r.selectedGroup.members(),function(e,n){var r=!1;return e.id==t.id?r=!0:e.personId==t.personId&&(r=!0),r}),i=0;n.length>0&&$.each(n,function(e,t){i=r.selectedGroup.members.indexOf(t),r.selectedGroup.members.splice(i,1)}),r.selectedGroup.members.splice(i,0,t),$(".membersListView").listview("refresh"),g(),r.selectedGroupSession.attendance.removeAll(),$.each(r.groups,function(e,t){t.sessions&&$.each(t.sessions,function(e,t){t.attendance&&(t.attendance.length=0)})}),o()},fail:function(e){u(e.msg)}})},C=function(){$(".grpSearchCollSet").collapsibleset("refresh");var e=function(e){var t=$.grep(r.loadedGroups(),function(t,n){return t.id==e});t.length>0&&(r.selectedGroup=t[0])};$(".groupSearchItem").off().on(gdd.click(),function(t){$("#grpSearchErr").hide(),e($(this).attr("data-id"));switch(r.searchReason){case 1:$("#grpSearchResultsActions").popup("open",{transition:"slideup"});break;case 2:r.callBackFunction(r.selectedGroup),gdd.app.loadPage(r.callingPage,{transition:"flip",reverse:"true"});break;case 3:gdd.app.showGlbMsg("Thank You","<p>Please give the person the information needed to contact the group leader.<p/><p>In a weeks time please confirm that they were able to contact the leader.</p><p>When you are done click the 'tick' button on the top of the screen.</p>")}})},k=function(){$("#btnGrpSearchMapView").on(gdd.tap(),function(){var e=new Array,t="";$.each(r.searchedGroups(),function(n,r){t='<div style="width:200px; height:150px" ><strong>'+r.groupName+"</strong>",t+='<table width="100%">',t+="<tr><td>Leader</td><td>"+r.leaderName+"</td></tr>",t+="<tr><td>Tel</td><td>"+r.leaderMobileNumber+"</td></tr>",t+="<tr><td>Day</td><td>"+r.meetingDay+"</td></tr>",t+="</table></div>",e.push({lat:r.geoLat,lng:r.geoLng,pinColor:"red",content:t})}),i=1,gdd.pages.gmap.view.configureForDropPins(e),gdd.loadPage(gdd.pages.gmap,!1,"slideup")}),$("#btnGrpSearchReset").on(gdd.tap(),function(){r.grpQry.ageProfileId(undefined),r.grpQry.regionId(undefined),r.grpQry.categoryId(""),r.grpQry.groupTypeId(""),r.grpQry.gender(""),r.grpQry.meetingDay(""),r.grpQry.suburb(undefined),r.grpQry.restrictToPortal(!0),r.grpQry.isActive(1),r.grpQry.matchAll(!0),$("select").selectmenu("refresh")}),$(".grpSearchResultsBack").on(gdd.tap(),function(){f(o.grpSearch,"right")}),$("#btnGrpSearch").on(gdd.tap(),function(){f(o.grpSearch,"up")}),$(".btnAddNewGroup").on(gdd.click(),function(){l()}),$(".grpEdit1Back").on(gdd.click(),function(){f(o.grpList,"right")}),$(".grpEdit1Next").on(gdd.click(),function(){r.selectedGroup.groupName()&&r.selectedGroup.groupDescription()?f(o.grpEdit2,"left"):gdd.showMsg("Please ensure you have entered a name for the group and given a brief description about the group. e.g. Mens discipleship.")}),$(".grpEditCancel").on(gdd.click(),function(){f(o.grpList,"right")}),$(".grpEdit2Back").on(gdd.click(),function(){f(o.grpEdit1,"right")}),$(".grpEdit2Next").on(gdd.click(),function(){gdd.pages.gmap.view.configurePageForAddressEdit(function(e){s=!0,r.selectedGroup.streetNumber(e.streetNumber),r.selectedGroup.streetName(e.streetName),r.selectedGroup.geoLat(e.geoLat),r.selectedGroup.geoLng(e.geoLng),r.selectedGroup.area(e.area),r.selectedGroup.city(e.city),r.selectedGroup.country(e.country),r.selectedGroup.postalCode(e.postalCode),r.selectedGroup.region(e.streetName),r.selectedGroup.suburb(e.suburb),r.selectedGroup.geoAddress(e.formatted_address)},gdd.pages.groups,r.selectedGroup.geoLat(),r.selectedGroup.geoLng(),1),gdd.utils.loadPage(gdd.pages.gmap,!1,"slideup")}),$(".grpEdit3Back ").on(gdd.click(),function(){f(o.grpEdit2,"right")}),$(".grpEdit3Next").on(gdd.click(),function(){f(o.grpEdit4,"left")}),$(".grpEdit4Back").on(gdd.click(),function(){f(o.grpEdit2,"right")}),$("#grpEdit4Save").on(gdd.click(),function(){gdd.showLoader("Updating..."),x(function(){gdd.hideLoader(),f(o.grpList,"left")},function(e){gdd.hideLoader(),gdd.showErr(e)})}),$(".grpEdit2GoTo4").on(gdd.click(),function(){f(o.grpEdit4,"left")}),$("#btnGrpEdit").on(gdd.click(),function(){$("#popupGrpMenu").one("popupafterclose",function(e,t){c()}),$("#popupGrpMenu").popup("close")}),$("#btnGrpViewMembers").on(gdd.click(),function(){$("#popupGrpMenu").one("popupafterclose",function(e,t){v()}),$("#popupGrpMenu").popup("close")}),$("#btnDeleteMemberForever").on(gdd.click(),function(){gdd.showPopup("memberDeletePopup")}),$("#btnMemberConfirmDelete").on(gdd.click(),function(){$("#memberDeletePopup").one("popupafterclose",function(e,t){gdd.showLoader("Deleting..."),gdd.api.callApi("Groups/DeleteMemberFromGroup","GET",{memberId:r.selectedGroupMember.personId(),groupId:r.selectedGroup.id()},{success:function(e){gdd.hideLoader();var t=$.grep(r.selectedGroup.members(),function(e,t){return e.personId==r.selectedGroupMember.personId()});r.selectedGroup.members.splice(r.selectedGroup.members.indexOf(t[0]),1),f(o.grpMembers,"up"),d()},fail:function(e){gdd.hideLoader(),gdd.showErr(e.msg)}})}),$("#memberDeletePopup").popup("close")}),$("#btnGrpDeActivateMemGo").on(gdd.click(),function(){if(r.selectedGroupMember.personId()==r.selectedGroup.leaderId())gdd.showMsg("You cannot de-activate the leader of the group.");else{var e=$("#ddlGrpMemDeActiveReason").val(),t=$("#grpMemDeActivateMoreInfo").val();e&&t?(gdd.showLoader("De-Activating..."),N(r.selectedGroupMember.personId(),r.selectedGroup.id(),!1,e,t,function(e){gdd.hideLoader(),f(o.grpMembers,"up")},function(e){gdd.hideLoader(),gdd.showErr(e)})):gdd.showMsg("Please provide the reason why you are de-activating this person from the group.")}}),$("#popupGrpMenu").on("popupbeforeposition",function(e,t){gdd.session.activeSession.portalSettings.allowGroupDelete?$("#btnDeleteGroup").show():$("#btnDeleteGroup").hide()}),$("#btnGrpAttendance").on(gdd.click(),function(){$("#popupGrpMenu").one("popupafterclose",function(e,t){gdd.showLoader("Loading members..."),T(function(){gdd.hideLoader(),m()},function(e){gdd.hideLoader(),gdd.showErr(e)})}),$("#popupGrpMenu").popup("close")}),$("#btnUpdateGrpSession").on(gdd.tap(),function(){r.selectedGroupSession.name()?r.selectedGroupSession.unixSessionDate()?(gdd.showLoader("Updating..."),gdd.api.callApi("Groups/UpdateGroupsSession","POST",e.mapping.toJS(r.selectedGroupSession),{success:function(e){gdd.hideLoader();var t=0,n=$.grep(r.selectedGroup.sessions(),function(t,n){return t.id==e.gddData[0].id});n.length>0&&(t=r.selectedGroup.sessions.indexOf(n[0]),r.selectedGroup.sessions.splice(t,1)),r.selectedGroup.sessions.splice(t,0,e.gddData[0]);var i=r.selectedGroup.sourceRecord(),s=$.grep(i.sessions,function(t,n){return t.id==e.gddData[0].id});s.length>0&&(t=i.sessions.indexOf(n[0]),i.sessions.splice(t,1)),i.sessions.splice(t,0,e.gddData[0]),y(),f(o.grpSessions,"down")},fail:function(e){gdd.hideLoader(),gdd.showErr(e.msg)}})):gdd.showMsg("Please provide a session date"):gdd.showMsg("Please provide a session name")}),$("#btnAddGroupSession").on(gdd.tap(),function(){b()}),$("#btnManageMembers").on(gdd.tap(),function(){v(o.grpSessions)}),$("#btnGrpDeleteYes").on(gdd.tap(),function(){$("#grpDeletePopup").one("popupafterclose",function(e,t){gdd.showLoader("Deleting group..."),gdd.api.callApi("Groups/DeleteGroup","GET",{groupId:r.selectedGroup.id()},{success:function(e){gdd.hideLoader();var t=$.grep(r.groups(),function(e,t){return e.id==r.selectedGroup.id()});r.groups.splice(r.groups.indexOf(t[0]),1)},fail:function(e){gdd.hideLoader(),gdd.showErr(e.msg)}})}),$("#grpDeletePopup").popup("close")}),$("#btnDeleteGroup").on(gdd.click(),function(){$("#popupGrpMenu").one("popupafterclose",function(e,t){gdd.showPopup("grpDeletePopup")}),$("#popupGrpMenu").popup("close")}),$("#btnGrpDeActivateMi").on(gdd.click(),function(){$("#popupGrpMenu").one("popupafterclose",function(e,t){f(o.grpDeActivate,"up",function(){$(".grpDeActivateBack").off().one(gdd.tap(),function(){f(o.grpList,"down")})})}),$("#popupGrpMenu").popup("close")}),$("#btnDeActivateGroup").on(gdd.tap(),function(){var e=$("#ddlGrpDeActiveReason").val(),t=$("#grpDeActivateMoreInfo").val();t?(r.selectedGroup.stsReasonId(e),r.selectedGroup.stsMoreInfo(t),r.selectedGroup.isActive(!1),gdd.showLoader("De-Activating..."),x(function(){gdd.hideLoader(),f(o.grpList,"down")},function(e){gdd.hideLoader(),gdd.showErr(e)})):gdd.showMsg("Please give us a little more info why you are de-activating this group.")}),$("#btnGrpDeleteSession").on(gdd.tap(),function(){gdd.showLoader("Deleting..."),gdd.api.callApi("Groups/DeleteGroupSession","GET",{sessionId:r.selectedGroupSession.id()},{success:function(e){gdd.hideLoader();var t=$.grep(r.selectedGroup.sessions(),function(e,t){return e.id==r.selectedGroupSession.id()});r.selectedGroup.sessions.splice(r.selectedGroup.sessions.indexOf(t[0]),1);var n=r.selectedGroup.sourceRecord(),i=$.grep(n.sessions,function(e,t){return e.id==r.selectedGroupSession.id()});n.sessions.splice(n.sessions.indexOf(t[0]),1),r.selectedGroup.sessions().length===0?f(o.grpList,"down"):f(o.grpSessions,"down")},fail:function(e){gdd.hideLoader(),gdd.showErr(e.msg)}})}),$(".btnAddNewMember").on(gdd.tap(),function(){u=null,gdd.pages.people.view.clb=function(e){gdd.loadPage(gdd.pages.groups,!0),u=e,a=o.grpMembers},gdd.loadPage(gdd.pages.people)}),$(".btnAddNewMemberFromSession").on(gdd.tap(),function(){u=null,gdd.pages.people.view.clb=function(e){gdd.loadPage(gdd.pages.groups,!0),u=e,a=o.grpSessionAtt},gdd.loadPage(gdd.pages.people)}),gdd.utils.initDatePicker("grpSessionDate",function(e){r.selectedGroupSession.unixSessionDate(e.unix)}),$("#ddlGrpCatType").on("change",function(){var e=$(this).val();if(e){var t=$.grep(r.refData.typesAllowed(),function(t,n){return t.typeId==e});r.selectedGroup.groupTypeId(t[0].typeId),r.selectedGroup.groupType(t[0].typeName),r.selectedGroup.categoryId(t[0].catId),r.selectedGroup.categoryName(t[0].catName)}}),$("#ddlGrpSearchCatType").on("change",function(){var e=$(this).val();if(e){var t=$.grep(r.refData.typesAllowed(),function(t,n){return t.typeId==e});r.grpQry.groupTypeId(t[0].typeId),r.grpQry.categoryId(t[0].catId)}else r.grpQry.categoryId(""),r.grpQry.groupTypeId("")}),$(".grpSearchBack").on(gdd.tap(),function(){f(o.grpList,"down")}),$("#btnGrpSearchExecute").on(gdd.tap(),function(){gdd.showLoader("Searching...");var t=e.mapping.toJS(r.grpQry);gdd.api.callApi("Groups/SearchGroups","POST",t,{success:function(e){gdd.hideLoader(),e.gddData.length===0?gdd.showMsg("There are no groups matching your search criteria."):(r.searchedGroups.removeAll(),$.each(e.gddData,function(e,t){r.searchedGroups.push(t)}),C(),f(o.grpSearchResults,"left"))},fail:function(e){gdd.hideLoader(),gdd.showErr(e.msg)}})}),$("#btnRefreshGroups2").on(gdd.tap(),function(){$("#popupGrpMore").one("popupafterclose",function(e,t){r.groups.removeAll(),gdd.showLoader("Reloading your groups..."),h(function(){gdd.hideLoader()},function(){gdd.hideLoader()})}),$("#popupGrpMore").popup("close")}),$("#btnShowGrpMore").on(gdd.click(),function(){var e={positionTo:$(this)};gdd.utils.showPopup("popupGrpMore",e)}),$("#btnRefreshGrpRefData").on(gdd.click(),function(){$("#popupGrpMore").one("popupafterclose",function(e,t){gdd.storage.saveGrpRefData(null),r.refData.groupMeetingFrequencies.removeAll(),gdd.showLoader("Loading core data..."),w(function(){gdd.hideLoader()},function(e){gdd.hideLoader(),gdd.showErr(e)})}),$("#popupGrpMore").popup("close")}),$("#btnGrpMemSendSMS").on(gdd.click(),function(){$("#popupGrpMenu").one("popupafterclose",function(e,t){gdd.utils.isNative()?(gdd.showLoader("Loading members..."),T(function(){gdd.hideLoader();try{var e="";$.each(r.selectedGroup.members(),function(t,n){e=e+n.mobileNumber+", "});var t="",n="INTENT",i=function(){gdd.hideLoader(),gdd.showMsg("Message sent successfully")},s=function(e){gdd.hideLoader(),gdd.showErr("Message Failed:"+e)};gdd.showLoader("Opening sms module..."),setTimeout(function(){gdd.hideLoader()},5e3),sms.send(e,t,n,i,s)}catch(o){gdd.showErr("SMS ERROR: "+JSON.stringify(o))}},function(e){gdd.hideLoader(),gdd.showErr(e)})):gdd.showMsg("Sending SMS is only available when running this application natively on your phone.")}),$("#popupGrpMenu").popup("close")})};return{searchedGroups:e.observableArray(),grpQry:{leaderId:e.observable(""),ageProfileId:e.observable(undefined),categoryId:e.observable(""),regionId:e.observable(undefined),gender:e.observable(""),groupTypeId:e.observable(""),meetingDay:e.observable(""),suburb:e.observable(undefined),restrictToPortal:e.observable(!0),isActive:e.observable(1),openMembership:e.observable(-1),isPrivate:e.observable(-1),matchAll:e.observable(!0)},selectedGroupMember:{id:e.observable(""),personId:e.observable(""),groupId:e.observable(""),userChanged:e.observable(""),dateChanged:e.observable(""),isActive:e.observable(!0),inActiveReason:e.observable(""),inActiveReasonId:e.observable(""),moreInfo:e.observable(""),firstName:e.observable(""),lastName:e.observable(""),mobileNumber:e.observable(""),email:e.observable(""),birthday:e.observable(""),groupName:e.observable(""),typeId:e.observable(""),category:e.observable(""),categoryId:e.observable(""),portalName:e.observable(""),portalId:e.observable(""),orgId:e.observable(""),displayName:e.observable(""),sourceRecord:{}},selectedGroup:{leaderId:e.observable(""),leaderName:e.observable(""),leaderEmail:e.observable(""),leaderMobileNumber:e.observable(""),id:e.observable(""),categoryId:e.observable(""),categoryName:e.observable(""),groupTypeId:e.observable(""),groupType:e.observable(""),gender:e.observable(""),meetingDay:e.observable("Unknown"),meetingTime:e.observable(""),meetingFrequency:e.observable(""),groupName:e.observable(""),groupDescription:e.observable(""),portalId:e.observable(""),portalName:e.observable(""),leadersFacebookId:e.observable(""),geoLocationId:e.observable(""),geoLat:e.observable(""),geoLng:e.observable(""),geoAddress:e.observable(""),ageProfileId:e.observable(""),ageProfile:e.observable(""),userChanged:e.observable(""),dateChanged:e.observable(""),isActive:e.observable(!0),fullAddressRequired:e.observable(!0),streetNumber:e.observable(""),streetName:e.observable(""),suburb:e.observable(""),area:e.observable(""),region:e.observable(""),city:e.observable(""),country:e.observable(""),postalCode:e.observable(""),otherInfo:e.observable(""),isPrivate:e.observable(!1),openMembership:e.observable(!0),stsId:e.observable(""),stsIsActive:e.observable(!0),stsMoreInfo:e.observable(""),stsReason:e.observable(""),stsDateChanged:e.observable(""),stsUserChanged:e.observable(""),members:e.observableArray(),sourceRecord:{},sessions:e.observableArray(),stsReasonId:e.observable(""),regionId:e.observable(""),regionName:e.observable(""),sourceRecord:function(){var e=$.grep(r.groups(),function(e,t){return e.id==r.selectedGroup.id()});return e[0]}},selectedGroupSession:{id:e.observable(""),name:e.observable(""),moreInfo:e.observable(""),flagSession:e.observable(!1),userChanged:e.observable(""),dateChanged:e.observable(""),unixSessionDate:e.observable(""),sessionDateDisplay:e.observable(""),groupId:e.observable(""),attendance:e.observableArray()},selectedSessionAttendanceRecord:{id:e.observable(""),personId:e.observable(""),name:e.observable(""),mobileNumber:e.observable(""),email:e.observable(""),attendanceId:e.observable(""),attended:e.observable(""),dateChanged:e.observable(""),userChanged:e.observable(""),sessionId:e.observable(""),groupId:e.observable(""),sessionDate:e.observable(""),sessionName:e.observable("")},groups:e.observableArray(),create:function(){r=this,gdd.utils.configMergeFromJs(e),k(),e.applyBindings(gdd,document.getElementById(gdd.utils.activePage.id))},show:function(){s?(r.selectedGroup.geoLat()?f(o.grpEdit3,"left"):gdd.showMsg("You did not select an address from the previous screen. Please ensure you move the 'red pin' on the map to the location of this group.",function(){f(o.grpEdit2,"left")}),$("select").selectmenu("refresh"),s=!1,p()):u?(p(),gdd.showLoader("Adding '"+u.firstName+"'"),N(u.id,r.selectedGroup.id,!0,"","",function(){gdd.hideLoader(),g(),u=null,a==o.grpMembers?v():(r.selectedGroupSession.attendance.removeAll(),y(),S())},function(e){gdd.hideLoader(),gdd.showErr(e)})):i===1?(p(),C(),f(o.grpSearchResults,"up"),i=null):(gdd.showLoader("Loading data..."),w(function(){gdd.showLoader("Loading your groups..."),h(function(){gdd.hideLoader(),r.groups().length>0?f(o.grpList,"up"):gdd.showMsg("You have no groups in this database. Lets start by adding your first group.",function(){l()})},function(e){gdd.hideLoader(),gdd.showErr(e)})},function(e){gdd.hideLoader(),gdd.showErr(e)}))},beforeShow:function(){},beforeHide:function(){s=!1},endOldSession:function(){gdd.pages.groups.view.groups.removeAll(),gdd.pages.groups.view.refData.categories.removeAll(),gdd.pages.groups.view.refData.suburbs.removeAll(),gdd.pages.groups.view.refData.ageProfiles.removeAll(),gdd.pages.groups.view.refData.groupsInActiveReasons.removeAll(),gdd.pages.groups.view.refData.groupMembersInActiveReasons.removeAll(),gdd.pages.groups.view.refData.regions.removeAll(),gdd.pages.groups.view.refData.groupMeetingFrequencies.removeAll(),gdd.pages.groups.view.refData.typesAllowed.removeAll()},refData:{categories:e.observableArray(),suburbs:e.observableArray(),ageProfiles:e.observableArray(),groupsInActiveReasons:e.observableArray(),groupMembersInActiveReasons:e.observableArray(),regions:e.observableArray(),groupMeetingFrequencies:e.observableArray(),typesAllowed:e.observableArray()}}}),define("views/gmap",["knockout","knockoutMapping"],function(e,t){e.mapping=t;var n=null,r="http://maps.google.com/mapfiles/ms/icons/red-dot.png",i="http://maps.google.com/mapfiles/ms/icons/green-dot.png",s=function(e){navigator.geolocation?navigator.geolocation.getCurrentPosition(function(t){var n={};n={lat:t.coords.latitude,lng:t.coords.longitude},e(n)},function(){e(null)},{timeout:4e4}):e(null)},o=function(e,t,n,r,i){var s=$("#"+e);s.autocomplete({minLength:10,source:function(e,n){t.geocode({address:e.term},function(e,t){n($.map(e,function(e){return{label:e.formatted_address,value:e.formatted_address,geocode:e}}))})},select:function(e,t){n.fitBounds(t.item.geocode.geometry.viewport),r.setPosition(t.item.geocode.geometry.location);var s=a(t.item.geocode);i(s)}})},u=function(e,t,n,r,i){request={},request[e]=t,e||(e="address");if(!t)throw"You must provide an address value to search";if(!r||!i)throw"You must provide both a success and fail callback function.";n.geocode(request,function(n,s){s==google.maps.GeocoderStatus.OK?n[0]?r(n[0]):i("Sorry, something went wrong. Goolge was able to geocode the request, but their servers did not send a response. Try Again!"):e=="address"?i("Sorry! We couldn't find "+t+". Try a different search term, or click the map."):i("Eish, thats pretty remote. Google was unable to perform a reverse lookup of the co-ordinates you provided.")})},a=function(e){var t={lat:null,lng:null,streetNumber:null,streetName:null,suburb:null,area:null,postalCode:null,city:null,region:null,country:null,formatted_address:null},n={streetNumber:"",streetAddress:"",route:"",neighborhood:"",subLocality1:"",subLocality2:"",locality:"",admin1:"",admin2:"",admin3:"",postalCode:"",country:""};return $.each(e.address_components,function(e,t){var r=t.types[0];r==="street_number"&&(n.streetNumber=t.long_name),r==="street_address"&&(n.streetAddress||(n.streetAddress=t.long_name)),r==="route"&&(n.route||(n.route=t.long_name)),r==="neighborhood"&&(n.neighborhood||(n.neighborhood=t.long_name));if(r==="sublocality"||r==="sublocality_level_2"||r==="sublocality_level_1")n.subLocality1?!n.subLocality2&&n.subLocality1!==t.long_name&&(n.subLocality2=t.long_name):n.subLocality1=t.long_name;r==="locality"&&(n.locality||(n.locality=t.long_name)),r==="administrative_area_level_1"&&(n.admin1||(n.admin1=t.long_name)),r==="administrative_area_level_2"&&(n.admin2||(n.admin2=t.long_name)),r==="administrative_area_level_3"&&(n.admin3||(n.admin3=t.long_name)),r==="postal_code"&&(n.postalCode||(n.postalCode=t.long_name)),r==="country"&&(n.country||(n.country=t.long_name))}),t.lat=e.geometry.location.lat(),t.lng=e.geometry.location.lng(),t.formatted_address=e.formatted_address,t.streetNumber=n.streetNumber,t.streetName=n.streetAddress?n.streetAddress:n.route,t.city=n.locality,t.suburb=function(){var e="";return n.neighborhood?e=n.neighborhood:n.subLocality1?e=n.subLocality1:n.subLocality2?e="":e=n.subLocality2,e===t.city?e="":e===""&&n.admin3&&(e=n.admin3),e}(),t.area=function(){var e="";return n.subLocality2?e=n.subLocality2:n.subLocality1?t.suburb===n.subLocality1?e="":e=n.subLocality1:t.suburb===n.neighborhood?e="":e=n.neighborhood,e===""&&(n.admin2?e=n.admin2:e=t.suburb),e}(),t.region=n.admin1,t.postalCode=n.postalCode,t.country=n.country,t},f=function(e){n.returnAddress.streetNumber(e.streetNumber),n.returnAddress.streetName(e.streetName),n.returnAddress.geoLat(e.lat),n.returnAddress.geoLng(e.lng),n.returnAddress.area(e.area),n.returnAddress.city(e.city),n.returnAddress.country(e.country),n.returnAddress.postalCode(e.postalCode),n.returnAddress.region(e.streetName),n.returnAddress.suburb(e.suburb),n.returnAddress.formattedAddress(e.formatted_address),$("#gmapsFormattedAddress").html("formatted address: "+e.formatted_address),$("#btnGmapCancel").hide(),$("#btnGmapDone").fadeIn()},l=function(e,t){gdd.utils.loadGoogleMapsApi(function(){gdd.hideLoader();var n=new google.maps.LatLng(e,t),i=null,s=null,l=null,c={zoom:10,center:n,mapTypeId:google.maps.MapTypeId.ROADMAP};i=new google.maps.Map(document.getElementById("gmapsCanvas"),c),s=new google.maps.Geocoder,l=new google.maps.Marker({position:n,map:i,draggable:!0,animation:google.maps.Animation.DROP,icon:r}),google.maps.event.addListener(l,"dragend",function(){u("latLng",l.getPosition(),s,function(e){var t=a(e);f(t)},function(e){gdd.showErr(e)})}),google.maps.event.addListener(i,"click",function(e){l.setPosition(e.latLng),u("latLng",e.latLng,s,function(e){var t=a(e);f(t)},function(e){gdd.showErr(e)})}),o("gmapsTxtAddress",s,i,l,function(e){f(e)})},function(e){gdd.hideLoader(),gdd.showErr(e)})},c=function(){gdd.showLoader("Google Api..."),gdd.utils.loadGoogleMapsApi(function(){gdd.hideLoader(),s(function(e){var t=null,n=null;e?(n=e.lng,t=e.lat):(n="18.423",t="-33.58");var i=new google.maps.LatLng(t,n),s=null,l=null,c=null,h={zoom:10,center:i,mapTypeId:google.maps.MapTypeId.ROADMAP};s=new google.maps.Map(document.getElementById("gmapsCanvas"),h),l=new google.maps.Geocoder,c=new google.maps.Marker({position:i,map:s,draggable:!0,animation:google.maps.Animation.DROP,icon:r}),google.maps.event.addListener(c,"dragend",function(){u("latLng",c.getPosition(),l,function(e){var t=a(e);f(t)},function(e){gdd.showErr(e)})}),google.maps.event.addListener(s,"click",function(e){c.setPosition(e.latLng),u("latLng",e.latLng,l,function(e){var t=a(e);f(t)},function(e){gdd.showErr(e)})}),o("gmapsTxtAddress",l,s,c,function(e){f(e)})})},function(e){gdd.hideLoader(),gdd.showErr(e)})},h=function(){n.pins.length>0?gdd.utils.loadGoogleMapsApi(function(){var e=new google.maps.LatLng(n.pins[0].lat,n.pins[0].lng),t={zoom:10,center:e},s=new google.maps.Map(document.getElementById("gmapsCanvas"),t),o=new google.maps.InfoWindow;$.each(n.pins,function(e,t){var n=r;t.pinColor&&(t.pinColor=="green"?n=i:n=r);var u;u=new google.maps.Marker({position:new google.maps.LatLng(t.lat,t.lng),animation:google.maps.Animation.DROP,map:s,icon:n,draggable:!1}),google.maps.event.addListener(u,"click",function(e,n){return function(){o.setContent(t.content),o.open(s,u)}}(u,e))}),s.setCenter(new google.maps.LatLng(n.pins[0].lat,n.pins[0].lng))},function(e){gdd.showErr(e)}):gdd.showMsg("There are no valid co-ordinates to load.")},p=function(){var e=$(window).height();$("#gmapsCanvas").css("height",e),n.target=="3"?($("#txtGMapsAutoComplete").hide(),h(),$(".gmapsForView").show(),$(".gmapsForEdit").hide()):(n.returnAddress.streetNumber(""),n.returnAddress.streetName(""),n.returnAddress.geoLat(""),n.returnAddress.geoLng(""),n.returnAddress.area(""),n.returnAddress.city(""),n.returnAddress.country(""),n.returnAddress.postalCode(""),n.returnAddress.region(""),n.returnAddress.suburb(""),n.returnAddress.formattedAddress(""),$("#btnGmapCancel").show(),$("#btnGmapDone").hide(),$(".gmapsForView").hide(),$(".gmapsForEdit").show(),$("#txtGMapsAutoComplete").show(),$("#gmapsStartMessage").html(n.helpTxt),$("#popupGmapsStartMessage").popup("open",{transition:"pop"}),n.lat?l(n.lat,n.lng):c())},d=function(){$("#btnGmapDone").on(gdd.tap(),function(){n.callbackFunction(e.mapping.toJS(n.returnAddress)),gdd.utils.loadPage(n.callbackPage,!0,"slideup")}),$("#btnGmapCancel").on(gdd.tap(),function(){n.returnAddress.streetNumber(""),n.returnAddress.streetName(""),n.returnAddress.geoLat(""),n.returnAddress.geoLng(""),n.returnAddress.area(""),n.returnAddress.city(""),n.returnAddress.country(""),n.returnAddress.postalCode(""),n.returnAddress.region(""),n.returnAddress.suburb(""),n.returnAddress.formattedAddress(""),n.callbackFunction(e.mapping.toJS(n.returnAddress)),gdd.utils.loadPage(n.callbackPage,!0,"slideup")}),$(".btnGMapRefresh").on(gdd.tap(),function(){p()})};return{callbackFunction:null,callbackPage:null,lat:null,lng:null,pins:new Array,helpTxt:"",target:null,returnAddress:{streetNumber:e.observable(""),streetName:e.observable(""),geoLat:e.observable(""),geoLng:e.observable(""),area:e.observable(""),city:e.observable(""),country:e.observable(""),postalCode:e.observable(""),region:e.observable(""),suburb:e.observable(""),formattedAddress:e.observable("")},configForTest:function(e,t,n,r){gdd.pages.gmap.view.target=null,gdd.pages.gmap.view.callbackFunction=e,gdd.pages.gmap.view.callbackPage=t,gdd.pages.gmap.view.lat=n,gdd.pages.gmap.view.lng=r},configurePageForAddressEdit:function(e,t,n,r,i){gdd.pages.gmap.view.callbackFunction=e,gdd.pages.gmap.view.callbackPage=t,gdd.pages.gmap.view.lat=n,gdd.pages.gmap.view.lng=r;switch(i){case 1:gdd.pages.gmap.view.helpTxt="To choose a meeting location for your group either:<ul><li>Click on the map to drop a new pin or drag an existing pin</li><li>Start typing the address in the text box provided and choose from the list of Google matched addresses</li></ul>";break;case 2:gdd.pages.gmap.view.helpTxt="To add a new address either:<ul><li>Click on the map to drop a new pin or drag an existing pin</li><li>Start typing the address in the text box provided and choose from the list of Google matched addresses</li></ul>";break;default:gdd.pages.gmap.view.helpTxt="Click on the map to select the address location, or type the address in the textbox provided."}},configureForDropPins:function(e){gdd.pages.gmap.view.target=3,gdd.pages.gmap.view.pins=e},create:function(){n=this,gdd.utils.configMergeFromJs(e),d(),e.applyBindings(gdd,document.getElementById(gdd.utils.activePage.id))},show:function(){p()},beforeShow:function(){},beforeHide:function(){gdd.pages.gmap.view.pins.length=0},endOldSession:function(){gdd.pages.gmap.view.pins.length=0}}}),define("views/requestpermission",["knockout","knockoutMapping"],function(e,t){e.mapping=t;var n=null,r=function(){$("#btnRequestPermission").on(gdd.tap(),function(){gdd.showLoader("Working..."),gdd.api.callApi("Security/RequestPermission","GET",{info:n.msg()},{success:function(e){gdd.hideLoader(),gdd.showMsg(e.gddData,function(){gdd.loadPage(gdd.utils.previousPage,!0,"slide")})},fail:function(e){gdd.hideLoader(),gdd.showErr(e.msg)}})})};return{msg:e.observable(),create:function(){n=gdd.utils.activePage.view,gdd.utils.configMergeFromJs(e),r(),e.applyBindings(gdd,document.getElementById(gdd.utils.activePage.id))},show:function(){},beforeShow:function(){},beforeHide:function(){},endOldSession:function(){}}}),define("views/events",["knockout","knockoutMapping"],function(e,t){e.mapping=t;var n=null,r=!0,i={all:".eventView",list:".eventListView",noEvents:".noEventsView",register:".eventRegisterView",attendance:".eventAttendanceView",qrCode:".eventQrCodeView"},s=function(e,t,i){var o=function(e){p.length>0&&(p[0].attended=t),i&&i(e)},u=function(e){$("#ticketError").html(e),gdd.showPopup("evPopupTicketError"),p.length>0&&(p[0].attended=!t,r=!1,$(".btnAttRegListFlipSwitch[data-id='"+p[0].personId+"']").prop("checked",!t),$(".btnAttRegListFlipSwitch").flipswitch("refresh"),r=!0),$("#btnTicketOverride").one(gdd.tap(),function(){r=!1,$(".btnAttRegListFlipSwitch[data-id='"+p[0].personId+"']").prop("checked",t),$(".btnAttRegListFlipSwitch").flipswitch("refresh"),r=!0,$("#evPopupTicketError").one("popupafterclose",function(e,n){s(!0,t)}),$("#evPopupTicketError").popup("close")})},a=function(e){gdd.hideLoader(),gdd.showErr(m.msg)},f=$("#evAttEnableLocalCache").val(),l;f=="1"?l=!0:l=!1;var c=n.selectedAttendee.guid(),h=n.selectedEvent.eventId(),p=$.grep(n.selectedEvent.attendees(),function(e,t){return e.guid==c}),d=gdd.storage.getEventRegCache(),v=$.grep(d,function(e,t){return e.guid==c});v.length===0&&(l=!0);if(l){var m={};m.eventId=n.selectedEvent.eventId(),m.guid=c,m.override=e,m.attended=t,gdd.showLoader("Processing..."),gdd.api.callApi("Events/ToggleEventAttendance","POST",m,{success:function(e){gdd.hideLoader();var n=e.gddData,r=n.split("|")[0],i=n.split("|")[1];r=="0"?u(i):(v[0].attended=t,v[0].isDirty=!1,gdd.storage.saveEventRegCache(d),o(i))},fail:function(e){a(e.msg)}})}else v[0].pmtRequired&&t&&!v[0].paid?e?(v[0].attended=t,v[0].isDirty=!0,o(v[0].firstName+" has been marked as present. NOTE: Payment has not been made.")):u("This person has not paid for the event."):(v[0].attended=t,v[0].isDirty=!0,t?o(v[0].firstName+" has been marked as present."):o(v[0].firstName+" has been marked as absent.")),gdd.storage.saveEventRegCache(d)},o=function(e){if(gdd.utils.isNative())try{$(e).attr("href","#").removeAttr("target"),$(e).one(gdd.click(),function(){try{var e=window.open(n.selectedEvent.googleFormUrl(),"_system","location=yes,closebuttoncaption=Done/Close");$("#popupEventActionsMenu").popup("close")}catch(t){alert("We could no load the Google form: "+t)}})}catch(t){alert("We could no load the Google form: "+t)}else $(e).attr("href",n.selectedEvent.googleFormUrl()).attr("target","_blank"),$(e).one(gdd.click(),function(){$("#popupEventActionsMenu").popup("close")})},u=function(e,t,n){gdd.utils.slideTransitionView($(i.all),$(e),t,function(){switch(e){case i.list:$("#eventsHeader").html("Events");var t=gdd.storage.getEventRegCache(),r=0;if(t){var s=$.grep(t,function(e,t){return e.isDirty===!0});r=s.length}r>0?($("#btnSaveUnSyncedEvRegInfo").html("Sync("+r+")"),$("#btnUnsyncedEvRegInfo").fadeIn()):$("#btnUnsyncedEvRegInfo").hide();break;case i.noEvents:$("#eventsHeader").html("Events");break;case i.register:$("#eventsHeader").html("Register");break;case i.attendance:$("#eventsHeader").html("Attendance")}n&&n()})},a=function(t){var r={};r.personId=gdd.session.personId(),r.eventId=n.selectedEvent.eventId(),r.paid=n.selectedEvent.paid(),r.regTypeId=n.selectedEvent.regTypeId(),r.isComing=t,r.emailGoogleForm=!0,t=="1"?gdd.showLoader("Registering..."):gdd.showLoader("Un-Registering..."),gdd.api.callApi("Events/ToggleReg","POST",r,{success:function(t){gdd.hideLoader();var r=t.gddData[0],i=$.grep(n.events(),function(e,t){return r.eventId==e.eventId}),s=0;i.length>0&&(s=n.events.indexOf(i[0]),n.events.splice(s,1)),e.mapping.mergeFromJS(n.selectedEvent,r),n.events.splice(s,0,r),p(),r.coming?($("#eventRegThankYouText").html($("#eventRegThankYouText").html().replace("##regcode##",r.regCode)),$("#viewRegWithMultipleRegTypes").hide(),$("#viewRegComplete").fadeIn(),r.googleFormStillRequired?($("#btnEventRegGoogleForm").show(),o($("#btnEventRegGoogleForm"))):$("#btnEventRegGoogleForm").hide(),r.pmtRequired=="1"?$(".btnEventPayNow").show():$(".btnEventPayNow").hide()):gdd.showMsg("We have recorded you as NOT attending the event.")},fail:function(e){gdd.hideLoader(),gdd.showErr(e.msg)}})},f=function(){$("#evAttList").listview("refresh"),$(".btnAttRegListFlipSwitch").flipswitch(),$(".btnAttRegListFlipSwitch").flipswitch("refresh"),$(".btnAttRegListFlipSwitch").off().on("change",function(t){if(r){var i=$(this).attr("data-id"),o=$.grep(n.selectedEvent.attendees(),function(e,t){return e.personId==i});e.mapping.mergeFromJS(n.selectedAttendee,e.mapping.toJS(o[0]));var u;$(this).is(":checked")?u=!0:u=!1,s(!1,u)}})},l=function(){var e=function(e,t){return e.firstName<t.firstName?-1:e.firstName>t.firstName?1:0},t=gdd.storage.getEventRegCache();n.selectedEvent.attendees.removeAll();var r=new Array;t&&$.each(t,function(e,t){t.eventId==n.selectedEvent.eventId()&&r.push(t)}),r.sort(e),$.each(r,function(e,t){n.selectedEvent.attendees.push(t)}),n.selectedEvent.attendees().length>0?f():(gdd.showLoader("Loading attendees..."),gdd.api.callApi("Events/GetRegistrantInfo","GET",{eventId:n.selectedEvent.eventId(),filter:1},{success:function(r){gdd.hideLoader();var i=r.gddData;if(t){var s=$.grep(t,function(e,t){return e.eventId==n.selectedEvent.eventId()});$.each(s,function(e,n){t.splice(t.indexOf(n),1)}),$.each(i,function(e,n){t.push(n)}),t.sort(e),gdd.storage.saveEventRegCache(t)}else gdd.storage.saveEventRegCache(i);$.each(i,function(e,t){n.selectedEvent.attendees.push(t)}),f()},fail:function(e){gdd.hideLoader(),gdd.showErr(e.msg)}}))},c=function(e,t){var n=gdd.storage.getEventRegCache();if(n)if(n.length>0){var r=function(){var t=$.grep(n,function(e,t){return e.isDirty?!0:!1});t.length===0&&(gdd.storage.saveEventRegCache(),n,e())};$.each(n,function(e,n){if(n.isDirty){var i={};i.eventId=n.eventId,i.guid=n.guid,i.override=!0,i.attended=n.attended,gdd.api.callApi("Events/ToggleEventAttendance","POST",i,{success:function(e){n.isDirty=!1,r()},fail:function(e){t(e.msg)}})}})}else e();else e()},h=function(t){var i=$.grep(n.selectedEvent.attendees(),function(e,n){return e.guid==t});i.length>0?(e.mapping.mergeFromJS(n.selectedAttendee,e.mapping.toJS(i[0])),r=!1,$(".btnAttRegListFlipSwitch[data-id='"+i[0].personId+"']").prop("checked",!0),$(".btnAttRegListFlipSwitch").flipswitch("refresh"),r=!0,s(!1,!0,function(e){gdd.app.showGlbMsg("Success!",e)})):gdd.showWarning("This is not a valid ticket for this event. Please check the person is using the correct QRCode.")},p=function(){var t=function(t){var r=$.grep(n.events(),function(e,n){return e.eventId==t});n.selectedEvent.eventId()&&n.selectedEvent.eventId()!=r[0].eventId&&(n.selectedEventQrCode=null,n.selectedEvent.attendees.removeAll()),e.mapping.mergeFromJS(n.selectedEvent,r[0])};$(".evMore").off().on(gdd.click(),function(e){var n=$(this).attr("data-id");t(n),gdd.showPopup("popupEventActionsMenu")}),$(".evNotComing").off().on(gdd.tap(),function(e){var r=$(this).attr("data-id");t(r),n.selectedEvent.allowRegistration()?a(0):gdd.showMsg(n.selectedEvent.registrationMessage())}),$(".evComing").off().on(gdd.tap(),function(e){var r=$(this).attr("data-id");t(r),n.selectedEvent.allowRegistration()?($("#viewRegComplete").hide(),$("#viewRegWithMultipleRegTypes").hide(),n.selectedEvent.regTypesList().length>1?$("#viewRegWithMultipleRegTypes").show():n.selectedEvent.regTypeId(n.selectedEvent.regTypesList()[0].id),u(i.register,"left",function(){n.selectedEvent.regTypesList().length===1&&a(1),$(".btnEventViewBack").off().one(gdd.tap(),function(){u(i.list,"right")})})):gdd.showMsg(n.selectedEvent.registrationMessage())})},d=function(){n.events().length>0?(p(),u(i.list,"left")):(gdd.showLoader("Loading events..."),gdd.api.callApi("Events/GetMyEventProfiles","GET",null,{success:function(e){gdd.hideLoader(),e.gddData.length===0?u(i.noEvents,"up"):($.each(e.gddData,function(e,t){n.events.push(t)}),p(),u(i.list,"left"))},fail:function(e){gdd.hideLoader(),gdd.showErr(e.msg)}}))},v=function(){$("#btnEventEmailTicket").on(gdd.click(),function(){$("#popupEventActionsMenu").one("popupafterclose",function(e,t){gdd.showLoader("Sending email..."),gdd.api.callApi("Events/EmailPersonsEventTicket","GET",{personId:gdd.session.personId(),eventId:n.selectedEvent.eventId()},{success:function(e){gdd.hideLoader(),gdd.showMsg(e.gddData)},fail:function(e){gdd.hideLoader(),gdd.showErr(e.msg)}})}),$("#popupEventActionsMenu").popup("close")}),$("#btnEventVolunteer").on(gdd.tap(),function(){$("#popupEventActionsMenu").one("popupafterclose",function(e,t){var r={};r.personId=gdd.session.personId(),r.eventId=n.selectedEvent.eventId(),n.selectedEvent.isVolunteer()?r.volunteer=!1:r.volunteer=!0,gdd.showLoader("Processing..."),gdd.api.callApi("Events/Volunteer","POST",r,{success:function(e){gdd.hideLoader();var t=$.grep(n.events(),function(e,t){return e.eventId==n.selectedEvent.eventId()});if(t.length>0){var i=n.events.indexOf(t[0]);r.volunteer?(n.selectedEvent.isVolunteer(!0),t[0].isVolunteer=!0):(n.selectedEvent.isVolunteer(!1),t[0].isVolunteer=!1),n.events.splice(i,1,t[0]),p()}},fail:function(e){gdd.hideLoader(),gdd.showErr(e.msg)}})}),$("#popupEventActionsMenu").popup("close")}),$("#btnEventViewTicket").on(gdd.tap(),function(){var e=function(){$("#evNameDigiTicket").html(n.selectedEvent.eventName()),$("#evListImgQrCode").attr("src",n.selectedEventQrCode),u(i.qrCode,"up",function(){$(".btnEventViewBack").on(gdd.tap(),function(){u(i.list,"down",function(){})})})};$("#popupEventActionsMenu").one("popupafterclose",function(t,r){n.selectedEventQrCode?e():(gdd.showLoader("Fetching ticket..."),gdd.api.callApi("Events/GetPersonsEventQRCode","GET",{personId:gdd.session.personId(),eventId:n.selectedEvent.eventId()},{success:function(t){gdd.hideLoader(),n.selectedEventQrCode=t.gddData,e()},fail:function(e){gdd.hideLoader(),gdd.showErr(e.msg)}}))}),$("#popupEventActionsMenu").popup("close")}),$("#btnEventVewGoogleResponses").on(gdd.click(),function(){$("#popupEventActionsMenu").one("popupafterclose",function(e,t){if(n.selectedEvent.googleFormSubmission().length>0){var r="<table>";$.each(n.selectedEvent.googleFormSubmission(),function(e,t){t.field.indexOf("Timestamp")===-1&&t.field.indexOf("RegCode")===-1&&(r+="<tr><td><div><strong>"+t.field+"</strong></div><div>"+t.value+"</td><div></tr>")}),r+="</table>",$("#evListGoogleRes").html(r),gdd.showPopup("evListGoogleFormResponsesPopup")}else gdd.showMsg("<p>We have no record at this stage of you having completed the online form.</p><p>It is likely that we are still processing the data collected by the online form.</p> ")}),$("#popupEventActionsMenu").popup("close")}),$("#btnEventViewMap").on(gdd.tap(),function(){$("#popupEventActionsMenu").one("popupafterclose",function(e,t){var r=n.selectedEvent.geoLat(),i=n.selectedEvent.geoLng();if(r&&i){var s=new Array;s.push({lat:r,lng:i,pinColor:"red",content:n.selectedEvent.eventName()}),gdd.pages.gmap.view.configureForDropPins(s),gdd.loadPage(gdd.pages.gmap,!1,"slideup")}else gdd.showMsg("No mapping data has been configured for this event.")}),$("#popupEventActionsMenu").popup("close")}),$("#btnDelUnsyncedEvRegInfo").on(gdd.tap(),function(){gdd.showPopup("popupDeleteDirtyEvRegItems"),$("#btnYesDeleteDirtyEvRegItems").one(gdd.click(),function(){gdd.storage.saveEventRegCache(null),$("#btnUnsyncedEvRegInfo").hide(),$("#popupDeleteDirtyEvRegItems").popup("close")})}),$("#btnSaveUnSyncedEvRegInfo").on(gdd.tap(),function(){gdd.showLoader("Syncing..."),c(function(){gdd.hideLoader(),$("#btnUnsyncedEvRegInfo").fadeOut()},function(e){gdd.hideLoader(),gdd.showErr(e)})}),$("#btnEvScanSaveLater").on(gdd.tap(),function(){$("#popupEvLocalScanSave").one("popupafterclose",function(e,t){u(i.list,"left")}),$("#popupEvLocalScanSave").popup("close")}),$("#btnEvScanSaveNow").on(gdd.tap(),function(){$("#popupEvLocalScanSave").one("popupafterclose",function(e,t){gdd.showLoader("Syncing..."),c(function(){gdd.hideLoader(),u(i.list,"left")},function(e){gdd.hideLoader(),gdd.showErr(e)})}),$("#popupEvLocalScanSave").popup("close")}),$("#btnEvScanStart").on(gdd.tap(),function(){if(gdd.utils.isNative())try{cordova.plugins.barcodeScanner.scan(function(e){e.cancelled=="0"&&h(e.text)},function(e){gdd.showErr("Scanning failed: "+e)})}catch(e){gdd.showErr("Cordova Error: "+e)}else gdd.showMsg("The barcode scanner is not available on the web app. Please install our app for your phone.")}),$("#evAttEnableLocalCache").on("change",function(){var e=$(this).val();e=="1"?gdd.showMsg("Live scanning is now enabled. All attendance data will be synced to the database in real time."):gdd.showMsg("Local cache scanning is now enabled. Attendance data will be stored in a local cache which you will need to sync at a later stage. ")}),$("#btnEvViewAttDone").on(gdd.tap(),function(){var e=gdd.storage.getEventRegCache(),t=0;if(e){var n=$.grep(e,function(e,t){return e.isDirty===!0});t=n.length}t>0?gdd.showPopup("popupEvLocalScanSave"):u(i.list,"left")}),$("#btnEvViewAttList").on(gdd.tap(),function(){$.when($(".evAttSubView").not(".evAttListView").hide("slide",{direction:"up"})).then(function(){$(".evAttListView").show("slide",{direction:"down"})})}),$("#btnEvViewAttScan").on(gdd.tap(),function(){$.when($(".evAttSubView").not(".evAttScanView").hide("slide",{direction:"down"})).then(function(){$(".evAttScanView").show("slide",{direction:"up"})})}),$("#btnEventManageAttendance").on(gdd.tap(),function(){$("#popupEventActionsMenu").one("popupafterclose",function(e,t){var r=n.selectedEvent.isAttendanceManager();r?u(i.attendance,"left",function(){l(),$(".btnEventViewBack").one(gdd.tap(),function(){u(i.list,"right")})}):gdd.utils.requestPermission("Request permission to manage attendance at the event '"+n.selectedEvent.eventName()+"'")}),$("#popupEventActionsMenu").popup("close")}),$(".btnReloadEvents").on(gdd.tap(),function(){n.events.removeAll(),d()}),$(".btnEventPayNow").on(gdd.tap(),function(){$(this).is("a")?($("#popupEventActionsMenu").one("popupafterclose",function(e,t){gdd.showPopup("popupEventChoosePayment")}),$("#popupEventActionsMenu").popup("close")):gdd.showPopup("popupEventChoosePayment")}),$("#btnPayWithCC").on(gdd.tap(),function(){$("#popupEventChoosePayment").one("popupafterclose",function(e,t){gdd.showLoader("Securing gateway..."),gdd.api.callApi("Payments/GatewayIsActive","GET",{portalId:gdd.portalId},{success:function(e){gdd.hideLoader();var t=e.gddData;t.mode===0?gdd.showMsg(t.desc):(gdd.pages.payment.view.auth.cardHolder(""),gdd.pages.payment.view.auth.cardNumber(""),gdd.pages.payment.view.auth.expMonth("01"),gdd.pages.payment.view.auth.expYear("2015"),gdd.pages.payment.view.auth.cvc(""),gdd.pages.payment.view.auth.amount(n.selectedEvent.cost()),gdd.pages.payment.view.auth.ccy(n.selectedEvent.ccy()),gdd.pages.payment.view.auth.entity("Event"),gdd.pages.payment.view.auth.entityId(n.selectedEvent.eventId()),gdd.pages.payment.view.auth.description("Pay for event '"+n.selectedEvent.eventName()),t.mode===1?gdd.pages.payment.view.auth.simulateOption("2"):gdd.pages.payment.view.auth.simulateOption("0"),gdd.loadPage(gdd.pages.payment))},fail:function(e){gdd.hideLoader(),gdd.showErr(e.msg)}})}),$("#popupEventChoosePayment").popup("close")}),$("#btnPayNoCC").on(gdd.tap(),function(){$("#popupEventChoosePayment").one("popupafterclose",function(e,t){$("#evListPmtInst").html(n.selectedEvent.pmtInstructions()),gdd.showPopup("evListPmtInstructions")}),$("#popupEventChoosePayment").popup("close")}),$("#btnRegWithMoreThanOneRegType").on(gdd.click(),function(){n.selectedEvent.regTypeId($("#ddlRegType").val()),a(1)}),$("#popupEventActionsMenu").on("popupbeforeposition",function(e,t){n.selectedEvent.googleFormUrl()&&o($("#btnEventFillOutGoogleForm")),n.selectedEvent.coming()=="1"?(n.selectedEvent.googleFormSubmission().length>0?$("#btnEventVewGoogleResponses").show():$("#btnEventVewGoogleResponses").hide(),n.selectedEvent.googleFormStillRequired()?$("#btnEventFillOutGoogleForm").show():$("#btnEventFillOutGoogleForm").hide(),n.selectedEvent.pmtRequired()=="1"?n.selectedEvent.paid()?$(".btnEventPayNow").hide():$(".btnEventPayNow").show():$(".btnEventPayNow").hide(),$("#btnEventViewTicket").show(),$("#btnEventEmailTicket").show(),n.selectedEvent.isVolunteer()?$("#btnEventVolunteer").html("I cannot volunteer"):$("#btnEventVolunteer").html("Volunteer at this event"),$("#btnEventVolunteer").show()):($("#btnEventVolunteer").hide(),$("#btnEventVewGoogleResponses").hide(),$("#btnEventFillOutGoogleForm").hide(),$(".btnEventPayNow").hide(),$("#btnEventViewTicket").hide(),$("#btnEventEmailTicket").hide(),$("#btnEventManageAttendance").hide())})};return{scanType:1,selectedEventQrCode:null,selectedEvent:{eventId:e.observable(""),eventName:e.observable(""),description:e.observable(""),imageUrl:e.observable(""),startDate:e.observable(""),endDate:e.observable(""),startTime:e.observable(""),endTime:e.observable(""),tagLine:e.observable(""),capacity:e.observable(""),isActive:e.observable(!0),minSecLevel:e.observable(""),featured:e.observable(!1),regStartDate:e.observable(""),regEndDate:e.observable(""),allowRegistration:e.observable(!1),registrationMessage:e.observable(""),allowMultipleReg:e.observable(!1),regLabel:e.observable(""),eventWebAddress:e.observable(""),eventVenue:e.observable(""),geoLat:e.observable(""),geoLng:e.observable(""),attendanceRegIsPublic:e.observable(!1),ownerPortalId:e.observable(""),ownerPortalName:e.observable(""),pmtInstructions:e.observable(""),helpText:e.observable(""),regId:e.observable(""),regTypeId:e.observable(""),changedOn:e.observable(""),changedBy:e.observable(""),attended:e.observable(!1),personId:e.observable(""),paid:e.observable(!1),coming:e.observable(-1),googleFormSubmission:e.observableArray(),regCode:e.observable(""),regType:e.observable(""),pmtRequired:e.observable(-1),cost:e.observable(""),ccy:e.observable(""),summary:e.observable(""),googleFormStillRequired:e.observable(!0),googleFormUrl:e.observable(""),googleFormIsActive:e.observable(!0),googleFormSubmitted:e.observable(!0),regTypesList:e.observableArray(),isAttendanceManager:e.observable(!1),isVolunteer:e.observable(!1),attendees:e.observableArray()},events:e.observableArray(),create:function(){n=gdd.utils.activePage.view,gdd.utils.configMergeFromJs(e),e.applyBindings(gdd,document.getElementById(gdd.utils.activePage.id)),v()},show:function(){d()},beforeShow:function(){},beforeHide:function(){},endOldSession:function(){gdd.pages.events.view.events.removeAll()},selectedAttendee:{personId:e.observable(""),firstName:e.observable(""),lastName:e.observable(""),email:e.observable(""),mobileNumber:e.observable(""),regId:e.observable(""),eventId:e.observable(""),userChanged:e.observable(""),dateChanged:e.observable(""),attended:e.observable(!1),paid:e.observable(!1),regTypeId:e.observable(""),regType:e.observable(""),regTypeId:e.observable(""),pmtRequired:e.observable(!1),cost:e.observable(""),ccy:e.observable(""),registered:e.observable(!1),isComing:e.observable(-1),regCode:e.observable(""),moreInfo:e.observableArray(),googleResponseRowNumber:e.observable(""),googleFormCompleted:e.observable(""),googleFormUrl:e.observable(""),isAttendanceManager:e.observable(!1),isVolunteer:e.observable(!1),guid:e.observable("")}}}),define("views/payment",["knockout","knockoutMapping"],function(e,t){e.mapping=t;var n=null,r=function(){switch(n.auth.simulateOption()){case"1":n.auth.cardHolder("VISA: Pin Verify"),n.auth.cardNumber("4000000000000002"),n.auth.cvc("000");break;case"3":n.auth.cardHolder("VISA: Fail - No Funds"),n.auth.cardNumber("4000000000000028"),n.auth.cvc("000");break;default:n.auth.cardHolder("AMX Success"),n.auth.cardNumber("378282246310005"),n.auth.cvc("000")}},i=function(){$("#ccSimulate").hide(),$(".btnPayNowCancel").on(gdd.tap(),function(){gdd.loadPage(gdd.utils.previousPage,!0,"slide")}),$(".ccSimulate").on("change",function(){var e=$(this).val();n.auth.simulateOption(e),r()}),$("#PopupCC3DReq").on("popupbeforeposition",function(e,t){var r=$("#btn3DSecGo");gdd.utils.isNative()?($(r).attr("href","#").removeAttr("target"),$(r).one(gdd.click(),function(){var e=window.open(n.authResult.authReqUrl,"_system","location=yes,closebuttoncaption=Done/Close");$("#PopupCC3DReq").one("popupafterclose",function(e,t){gdd.pages.events.view.events.removeAll(),gdd.loadPage(gdd.utils.previousPage,!0,"slide")}),$("#PopupCC3DReq").popup("close")})):($(r).attr("href",n.authResult.authReqUrl).attr("target","_blank"),$(r).one(gdd.click(),function(){$("#PopupCC3DReq").one("popupafterclose",function(e,t){gdd.pages.events.view.events.removeAll(),gdd.loadPage(gdd.utils.previousPage,!0,"slide")}),$("#PopupCC3DReq").popup("close")}))}),$("#ccPaymentSuccess").on("popupafterclose",function(e,t){gdd.pages.events.view.events.removeAll(),gdd.loadPage(gdd.utils.previousPage,!0,"slide")}),$("#btnCcPayNow").on(gdd.tap(),function(){var t=e.mapping.toJS(n.auth),r=!0;t.cardHolder&&t.cardNumber&&t.cvc?(gdd.showLoader("Processing..."),gdd.api.callApi("Payments/Authorize","POST",t,{success:function(e){gdd.hideLoader();var t=e.gddData;n.authResult=t;switch(t.code){case 0:gdd.showErr("<p>While trying to process the card the following error occurred.</p><p>"+t.message+"<p/>");break;case 1:gdd.showPopup("PopupCC3DReq");break;case 2:$("#ccAuthError").html(t.message),gdd.showPopup("popupCCFailed");break;case 3:gdd.showPopup("ccPaymentSuccess");break;default:gdd.showErr("An unknown response code was returned from the server. Please contact support.")}},fail:function(e){gdd.hideLoader(),gdd.showErr(e.msg)}})):gdd.showMsg("You have not entered all the fields, or some are not valid.")})};return{authResult:null,auth:{cardHolder:e.observable(""),cardNumber:e.observable(""),expMonth:e.observable(""),expYear:e.observable(""),cvc:e.observable(""),amount:e.observable(""),ccy:e.observable(""),entity:e.observable(""),entityId:e.observable(""),simulateOption:e.observable(""),description:e.observable("")},create:function(){n=gdd.utils.activePage.view,gdd.utils.configMergeFromJs(e),i(),e.applyBindings(gdd,document.getElementById(gdd.utils.activePage.id))},show:function(){if(n.auth.entity()&&n.auth.entityId()&&n.auth.amount()&&n.auth.ccy()){$("#btnCcPayNow").html("Pay Now ("+n.auth.ccy()+n.auth.amount()+")");if(n.auth.simulateOption()!="0"){var e=n.auth.simulateOption();$("#ccSimulate").show(),$("#ccPmtOnlineNotice").hide(),$("#ccPmtSimulateNotice").show(),$("[type='radio'][value='"+e+"']").prop("checked",!0),$(".ccSimulate").checkboxradio("refresh"),r(),gdd.showPopup("popupCCSimulation")}else $("#ccSimulate").hide(),$("#ccPmtOnlineNotice").show(),$("#ccPmtSimulateNotice").hide()}else gdd.showMsg("This page has not been configured for the payment gateway. Please contact your church office.",function(){gdd.loadPage(gdd.utils.previousPage,!0,"slide")})},beforeShow:function(){},beforeHide:function(){},endOldSession:function(){}}}),define("views/sermons",["knockout","knockoutMapping"],function(e,t){e.mapping=t;var n=null,r={all:".sermonView",feeds:".feedsView",noFeeds:".noFeedsView",items:".itemsView"},i=function(e,t,n){gdd.utils.slideTransitionView($(r.all),$(e),t,function(){switch(e){case r.addNew:$("#peopleHeader").html("Add New")}n&&n()})},s=function(){i(r.items,"left",function(){a(),$(".btnSermonViewBack").one(gdd.tap(),function(){i(r.feeds,"right")})})},o=function(){if(gdd.utils.isNative()){var e=n.selectedSermon.linkUrl(),t={bgColor:"#FFFFFF",bgImage:"/img/audiobackground.jpg",bgImageScale:"fit",successCallback:function(){},errorCallback:function(e){gdd.showMsg("The version of OS you are running on your phone is to old to run this media player: "+e)}};window.plugins.streamingMedia.playAudio(e,t)}else gdd.showMsg("To listen to the sermon you must be running this app on your phone. To listen to it in the web version, use the 'Email Me Link' option.")},u=function(){$("#btnFeedItemFinished").on(gdd.click(),function(){$("#popupSermonItemMenu").one("popupafterclose",function(e,t){gdd.showLoader("Processing..."),gdd.api.callApi("Feeds/UpdatePersonReadStatus","GET",{personId:gdd.session.personId(),feedItemId:n.selectedSermon.id(),read:!0},{success:function(e){gdd.hideLoader();var t=$.grep(n.selectedFeed.items(),function(e,t){return e.id==n.selectedSermon.id()});n.selectedFeed.items.splice(n.selectedFeed.items.indexOf(t[0]),1),gdd.showMsg("This sermon has been marked as complete. If you refresh the channel, the next sermon available will be added to this list.")},fail:function(e){gdd.hideLoader(),gdd.showErr(e.msg)}})}),$("#popupSermonItemMenu").popup("close")}),$("#btnFeedItemEmail").on(gdd.click(),function(){$("#popupSermonItemMenu").one("popupafterclose",function(e,t){gdd.showLoader("Sending email..."),gdd.api.callApi("Feeds/EmailFeedItem","GET",{personId:gdd.session.personId(),feedItemId:n.selectedSermon.id()},{success:function(e){gdd.hideLoader(),gdd.showMsg("We have sent you an email with the download link for the sermon title you requested.")},fail:function(e){gdd.hideLoader(),gdd.showErr(e.msg)}})}),$("#popupSermonItemMenu").popup("close")}),$(".btnReloadSermons").on(gdd.tap(),function(){n.feeds.removeAll(),l()}),$("#btnSermonsView").on(gdd.click(),function(){$("#popupSermonMenu").one("popupafterclose",function(e,t){s()}),$("#popupSermonMenu").popup("close")}),$("#btnSermonsToggleSubs").on(gdd.click(),function(){$("#popupSermonMenu").one("popupafterclose",function(e,t){var r=null;n.selectedFeed.isSubscribed()?(gdd.showLoader("un-subscribing..."),r=!1):(r=!0,gdd.showLoader("subscribing...")),gdd.api.callApi("Feeds/UpdatePersonSubscription","GET",{personId:gdd.session.personId(),feedId:n.selectedFeed.id(),subscribe:r},{success:function(e){gdd.hideLoader();var t=$.grep(n.feeds(),function(e,t){return e.id==n.selectedFeed.id()}),i=n.feeds.indexOf(t[0]);n.feeds.splice(i,1),t[0].isSubscribed=r,n.feeds.splice(i,0,t[0]),f(),r?gdd.showMsg("You have been subscribed to this channel. Whenever this channel is updated you will receive an email with the latest sermons."):gdd.showMsg("You have been un-subscribed from this channel.")},fail:function(e){gdd.hideLoader(),gdd.showErr(e.msg)}})}),$("#popupSermonMenu").popup("close")}),$("#popupSermonMenu").on("popupbeforeposition",function(e,t){n.selectedFeed.isSubscribed()?$("#btnSermonsToggleSubs").html("UnSubscribe"):$("#btnSermonsToggleSubs").html("Subscribe")})},a=function(){$(".sermonMenu").off().on(gdd.click(),function(){var t=$(this).attr("data-id"),r=$.grep(n.selectedFeed.items(),function(e,n){return e.id==t});e.mapping.mergeFromJS(n.selectedSermon,r[0]),gdd.showPopup("popupSermonItemMenu",{positionTo:$(this)})}),$(".listenNow").off().on(gdd.tap(),function(){var t=$(this).attr("data-id"),r=$.grep(n.selectedFeed.items(),function(e,n){return e.id==t});e.mapping.mergeFromJS(n.selectedSermon,r[0]),o()})},f=function(){$("#feedsListView").listview("refresh");var t=function(t){var r=$.grep(n.feeds(),function(e,n){return e.id==t});e.mapping.mergeFromJS(n.selectedFeed,r[0])};$(".feedsItemMenu").off().on(gdd.click(),function(e){t($(this).attr("data-id")),gdd.showPopup("popupSermonMenu",{positionTo:$(this)})}),$(".viewSermons").off().on(gdd.click(),function(e){t($(this).attr("data-id")),n.selectedFeed.items().length===0?gdd.showMsg("There are no unread sermons in this channel."):s()})},l=function(){n.feeds().length>0?f():(gdd.showLoader("Loading..."),gdd.api.callApi("Feeds/GetPersonsUnreadPortalFeeds","GET","",{success:function(e){gdd.hideLoader();var t=e.gddData;t.length===0?i(r.noFeeds,"up"):(n.feeds.removeAll(),$.each(t,function(e,t){n.feeds.push(t)}),f())},fail:function(e){gdd.hideLoader(),gdd.showErr(e.msg)}}))};return{feeds:e.observableArray(),selectedFeed:{isSubscribed:e.observable(!1),description:e.observable(),id:e.observable(),imageUrl:e.observable(),lastUpdatedTime:e.observable(),title:e.observable(),feedUrl:e.observable(),linkUrl:e.observable(),linkTitle:e.observable(),isActive:e.observable(),feedContent:e.observable(),personId:e.observable(),subscriptionId:e.observable(),firstName:e.observable(),lastName:e.observable(),email:e.observable(),mobileNumber:e.observable(),isGlobalDefault:e.observable(),items:e.observableArray()},selectedSermon:{id:e.observable(),lastUpdatedTime:e.observable(),linkUrl:e.observable(),linkTitle:e.observable(),publishDate:e.observable(),summary:e.observable(),title:e.observable(),fileExt:e.observable(),feedId:e.observable(),imageUrl:e.observable()},create:function(){n=gdd.utils.activePage.view,gdd.utils.configMergeFromJs(e),u(),e.applyBindings(gdd,document.getElementById(gdd.utils.activePage.id))},show:function(){l()},beforeShow:function(){},beforeHide:function(){},endOldSession:function(){gdd.pages.sermons.view.feeds.removeAll()}}}),define("views/profile",["knockout","knockoutMapping"],function(e,t){e.mapping=t;var n=null,r=!1,i=null,s={all:".profileView",account:".profileAccountView",addresses:".profileAddressListView",newAddress:".profileNewAddress"},o=function(e,t,r){gdd.utils.slideTransitionView($(s.all),$(e),t,function(){switch(e){case s.account:i=s.account,$("#profileHeader").html("Profile");break;case s.addresses:i=s.addresses,$("#profileHeader").html("Addresses"),n.account.addresses().length>0?$("#noAddressMsg").hide():$("#noAddressMsg").show()}r&&r()})},u=function(t,r){if(n.account.id()>0)$("select").selectmenu("refresh"),$("#addressList").listview("refresh"),t();else{var i=gdd.storage.getAccountData();i?(e.mapping.mergeFromJS(n.account,i),$("select").selectmenu("refresh"),$("#addressList").listview("refresh"),t()):(gdd.showLoader("Loading..."),gdd.api.callApi("Person/GetPerson","GET",{personId:gdd.session.personId()},{success:function(r){gdd.hideLoader(),gdd.storage.saveAccountData(r.gddData[0]),e.mapping.mergeFromJS(n.account,r.gddData[0]),$("select").selectmenu("refresh"),t()},fail:function(e){gdd.hideLoader(),gdd.showErr(e.msg)}}))}},a=function(){$("#addressList").listview("refresh"),$(".myAddressDelete").off().on(gdd.tap(),function(){var t=$(this).attr("data-id"),r=$.grep(n.account.addresses(),function(e,n){return e.id==t});r[0].deleteMe=1,gdd.showLoader("Deleting..."),gdd.api.callApi("RefData/UpdateGeoRecord","POST",r[0],{success:function(t){gdd.hideLoader(),n.account.addresses.splice(n.account.addresses.indexOf(r[0]),1),gdd.storage.saveAccountData(e.mapping.toJS(n.account)),n.account.addresses().length===0&&$("#noAddressMsg").show()},fail:function(e){gdd.hideLoader(),gdd.showErr(e.msg)}})})},f=function(){n.account.addresses().length>0?o(s.addresses,"left",function(){a()}):gdd.showMsg("You have no addresses loaded on the database. Let's add your first one.",function(){l()})},l=function(){gdd.pages.gmap.view.configurePageForAddressEdit(function(e){e.geoLat?(r=!0,n.newAddressAdded=1,n.newAddressToAdd.streetNumber(e.streetNumber),n.newAddressToAdd.streetName(e.streetName),n.newAddressToAdd.lat(e.geoLat),n.newAddressToAdd.lng(e.geoLng),n.newAddressToAdd.area(e.area),n.newAddressToAdd.city(e.city),n.newAddressToAdd.country(e.country),n.newAddressToAdd.postalCode(e.postalCode),n.newAddressToAdd.region(e.streetName),n.newAddressToAdd.suburb(e.suburb)):r=!1},gdd.pages.profile,null,null,2),gdd.utils.loadPage(gdd.pages.gmap,!1,"slideup")},c=function(){$(".btnProfileChurchLife").on(gdd.tap(),function(){gdd.loadPage(gdd.pages.lists,!1,"slide")}),$(".btnProfileViewGroupMembership").on(gdd.tap(),function(){gdd.loadPage(gdd.pages.groupmem,!1,"slide")}),$("#btnProfileClearDates").on(gdd.tap(),function(){n.account.unixBirthday(""),n.account.birthDay(0),n.account.birthMonth(0),n.account.birthYear(0),$("#txtAccountBirthdate").val(""),n.account.unixAnniversary(""),n.account.anniversaryDay(0),n.account.anniversaryMonth(0),n.account.anniversaryYear(0),$("#txtAccountAnniversary").val("")}),$(".profileNewAddressBack").on(gdd.tap(),function(){o(s.addresses,"down",function(){a()})}),$(".profileAddressListViewBack").on(gdd.tap(),function(){o(s.account,"right")}),$("#btnYesAddThisAddress").on(gdd.tap(),function(){r=!1,n.newAddressToAdd.type($("#ddlPAddType").val()),n.newAddressToAdd.personId(gdd.session.personId()),n.newAddressToAdd.id(-1),gdd.showLoader("Adding address..."),gdd.api.callApi("RefData/UpdateGeoRecord","POST",e.mapping.toJS(n.newAddressToAdd),{success:function(t){gdd.hideLoader(),n.account.addresses.push(t.gddData[0]),gdd.storage.saveAccountData(e.mapping.toJS(n.account)),$("#addressList").listview("refresh"),f()},fail:function(e){gdd.hideLoader(),gdd.showErr(e.msg)}})});var t=document.getElementById("imgProfileFb");t.onerror=function(){i==s.account&&(this.src="http://graph.facebook.com/3/picture?type=normal",n.account.facebookId()&&gdd.showMsg("The FacebookID you entered does not point to a valid facebook account. Please ensure you have entered the correct ID."))},$("#btnAddNewAddress").on(gdd.tap(),function(){l()}),$(".btnProfileAddressListView").on(gdd.tap(),function(){f()}),$("#btnUpdateAccount").on(gdd.tap(),function(){gdd.showLoader("Updating.."),gdd.api.callApi("Person/UpdatePerson","POST",e.mapping.toJS(n.account),{success:function(t){gdd.hideLoader(),gdd.session.auth.facebookId(t.gddData[0].facebookId);var r=gdd.storage.getAuthInfo();r.facebookId=t.gddData[0].facebookId,gdd.storage.saveAuthInfo(r),gdd.storage.saveAccountData(t.gddData[0]),e.mapping.mergeFromJS(n.account,t.gddData[0]),$("select").selectmenu("refresh")},fail:function(e){gdd.hideLoader(),gdd.showErr(e.msg)}})}),gdd.utils.initDatePicker("txtAccountBirthdate",function(e){e.dt?n.account.unixBirthday(e.unix):(n.account.unixBirthday(""),n.account.birthDay(0),n.account.birthMonth(0),n.account.birthYear(0))}),gdd.utils.initDatePicker("txtAccountAnniversary",function(e){e.unix?n.account.unixAnniversary(e.unix):(n.account.unixAnniversary(""),n.account.anniversaryDay(0),n.account.anniversaryMonth(0),n.account.anniversaryYear(0))})};return{newAddressToAdd:{id:e.observable(-1),personId:e.observable(""),country:e.observable(""),region:e.observable(""),city:e.observable(""),suburb:e.observable(""),streetNumber:e.observable(""),streetName:e.observable(""),postalCode:e.observable(""),lng:e.observable(""),lat:e.observable(""),groupId:e.observable(""),area:e.observable(""),type:e.observable("")},account:{id:e.observable(),firstName:e.observable(),lastName:e.observable(),birthDay:e.observable(),birthMonth:e.observable(),birthYear:e.observable(),anniversaryDay:e.observable(),anniversaryMonth:e.observable(),anniversaryYear:e.observable(),email1:e.observable(),email2:e.observable(),mobileNumber:e.observable(),workNumber:e.observable(),homeNumber:e.observable(),facebookId:e.observable(),maritalStatus:e.observable(),gender:e.observable("M"),addresses:e.observableArray(),displayBirthDate:e.observable(),displayAnniversary:e.observable(),unixBirthday:e.observable(),unixAnniversary:e.observable()},create:function(){n=gdd.utils.activePage.view,gdd.utils.configMergeFromJs(e),c(),e.applyBindings(gdd,document.getElementById(gdd.utils.activePage.id))},show:function(){u(function(){r?(r=!1,o(s.newAddress,"up")):o(s.account,"up")},function(e){gdd.showErr(e)})},beforeShow:function(){},beforeHide:function(){},endOldSession:function(){gdd.pages.profile.view.account.id(-1)}}}),define("views/lists",["knockout","knockoutMapping"],function(e,t){e.mapping=t;var n=null,r=function(){var e=function(){$(".fieldFlipSwitch").flipswitch(),$(".fieldFlipSwitch").flipswitch("refresh"),$(".fieldFlipSwitch").off().on("change",function(e){var t=$(this).prop("checked"),n=$(this).attr("data-id");gdd.showLoader("Updating..."),gdd.api.callApi("Person/TogglePersonsBooleanFieldMembership","GET",{personId:gdd.session.personId(),fieldId:n,value:t},{success:function(e){gdd.hideLoader()},fail:function(e){gdd.hideLoader(),gdd.showErr(e.msg)}})})};n.fields().length>0?(e(),$.when($(".listView").not(".listContent").hide()).then(function(){$(".listContent").show("slide",{direction:"up"})})):(gdd.showLoader("Loading lists..."),gdd.api.callApi("Person/GetPersonsBooleanFieldMapping","GET",{personId:gdd.session.personId()},{success:function(t){gdd.hideLoader(),t.gddData.length>0?(n.fields.removeAll(),$.each(t.gddData,function(e,t){var n=$.grep(t.mappings,function(e,t){return e.isSubscription?!1:!0});t.mappings=n}),$.each(t.gddData,function(e,t){t.mappings.length>0&&n.fields.push(t)}),e(),$.when($(".listView").not(".listContent").hide()).then(function(){$(".listContent").show("slide",{direction:"up"})})):$.when($(".listView").not(".noListContent").hide()).then(function(){$(".noListContent").show("slide",{direction:"up"})})},fail:function(e){gdd.hideLoader(),gdd.showErr(e.msg)}}))},i=function(){};return{fields:e.observableArray(),create:function(){n=gdd.utils.activePage.view,gdd.utils.configMergeFromJs(e),i(),e.applyBindings(gdd,document.getElementById(gdd.utils.activePage.id))},show:function(){r()},beforeShow:function(){},beforeHide:function(){},endOldSession:function(){gdd.pages.lists.view.fields.removeAll()}}}),define("views/messages",["knockout","knockoutMapping"],function(e,t){e.mapping=t;var n=null,r={all:".messageView",msgList:".messageList",msgNone:".noMessages",msgReply:".msgReply"},i=function(e,t,n){gdd.utils.slideTransitionView($(r.all),$(e),t,function(){switch(e){case r.msgList:$("#msgHeader").html("Messages");break;case r.msgNone:$("#msgHeader").html("Messages");break;case r.msgReply:$("#msgHeader").html("Reply")}n&&n()})},s=function(){$("#myMessages").listview("refresh");var e=function(e){var t=$.grep(n.messages(),function(t,n){return t.id==e});n.selectedMsg=t[0]};$(".btnReadMsg").off().on(gdd.click(),function(t){e($(this).attr("data-id"));var r={};r.msgId=n.selectedMsg.mappingId,r.readStatus="1",r.markAllAsRead=!1,gdd.showLoader("Working..."),gdd.api.callApi("Messaging/ToggleMsgReadStatus","POST",r,{success:function(e){gdd.hideLoader();var t=$.grep(n.messages(),function(e,t){return e.id==n.selectedMsg.id});n.messages.splice(n.messages.indexOf(t[0]),1),n.messages().length===0?(gdd.showLoader("Checking messages..."),n.loadMessages(function(){gdd.hideLoader()},function(e){gdd.hideLoader(),gdd.showErr(e)})):$(".messagesBubbleCount").html(n.messages().length).show()},fail:function(e){gdd.hideLoader(),gdd.showErr(e.msg)}})}),$(".btnReplyMsg").off().on(gdd.click(),function(t){e($(this).attr("data-id")),$("#msgReplyHeader").html("A push notification will be sent to "+n.selectedMsg.sentBy+"'s mobile phone"),$("#txtMsgReplyContent").val(""),i(r.msgReply,"left")})},o=function(){$("#btnMarkAllMessagesAsRead").on(gdd.tap(),function(){var e={};e.msgId="",e.readStatus="1",e.markAllAsRead=!0,gdd.showLoader("Working..."),gdd.api.callApi("Messaging/ToggleMsgReadStatus","POST",e,{success:function(e){gdd.hideLoader(),n.messages.removeAll(),i(r.msgNone,"up"),$(".messagesBubbleCount").html("0").hide()},fail:function(e){gdd.hideLoader(),gdd.showErr(e.msg)}})}),$("#btnSendMsgReply").on(gdd.tap(),function(){if($("#txtMsgReplyContent").val().length>0){var e={};e.messageType=1,n.selectedMsg.subject.indexOf("REPLY")>-1?e.subject=n.selectedMsg.subject:e.subject="REPLY: "+n.selectedMsg.subject,e.messageBody=$("#txtMsgReplyContent").val(),e.personIdList=n.selectedMsg.sendingPersonId,e.inclPersonIdList=!0,e.pushAppId=gdd.session.appInfo.split("|")[0].split(":")[1],e.sentBy=gdd.session.displayName(),e.appBadgeAction=1,e.playSound=!0,e.messageTag="Message",e.replyEnabled=!0,gdd.showLoader("Sending..."),gdd.api.callApi("Messaging/SendMessage","POST",e,{success:function(e){gdd.hideLoader(),i(r.msgList,"right")},fail:function(e){gdd.hideLoader(),gdd.showErr(e.msg)}})}else gdd.showMsg("You have not entered a message to send.")}),$("#btnRefreshMessages").on(gdd.tap(),function(){n.messages.removeAll(),gdd.showLoader("Checking messages..."),n.loadMessages(function(){gdd.hideLoader()},function(e){gdd.hideLoader(),gdd.showErr(e)})}),$(".btnMsgReplyBack").on(gdd.tap(),function(){i(r.msgList,"right")})};return{messagesChecked:!1,loadMessages:function(e,t){$(".messagesBubbleCount").html("").hide(),gdd.pages.messages.view.messagesChecked=!0;if(gdd.pages.messages.view.messages().length>0)$(".messagesBubbleCount").html(gdd.pages.messages.view.messages().length).show(),gdd.utils.activePage.id==gdd.pages.messages.id&&(s(),i(r.msgList,"up")),e&&e();else{var n={};n.msgId="",n.personId=gdd.session.personId(),n.viewed="0",n.count=50,n.viewPersonGlobal="1",n.matchAll="1",gdd.api.callApi("Messaging/GetMessageMappings","POST",n,{success:function(t){t.gddData.length===0?gdd.utils.activePage.id==gdd.pages.messages.id&&i(r.msgNone,"up"):(gdd.pages.messages.view.messages.removeAll(),$.each(t.gddData,function(e,t){gdd.pages.messages.view.messages.push(t)}),gdd.utils.activePage.id==gdd.pages.messages.id&&(s(),i(r.msgList,"up"))),$(".messagesBubbleCount").html(gdd.pages.messages.view.messages().length).show(),e&&e()},fail:function(e){t&&t(e.msg)}})}},selectedMsg:{},messages:e.observableArray(),create:function(){n=gdd.utils.activePage.view,gdd.utils.configMergeFromJs(e),o(),e.applyBindings(gdd,document.getElementById(gdd.utils.activePage.id))},show:function(){gdd.showLoader("Checking messages..."),n.loadMessages(function(){gdd.hideLoader()},function(e){gdd.hideLoader(),gdd.showErr(e)})},beforeShow:function(){},beforeHide:function(){},endOldSession:function(){gdd.pages.messages.view.messages.removeAll()}}}),define("views/findachurch",["knockout","knockoutMapping"],function(e,t){e.mapping=t;var n=null,r={all:".fcView",search:".fcSearchView",missingGeoStruc:".fcMissingGeoStruc",missingChurch:".fcMissingChurchView",searchList:".fcListView"},i=0,s=function(e,t,n){gdd.utils.slideTransitionView($(r.all),$(e),t,function(){switch(e){case r.missingGeoStruc:$("#findachurchHeader").html("Missing Geo Data");break;case r.search:$("#findachurchHeader").html("Search");break;case r.missingChurch:$("#findachurchHeader").html("No Data");break;case r.searchList:$("#findachurchHeader").html("Results")}n&&n()})},o=function(){n.geoChurchStructure?n.geoChurchStructure.countries.length>0?(n.countriesSearch().length===0&&$.each(n.geoChurchStructure.countries,function(e,t){n.countriesSearch.push(t.name)}),s(r.search,"down")):s(r.missingGeoStruc,"up"):s(r.missingGeoStruc,"up")},u=function(e,t){var r=!1;if(n.geoChurchStructure)r=!1,e();else{var i=gdd.storage.getFacGeoStruc();i?i.countries.length>0?(r=!1,n.geoChurchStructure=i,e()):r=!0:r=!0}if(r){var s={};s.scope=0,s.entityType="Congregation",gdd.api.callApi("RefData/GetGeoStructure","POST",s,{success:function(t){gdd.hideLoader(),gdd.storage.saveFacGeoStruc(null),n.geoChurchStructure=null,t.gddData&&$.isArray(t.gddData.countries)&&t.gddData.countries.length>0&&(gdd.storage.saveFacGeoStruc(t.gddData),n.geoChurchStructure=t.gddData),e()},fail:function(e){t(e.msg)}})}},a=function(){n.countriesSearch.removeAll(),n.regionsSearch.removeAll(),n.citiesSearch.removeAll(),n.myChurchQry.country(""),n.myChurchQry.region(""),n.myChurchQry.city(""),$.each(n.geoChurchStructure.countries,function(e,t){n.countriesSearch.push(t.name)}),s(r.search,"down")},f=function(){$(".btnViewChurchAddress").off().on(gdd.click(),function(){var e=$(this).attr("data-id").split("|")[0],t=$(this).attr("data-id").split("|")[1],r=$(this).attr("data-id").split("|")[2];if(e&&t){var s=$.grep(n.churchList(),function(e,t){return e.id==r}),o="";s.length>0&&(o='<div style="width:200px; height:150px" ><strong>'+s[0].name+"</strong><div>"+s[0].geoStreetName+"</div></br><div><strong>Service Times</strong></div>",o+='<table width="100%"><th><tr><td><strong><i>Time</i></strong></td><td><strong><i>Contact</i></strong></td><td><strong><i>Tel</i></strong></td></tr></th><tbody>',$.each(s[0].services,function(e,t){o+="<tr><td>"+t.serviceTime+"</td><td>"+t.contactPerson+"</td><td>"+t.contactTelNumber+"</td></tr>"}),o+="</tbody></table></div>");var u=new Array;u.push({lat:e,lng:t,pinColor:"red",content:o}),i=1,gdd.pages.gmap.view.configureForDropPins(u),gdd.loadPage(gdd.pages.gmap,!1,"slideup")}else gdd.showMsg("No mapping data has been configured for this church.")})},l=function(){$(".fcMissingGeoStrucBack").on(gdd.tap(),function(){s(r.search,"down")}),$("#btnResetSerch").on(gdd.tap(),function(){a()}),$(".btnLinkChurchSearchMissingData").on(gdd.tap(),function(){s(r.missingGeoStruc,"up")}),$("#btnFacWhereIsMyChurch").on(gdd.tap(),function(){s(r.missingChurch,"up")}),$("#btnViewChurchesOnMap").on(gdd.tap(),function(){var e=new Array,t="";$.each(n.churchList(),function(n,r){t='<div style="width:200px; height:150px" ><strong>'+r.name+"</strong><div>"+r.geoStreetName+"</div></br><div><strong>Service Times</strong></div>",t+='<table width="100%"><th><tr><td><strong><i>Time</i></strong></td><td><strong><i>Contact</i></strong></td><td><strong><i>Tel</i></strong></td></tr></th><tbody>',$.each(r.services,function(e,n){t+="<tr><td>"+n.serviceTime+"</td><td>"+n.contactPerson+"</td><td>"+n.contactTelNumber+"</td></tr>"}),t+="</tbody></table></div>",e.push({lat:r.geoLat,lng:r.geoLng,pinColor:"red",content:t})}),i=1,gdd.pages.gmap.view.configureForDropPins(e),gdd.loadPage(gdd.pages.gmap,!1,"slideup")}),$(".btnFcListViewBack").on(gdd.tap(),function(){s(r.search,"right")}),$(".btnFacShowSearchDown").on(gdd.tap(),function(){s(r.search,"down")}),$("#btnFindChurches").on(gdd.tap(),function(){gdd.showLoader("Searching..."),gdd.api.callApi("RefData/SearchCongregations","POST",e.mapping.toJS(n.myChurchQry),{success:function(e){gdd.hideLoader();var t=e.gddData;t.length>0?(n.churchList.removeAll(),$.each(t,function(e,t){n.churchList.push(t)}),f(),s(r.searchList,"left")):s(r.missingChurch,"up")},fail:function(e){gdd.hideLoader(),gdd.showErr(e.msg)}})}),$("#ddlGeoCountry").on("change",function(){var e=$(this).val();n.regionsSearch.removeAll();if(e){n.myChurchQry.country(e);var t=$.grep(n.geoChurchStructure.countries,function(t,n){return t.name==e});$.each(t[0].regions,function(e,t){n.regionsSearch.push(t)}),$(".churchSearchRegion").show("slide",{direction:"left"})}else $.when($(".churchSearchFilter").not(".churchSearchCountry").hide("slide",{direction:"left"})).then(function(){$(".churchSearchCountry").fadeIn()});$("#ddlGeoCountry").selectmenu("refresh")}),$("#ddlGeoRegion").off().on("change",function(){var e=$(this).val();n.citiesSearch.removeAll();if(e){var t=null;n.myChurchQry.region(e),$.each(n.geoChurchStructure.countries,function(n,r){var i=$.grep(r.regions,function(t,n){return t.name==e});i.length>0&&(t=i[0])}),t&&$.each(t.cities,function(e,t){n.citiesSearch.push(t)}),$(".churchSearchCity").show("slide",{direction:"left"})}else n.myChurchQry.city(""),n.myChurchQry.region(""),$(".churchSearchCity").hide("slide",{direction:"left"});$("#ddlGeoRegion").selectmenu("refresh")}),$("#ddlGeoCity").off().on("change",function(){var e=$(this).val();e?n.myChurchQry.city(e):n.myChurchQry.city(""),$("#ddlGeoCity").selectmenu("refresh")}),$("#btnReloadGeoStructure").on(gdd.tap(),function(){n.geoChurchStructure=null,gdd.storage.saveFacGeoStruc(null),gdd.showLoader("Loading search data..."),u(function(){gdd.hideLoader(),o()},function(e){gdd.hideLoader(),gdd.showErr(e)})})};return{churchList:e.observableArray(),myChurchQry:{country:e.observable(""),region:e.observable(""),city:e.observable(""),familyId:e.observable("")},geoChurchStructure:null,create:function(){n=gdd.utils.activePage.view,gdd.utils.configMergeFromJs(e),l(),e.applyBindings(gdd,document.getElementById(gdd.utils.activePage.id))},show:function(){i===1?(i=0,f(),s(r.searchList,"up")):(gdd.showLoader("Loading search data..."),u(function(){gdd.hideLoader(),o()},function(e){gdd.hideLoader(),gdd.showErr(e)}))},countriesSearch:e.observableArray(),regionsSearch:e.observableArray(),citiesSearch:e.observableArray(),beforeShow:function(){},beforeHide:function(){},endOldSession:function(){}}}),define("views/missions",["knockout","knockoutMapping"],function(e,t){e.mapping=t;var n=null,r={all:".missionsView",noMissions:".noMissions",missionList:".missionsList"},i=function(e,t,n){gdd.utils.slideTransitionView($(r.all),$(e),t,function(){switch(e){case r.addNew:$("#peopleHeader").html("Add New")}n&&n()})},s=function(){$("#btnReloadMissions").on(gdd.tap(),function(){n.missions.removeAll(),gdd.showLoader("Loading missions..."),o(function(){gdd.hideLoader(),n.missions().length>0?i(r.missionList,"up"):i(r.noMissions,"up")},function(e){gdd.hideLoader(),gdd.showErr(e)})})},o=function(e,t){var r=function(){var e=function(e,t){gdd.showLoader("Updating..."),gdd.api.callApi("News/TogglePersonsMissionAttendance","GET",{missionId:e,personId:gdd.session.personId(),going:t},{success:function(i){gdd.hideLoader();if($.isArray(i.gddData))if(i.gddData.length>0){var s=i.gddData[0],o=$.grep(n.missions(),function(t,n){return t.missionId==e}),u=n.missions.indexOf(o[0]);n.missions.splice(u,1,s),r(),t&&gdd.showMsg("The missions co-ordinator has been notified that you would like to go on this mission.")}else gdd.showErr("The response from the server has been tempered with, please contact support.");else gdd.showErr("The response from the server has been tempered with, please contact support.")},fail:function(e){gdd.hideLoader(),gdd.showErr(e.msg)}})};$(".btnCannotGoOnMission").off().on(gdd.click(),function(){var t=$(this).attr("data-id");e(t,!1)}),$(".btnGoOnMission").off().on(gdd.click(),function(){var t=$(this).attr("data-id");e(t,!0)})},i=!1;n.missions().length>0?(i=!1,r(),e()):i=!0,i&&gdd.api.callApi("News/GetPersonsMissionProfiles","GET",{familyId:0,personId:gdd.session.personId()},{success:function(t){n.missions.removeAll(),$.isArray(t.gddData)&&t.gddData.length>0&&($.each(t.gddData,function(e,t){n.missions.push(t)}),r()),e()},fail:function(e){t(e.msg)}})};return{missions:e.observableArray(),create:function(){n=gdd.utils.activePage.view,gdd.utils.configMergeFromJs(e),s(),e.applyBindings(gdd,document.getElementById(gdd.utils.activePage.id))},show:function(){gdd.showLoader("Loading missions..."),o(function(){gdd.hideLoader(),n.missions().length>0?i(r.missionList,"up"):i(r.noMissions,"up")},function(e){gdd.hideLoader(),gdd.showErr(e)})},beforeShow:function(){},beforeHide:function(){},endOldSession:function(){}}}),define("views/secprofile",["knockout","knockoutMapping"],function(e,t){e.mapping=t;var n=null,r=function(){if($("#txtPinfoExistPWD").val())if($("#txtPInfoUserName").val())if($("#txtPInfoNewPwd").val()){var e=$("#txtPInfoNewPwd").val().length;if(e<5)gdd.showMsg("Your new password must be at least 5 characters long");else{var t=/(?!^[0-9]*$)(?!^[a-zA-Z]*$)^([a-zA-Z0-9]{5,20})$/g,n=!1;passwordPasswed=t.test($("#txtPInfoNewPwd").val());if(!passwordPasswed)gdd.showMsg("Your new password must be at least 5 characters long and contain at least 1 number and 1 upper/lower case letter.");else if($("#txtPInfoNewPwd").val()===$("#txtPInfoConfPwd").val()){var r={oldPassword:$("#txtPinfoExistPWD").val(),newPassword:$("#txtPInfoNewPwd").val(),newUserName:$("#txtPInfoUserName").val(),userId:gdd.session.auth.userId()};gdd.showLoader("Updating..."),gdd.api.callApi("Security/UpdateUserNamePassword","POST",r,{success:function(e){gdd.hideLoader(),gdd.loadPage(gdd.utils.previousPage,!0,"slide")},fail:function(e){gdd.hideLoader(),gdd.showErr(e.msg)}})}else gdd.showMsg("Your new passwords do not match.")}}else gdd.showMsg("Enter a new password.");else gdd.showMsg("Enter your username");else gdd.showMsg("Enter your existing password")},i=function(){$("#btnPInfoUpdateSec").on(gdd.tap(),function(){r()})};return{create:function(){n=gdd.utils.activePage.view,gdd.utils.configMergeFromJs(e),i(),e.applyBindings(gdd,document.getElementById(gdd.utils.activePage.id))},show:function(){},beforeShow:function(){},beforeHide:function(){},endOldSession:function(){}}}),define("views/managepermissions",["knockout","knockoutMapping"],function(e,t){e.mapping=t;var n=null,r=null,i=function(e){gdd.showLoader("Working..."),gdd.api.callApi("Security/GrantPermission","GET",{requestId:r,instruction:e},{success:function(e){gdd.hideLoader();var t=$.grep(n.requests(),function(e,t){return e.id==r});n.requests.splice(n.requests.indexOf(t[0]),1),n.requests().length===0&&o()},fail:function(e){gdd.hideLoader(),gdd.showErr(e.msg)}})},s=function(){$("#btnPermReqTrusted").on(gdd.tap(),function(){$("#popupPermReqMenu").one("popupafterclose",function(e,t){i(1)}),$("#popupPermReqMenu").popup("close")}),$("#btnPermReqExecutive").on(gdd.tap(),function(){$("#popupPermReqMenu").one("popupafterclose",function(e,t){i(2)}),$("#popupPermReqMenu").popup("close")}),$("#btnPermReqPublic").on(gdd.tap(),function(){$("#popupPermReqMenu").one("popupafterclose",function(e,t){i(0)}),$("#popupPermReqMenu").popup("close")}),$("#btnPermReqDelete").on(gdd.tap(),function(){$("#popupPermReqMenu").one("popupafterclose",function(e,t){i(-1)}),$("#popupPermReqMenu").popup("close")}),$("#btnCheckForNewRequests").on(gdd.tap(),function(){n.requests.removeAll(),o()})},o=function(){var e=function(){$(".btnPermissionOption").off().on(gdd.click(),function(){r=$(this).attr("data-id"),gdd.showPopup("popupPermReqMenu",{positionTo:$(this)})})};n.requests().length>0?e():(gdd.showLoader("Loading..."),gdd.api.callApi("Security/GetPermissionRequests","GET","",{success:function(t){gdd.hideLoader(),t.gddData.length>0?($.each(t.gddData,function(e,t){n.requests.push(t)}),e()):gdd.showMsg("All pending requests have been handled.",function(){gdd.loadPage(gdd.utils.previousPage,!0,"slide")})},fail:function(e){gdd.hideLoader(),gdd.showErr(e.msg)}}))};return{requests:e.observableArray(),create:function(){n=gdd.utils.activePage.view,gdd.utils.configMergeFromJs(e),s(),e.applyBindings(gdd,document.getElementById(gdd.utils.activePage.id))},show:function(){o()},beforeShow:function(){},beforeHide:function(){},endOldSession:function(){gdd.pages.managePermissions.view.requests.removeAll()}}}),define("views/about",["knockout","knockoutMapping"],function(e,t){e.mapping=t;var n=null,r=null,i=function(){};return{create:function(){n=this,gdd.utils.configMergeFromJs(e),e.applyBindings(gdd,document.getElementById(gdd.utils.activePage.id))},show:function(){i(),r=$("#aboutBxSlider").bxSlider({controls:!1,mode:"horizontal",useCSS:!0,easing:"easeOutBack",speed:1e3,pager:!0})},beforeShow:function(){},beforeHide:function(){}}}),define("views/sessioninfo",["knockout","knockoutMapping"],function(e,t){e.mapping=t;var n=null,r=function(){};return{create:function(){n=this,gdd.utils.configMergeFromJs(e),e.applyBindings(gdd,document.getElementById(gdd.utils.activePage.id))},show:function(){r(),$("#sessVersion").html(gdd.session.appInfo.split("|")[1].split(":")[1]),$("#sessDb").html(gdd.portalName()+"("+gdd.portalId()+")"),$("#sessUser").html(gdd.session.auth.userName()+"("+gdd.session.auth.userId()+")");var e="";gdd.utils.isAndroid()?e="Android (Google)":e="iOS (Apple)",$("#sessOs").html(e)},beforeShow:function(){},beforeHide:function(){}}}),define("views/give",["knockout","knockoutMapping"],function(e,t){e.mapping=t;var n=null,r={all:".givingView",givingViaWeb:".givingViewViaWeb",giveOne:".givingViewOne",giveTwo:".givingViewTwo",giveThree:".givingViewThree",giveInActive:".givingViewInActive"},i=function(e,t){var r=!0,i="";if(n.myPledge.type()=="1"){n.myPledge.accNumber()||(r=!1,i="You must provide us with a valid credit card number."),n.myPledge.accName()||(r=!1,i="You must provide us with the name on your credit card.");if(!$.isNumeric(n.myPledge.cvc()))r=!1,i="Please enter a valid cvc number.";else if(n.myPledge.cvc()<0)r=!1,i="Please enter a valid cvc number.";else if(n.myPledge.cvc().length<3||n.myPledge.cvc().length>4)r=!1,i="Please enter a valid cvc number."}else n.myPledge.accNumber()||(r=!1,i="You must provide us with the bank account number."),n.myPledge.accName()||(r=!1,i="You must provide us with the name of the bank account."),n.myPledge.branchCode()||(r=!1,i="Please enter the branch code of the bank account.");r?e():t(i)},s=function(e,t,n){gdd.utils.slideTransitionView($(r.all),$(e),t,function(){$("#giveHeaderText").html("Give");switch(e){case r.giveOne:$("#giveHeaderText").html("1 of 3");break;case r.giveTwo:$("#giveHeaderText").html("2 of 3");break;case r.giveThree:$("#giveHeaderText").html("3 of 3");break;case r.giveInActive:$("#giveHeaderText").html("Give");break;case r.givingViaWeb:$("#giveHeaderText").html("Give")}n&&n()})},o=function(){$("#btnGiveRefreshProfile").on(gdd.tap(),function(){n.pledgeTemplate.funds.removeAll(),u()}),$(".giveTwoBackToOne").on(gdd.tap(),function(){s(r.giveOne,"right")}),$(".giveTwoGoToThree").on(gdd.tap(),function(){$.isNumeric(n.myPledge.amount())&&n.myPledge.amount()>0?(n.myPledge.type()=="1"?($(".giveViewDebitOrder").hide(),$(".giveViewCreditCard").show()):($(".giveViewDebitOrder").show(),$(".giveViewCreditCard").hide()),s(r.giveThree,"left")):gdd.showMsg("You have not entered a valid pledge amount. The amount must be a positive numerical amount.")}),$(".giveEditCancel").on(gdd.tap(),function(){s(r.giveOne,"right")}),$("#ddlPledgeType").on("change",function(){$(this).val()=="2"&&(n.myPledge.ccy("ZAR"),$("select").selectmenu("refresh"))}),$(".giveThreeBackToTwo").on(gdd.tap(),function(){s(r.giveTwo,"right")}),$(".giveThreeConfirm").on(gdd.tap(),function(){i(function(){gdd.showPopup("popupPledgeConfirm")},function(e){gdd.showMsg(e)})}),$("#btnUpdatePledge").on(gdd.tap(),function(){i(function(){gdd.showPopup("popupGiveAgree")},function(e){gdd.showMsg(e)})}),$("#btnGiveIAgree").on(gdd.click(),function(){$("#popupGiveAgree").one("popupafterclose",function(){n.myPledge.personId(gdd.session.personId()),n.myPledge.pledgeCode(n.pledgeTemplate.pledgeCode()),gdd.showLoader("Saving pledge..."),gdd.api.callApi("Financial/CaptureRemotePledge","POST",e.mapping.toJS(gdd.pages.give.view.myPledge),{success:function(e){gdd.hideLoader();var t=e.gddData[0];$("#popupPledgeThankYouMessage").one("popupafterclose",function(e,t){gdd.loadPage(gdd.utils.previousPage,!0,"slide")}),gdd.showPopup("popupPledgeThankYouMessage")},fail:function(e){gdd.hideLoader(),gdd.showErr(e.msg)}})}),$("#popupGiveAgree").popup("close")}),$("#btnGiveNotAgree").on(gdd.click(),function(){$("#popupGiveAgree").one("popupafterclose",function(){gdd.showMsg("You must agree to the terms and conditions before we can process this request.")}),$("#popupGiveAgree").popup("close")}),$("#ddlPledgeCcy").on("change",function(){$(this).val()!="ZAR"&&n.myPledge.type()!="1"&&gdd.showMsg("To pledge using a currency other than 'ZAR' requires a Credit Card.",function(){n.myPledge.type("1"),$("select").selectmenu("refresh")})})},u=function(){var t=function(){$("#giveFundList").listview("refresh"),$(".fundItem").off().on(gdd.click(),function(){var e=$(this).attr("data-id").split("|")[0],t=$(this).attr("data-id").split("|")[1];$(".selectedFundName").html(t),n.myPledge.fundId(e),s(r.giveTwo,"left")}),$("select").selectmenu("refresh")},i=function(){t();if(n.pledgeTemplate.isActive())switch(n.pledgeTemplate.redirectToWebUrl()){case 1:if(gdd.utils.isNative())try{$("#btnGiveViaWeb").attr("href","#").removeAttr("target"),$("#btnGiveViaWeb").one(gdd.click(),function(){try{window.open(n.pledgeTemplate.redirectUrl(),"_system","location=yes,closebuttoncaption=Done/Close")}catch(e){gdd.showErr("We cannot load the browser on this device: "+e)}})}catch(e){gdd.showErr("We cannot load the browser on this device: "+e)}else $("#btnGiveViaWeb").attr("href",n.pledgeTemplate.redirectUrl()).attr("target","_blank");s(r.givingViaWeb,"up");break;case 2:gdd.showMsg(n.pledgeTemplate.redirectMsg(),function(){n.pledgeTemplate.funds.removeAll(),gdd.loadPage(gdd.utils.previousPage,!0,"slide")});break;default:s(r.giveOne,"up")}else s(r.giveInActive,"up")};if(n.pledgeTemplate.funds().length>0)i();else{gdd.showLoader("Configuring...");var o={};o.pledgeCode="",o.personId=gdd.session.personId(),gdd.utils.isNative()?gdd.utils.isAndroid()?o.platform=2:o.platform=1:o.platform=0,gdd.api.callApi("Financial/GetPledgeTemplate","POST",o,{success:function(t){gdd.hideLoader(),e.mapping.mergeFromJS(n.pledgeTemplate,t.gddData),i()},fail:function(e){gdd.hideLoader(),gdd.showErr(e.msg,function(){gdd.loadPage(gdd.utils.previousPage,!0,"slide")})}})}};return{pledgeTemplate:{isActive:e.observable(!1),inActiveReason:e.observable(""),id:e.observable(-1),portalId:e.observable(""),portalName:e.observable(""),title:e.observable(""),description:e.observable(""),agreeTo:e.observable(""),thankYouText:e.observable(""),userChanged:e.observable(""),dateChanged:e.observable(""),pledgeCode:e.observable(""),personalInfoHeader:e.observable(""),fundInfoHeader:e.observable(""),bankDetails:e.observable(""),bankingInstructions:e.observable(""),funds:e.observableArray(),ccTypes:e.observableArray(),frequencies:e.observableArray(),ccy:e.observableArray(),accTypes:e.observableArray(),redirectMsg:e.observable(""),redirectUrl:e.observable(""),redirectToWebUrl:e.observable(!1)},myPledge:{personId:e.observable(-1),firstName:e.observable(""),lastName:e.observable(""),email:e.observable(""),telNumber:e.observable(""),fundId:e.observable(""),type:e.observable("1"),accName:e.observable(""),ccType:e.observable(""),amount:e.observable(""),expMonth:e.observable("01"),expYear:e.observable("2018"),accNumber:e.observable(""),frequency:e.observable("Monthly"),ccy:e.observable("ZAR"),cvc:e.observable(""),branchCode:e.observable(""),debitDay:e.observable("1"),pledgeCode:e.observable(""),accTypeId:e.observable("")},create:function(){n=gdd.utils.activePage.view,gdd.utils.configMergeFromJs(e),o(),e.applyBindings(gdd,document.getElementById(gdd.utils.activePage.id))},show:function(){u()},beforeShow:function(){},beforeHide:function(){},endOldSession:function(){gdd.pages.give.view.pledgeTemplate.funds.removeAll()}}}),define("views/groupmem",["knockout","knockoutMapping"],function(e,t){e.mapping=t;var n=null,r={all:".grpMemView",none:".noGrpMem",membership:".grpMem"},i=function(e,t,n){gdd.utils.slideTransitionView($(r.all),$(e),t,function(){switch(e){case r.addNew:$("#peopleHeader").html("Add New")}n&&n()})},s=function(){},o=function(){n.membership().length>0?i(r.membership,"up"):(gdd.showLoader("Loading..."),gdd.api.callApi("Groups/GetPersonsGroupMembershipHistory","GET",{personId:gdd.session.personId()},{success:function(e){gdd.hideLoader();try{e.gddData.length===0?i(r.none,"up"):(n.membership.removeAll(),$.each(e.gddData,function(e,t){n.membership.push(t)}),i(r.membership,"up"))}catch(t){i(r.none,"up")}},fail:function(e){gdd.hideLoader(),gdd.showErr(e.msg)}}))};return{membership:e.observableArray(),create:function(){n=gdd.utils.activePage.view,gdd.utils.configMergeFromJs(e),s(),e.applyBindings(gdd,document.getElementById(gdd.utils.activePage.id))},show:function(){o()},beforeShow:function(){},beforeHide:function(){},endOldSession:function(){gdd.pages.groupmem.view.membership.removeAll()}}}),define("views/views",["views/signIn","views/index","views/moreInfo","views/home","views/portals","views/news","views/subs","views/people","views/groups","views/gmap","views/requestpermission","views/events","views/payment","views/sermons","views/profile","views/lists","views/messages","views/findachurch","views/missions","views/secprofile","views/managepermissions","views/about","views/sessioninfo","views/give","views/groupmem"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T){var N="Your account does not have the required permission to access this page. Please contact your church office.";return{getPageById:function(e){for(var t in gdd.pages)if(typeof gdd.pages[t]=="object"&&gdd.pages[t].hasOwnProperty("id")&&gdd.pages[t].id==e)return gdd.pages[t]},index:{id:"pg_index",path:"index.html",loginState:1,view:t,permitted:function(){return!0},deniedMsg:N},people:{id:"pg_people",path:"people.html",loginState:3,view:u,permitted:function(){return gdd.session.activeSession.permissions.viewOthersAccountInfo},deniedMsg:"Your account is not permitted to access other people's information."},managePermissions:{id:"pg_managepermissions",path:"managepermissions.html",loginState:3,view:w,permitted:function(){return gdd.session.activeSession.permissions.manageSecProfiles},deniedMsg:"You are not permitted to manage security profiles in this database."},groupmem:{id:"pg_groupmem",path:"groupmem.html",loginState:3,view:T,permitted:function(){return!0},deniedMsg:"You are not permitted to view group membership in this database."},events:{id:"pg_events",path:"events.html",loginState:3,view:c,permitted:function(){return!0},deniedMsg:N},give:{id:"pg_give",path:"give.html",loginState:3,view:x,permitted:function(){return!0},deniedMsg:N},about:{id:"pg_about",path:"about.html",loginState:3,view:E,permitted:function(){return!0},deniedMsg:N},sessionInfo:{id:"pg_sessioninfo",path:"sessioninfo.html",loginState:3,view:S,permitted:function(){return!0},deniedMsg:N},lists:{id:"pg_lists",path:"lists.html",loginState:3,view:v,permitted:function(){return!0},deniedMsg:N},findachurch:{id:"pg_findachurch",path:"findachurch.html",loginState:3,view:g,permitted:function(){return!0},deniedMsg:N},secProfile:{id:"pg_secprofile",path:"secprofile.html",loginState:3,view:b,permitted:function(){return!0},deniedMsg:N},missions:{id:"pg_missions",path:"missions.html",loginState:3,view:y,permitted:function(){return!0},deniedMsg:N},messages:{id:"pg_messages",path:"messages.html",loginState:3,view:m,permitted:function(){return!0},deniedMsg:N},profile:{id:"pg_profile",path:"profile.html",loginState:3,view:d,permitted:function(){return!0},deniedMsg:N},payment:{id:"pg_payment",path:"payment.html",loginState:3,view:h,permitted:function(){return!0},deniedMsg:N},requestPermission:{id:"pg_requestpermission",path:"requestpermission.html",loginState:3,view:l,permitted:function(){return!0},deniedMsg:N},gmap:{id:"pg_gmap",path:"gmap.html",loginState:3,view:f,permitted:function(){return!0},deniedMsg:N},groups:{id:"pg_groups",path:"groups.html",loginState:3,view:a,permitted:function(){return!0},deniedMsg:N},subs:{id:"pg_subs",path:"subs.html",loginState:1,view:o,permitted:function(){return!0},deniedMsg:N},sermons:{id:"pg_sermons",path:"sermons.html",loginState:3,view:p,permitted:function(){return!0},deniedMsg:N},moreInfo:{id:"iii",path:"moreInfo.html",loginState:1,view:n,permitted:function(){return!0},deniedMsg:N},home:{id:"pg_news",path:"news.html",loginState:3,view:s,permitted:function(){return!0},deniedMsg:N},portals:{id:"pg_portals",path:"portals.html",loginState:3,view:i,permitted:function(){return!0},deniedMsg:N},news:{id:"pg_news",path:"news.html",loginState:3,view:s,permitted:function(){return!0},deniedMsg:N}}}),define("global/session",["knockout","knockoutMapping"],function(e,t){return e.mapping=t,{startProfile:{mobiVersionStopMsg:e.observable(""),mobiVersionNoticeMsg:e.observable(""),baseApiUrl:e.observable(""),showMobiVersionNoticeMsg:e.observable(!1),showMobiVersionStopMsg:e.observable(!1),timeChecked:null},auth:{authKey:e.observable(""),authorizedPortals:e.observableArray(),displayName:e.observable(""),facebookId:e.observable(""),globalSettings:{googleGdcProjectId:e.observable("")},personId:e.observable(""),sts:e.observable(""),userId:e.observable(""),userName:e.observable("")},activeSession:{notice:e.observable(""),permissions:{},portalId:e.observable(""),portalLabels:{},portalName:e.observable(""),portalSettings:{},sessionKey:e.observable("")},baseApiUrl:"",sessionKey:function(){return gdd.session.activeSession?gdd.session.activeSession.sessionKey()?gdd.session.activeSession.sessionKey():"":""},authKey:function(){return gdd.session.auth?gdd.session.auth.authKey()?gdd.session.auth.authKey():"":""},apiKey:"39251c1b-7585-476e-a69f-bbee4d17dd63",signOut:function(){gdd.storage.signOut(),gdd.session.auth.authKey(""),gdd.session.auth.authorizedPortals.removeAll(),gdd.session.auth.displayName(""),gdd.session.auth.facebookId(""),gdd.session.auth.globalSettings.googleGdcProjectId(""),gdd.session.auth.personId(""),gdd.session.auth.sts(""),gdd.session.auth.userId(""),gdd.session.auth.userName(""),gdd.session.endOldSession(),gdd.session.activeSession.permissions={},gdd.session.activeSession.portalId(""),gdd.session.activeSession.portalLabels={},gdd.session.activeSession.portalName(""),gdd.session.activeSession.portalSettings={},gdd.session.activeSession.sessionKey(""),gdd.loadPage(gdd.pages.index,!1,"slideup")},endOldSession:function(){gdd.session.pushDeviceId=null,gdd.session.activeSession.sessionKey("");for(var e in gdd.pages)typeof gdd.pages[e]=="object"&&gdd.pages[e].hasOwnProperty("view")&&gdd.pages[e].view.hasOwnProperty("endOldSession")&&gdd.pages[e].view.endOldSession()},startNewSession:function(){var t=gdd.storage.getSessionInfo();gdd.storage.saveSessionInfo(t),e.mapping.mergeFromJS(gdd.session.activeSession,t),gdd.session.activeSession.permissions=t.permissions,gdd.session.activeSession.portalLabels=t.portalLabels,gdd.session.activeSession.portalSettings=t.portalSettings,gdd.utils.applyModuleVisibility(),gdd.utils.buildLabelObject(),gdd.loadPage(gdd.pages.home)},appInfo:null,personId:function(){return gdd.session.auth.personId()},pushDeviceId:null,displayName:e.pureComputed(function(){return gdd.session.auth.displayName()},this),fbLg:e.pureComputed(function(){return"http://graph.facebook.com/"+gdd.session.auth.facebookId()+"/picture?type=large"},this),fbMd:e.pureComputed(function(){return"http://graph.facebook.com/"+gdd.session.auth.facebookId()+"/picture?type=normal"},this),fbSm:e.pureComputed(function(){return"http://graph.facebook.com/"+gdd.session.auth.facebookId()+"/picture?type=small"},this),authorized:function(){return!0},signedIn:function(){if(gdd.session.activeSession.sessionKey())return!0;var e=gdd.storage.getSessionInfo();return e?gdd.session.activeSession.sessionKey()?(gdd.session.startNewSession(),!0):!1:!1}}}),define("global/utils",["knockout","knockoutMapping"],function(e,t){return e.mapping=t,{loadGoogleJsonApi:function(e,t){typeof google!="object"?$.getScript("http://www.google.com/jsapi?key=AIzaSyCLeCaHg4_SjCQaiF8PXVhZ0VHlwLjMQvY").done(function(t,n){e()}).fail(function(e,n,r){t("We were not able to configure Google Json Api. This is most likely due to internet connectivity.")}):e()},loadGoogleMapsApi:function(e,t){gdd.utils.loadGoogleJsonApi(function(){if(typeof google.maps!="object")try{gmapsApiLoaded=function(){e()};try{google.load("maps","3",{callback:gmapsApiLoaded,other_params:"sensor=false"})}catch(n){t(n)}}catch(r){t(r)}else e()},function(e){t(e)})},deviceIsReady:!1,tap:"tap",click:"click",activePage:null,previousPage:null,requestPermission:function(e){gdd.pages.requestPermission.view.msg(e),gdd.loadPage(gdd.pages.requestPermission)},showMsg:function(e,t){$("#glbMsgContent").html(e),$("#globalMessage").popup("open",{transition:"pop"}),t&&$("#globalMessage").one("popupafterclose",function(e,n){t()})},showPopup:function(e,t,n){if(t)t.transition="slideup";else var t={transition:"slideup"};$("#"+e).popup("open",t),n&&$("#"+e).one("popupafterclose",function(e,t){n()})},showWarning:function(e,t){$("#glbWarningMsgContent").html(e),$("#globalWarningMessage").popup("open",{transition:"pop"}),t&&$("#globalWarningMessage").one("popupafterclose",function(e,n){t()})},showErr:function(e,t){$("#glbErrMsgContent").html(e),$("#globalErrorMessage").popup("open",{transition:"pop"}),t&&$("#globalErrorMessage").one("popupafterclose",function(e,n){t()})},loadPage:function(e,t,n){if(e.permitted()){e||(e=gdd.pages.home);var r=function(){return gdd.utils.activePage?gdd.utils.activePage.id!==e.id?!0:!1:!0},i=function(){var e={};return n?t?{transition:n,reverse:!0}:{transition:n}:t?{transition:"slide",reverse:!0}:{transition:"slide"}};r()?this.isOnline()&&this.appReady()?(this.previousPage=this.activePage,this.activePage=e,gdd.utils.isNative()?$("body").pagecontainer("change",gdd.utils.renderPagePath(e.path),i()):location.href.indexOf("local")>-1?$("body").pagecontainer("change",gdd.utils.renderPagePath(e.path),i()):$("body").pagecontainer("change",gdd.utils.renderPagePath(e.path),i()),gdd.utils.push.configure(),gdd.pages.news.view.newsItems().length>0&&gdd.utils.getAppConfig(function(){gdd.utils.notice.checkForNew(function(){gdd.utils.checkMessages()})})):gdd.showMsg("You are either not connected to the internet or the application is still in the process of initiating.",function(){gdd.utils.loadPage(e,t,n)}):($("#appMenuPanel").panel("close"),$("#appSettingsPanel").panel("close"),gdd.hideLoader())}else gdd.utils.requestPermission(e.deniedMsg)},renderPagePath:function(e){return gdd.utils.isNative()?e:location.href.indexOf("local")>-1||location.href.indexOf("41")>-1?e:"http://m.godochurch.com/m/"+e},configMergeFromJs:function(e){e.mapping.mergeFromJS=function(t,n){for(var r in n)t.hasOwnProperty(r)?typeof t[r]=="object"?e.mapping.mergeFromJS(t[r],n[r]):typeof t[r]=="function"&&(e.isComputed(t[r])||t[r](n[r])):t[r]=n[r]}},checkMessages:function(){gdd.pages.messages.view.messagesChecked||gdd.pages.messages.view.loadMessages()},isOnline:function(){return window.navigator.onLine?!0:!1},hideLoader:function(){$.mobile.loading("hide")},showLoader:function(e){$.mobile.loading("show",{text:e,textVisible:!0,theme:"f",html:""})},isNative:function(){return document.URL.indexOf("http://")===-1&&document.URL.indexOf("https://")===-1?!0:!1},deviceIsReady:!1,appInitialized:!1,appReady:function(){return this.isNative()?this.deviceIsReady?gdd?this.appInitialized?!0:!1:!1:!1:gdd?this.appInitialized?!0:!1:!1},restartApp:function(){window.gddAppRestart()},phoneGap:{timePaused:null,onAppPause:function(){gdd.utils.phoneGap.timePaused=gdd.utils.getDt().unix},onAppResume:function(){try{if(gdd.session.activeSession.sessionKey())if(gdd.utils.phoneGap.timePaused){var e=gdd.utils.getDt().unix;e-gdd.utils.phoneGap.timePaused>10&&(gdd.showLoader("Waking up..."),gdd.utils.restartApp())}else gdd.utils.restartApp();else gdd.utils.restartApp()}catch(t){gdd.utils.restartApp()}},onBackKeyDown:function(e){e.preventDefault();try{if(gdd.utils.previousPage){var t=new Array;t.push("pg_gmap"),t.push("pg_index"),t.indexOf(gdd.utils.previousPage.id)===-1?gdd.loadPage(gdd.utils.previousPage,!0,"slide"):gdd.loadPage(gdd.pages.home,!0,"slide")}}catch(n){location.href="index.html"}},onDeviceReady:function(){try{gdd.utils.deviceIsReady=!0;try{StatusBar.overlaysWebView(!1),StatusBar.hide()}catch(e){}setTimeout(function(){navigator.splashscreen.hide()},1e3),document.addEventListener("pause",gdd.utils.phoneGap.onAppPause,!1),document.addEventListener("resume",gdd.utils.phoneGap.onAppResume,!1),document.addEventListener("backbutton",gdd.utils.phoneGap.onBackKeyDown,!1)}catch(t){alert("The following error occured during the onDeviceReady event: "+t+". Please check you are connected to the Internet and try again.")}}},notice:{checkForNew:function(e){var t=!1,n=gdd.utils.getDt();if(gdd.utils.notice.lastChecked)try{n.unix-gdd.utils.notice.lastChecked>86400?t=!0:t=!1}catch(r){t=!0}else t=!0;t?gdd.api.callApi("Person/GetPersonsNotice","GET","",{success:function(t){e(),gdd.utils.notice.lastChecked=n.unix;if(t.gddData.length>0){$("#glbMsgDidYouKnow").html(t.gddData[0].message);var r=t.gddData[0].noticeId;gdd.showPopup("globalDidYouKnow",null,function(){gdd.api.callApi("Person/ToggleNoticeRead","GET",{noticeId:r,read:!0},{success:function(e){},fail:function(e){gdd.showErr(e.msg)}})})}},fail:function(t){e(),gdd.showErr(t.msg)}}):e()},lastChecked:null},isAndroid:function(){return gdd.utils.isNative()?device.platform=="android"||device.platform=="Android"?!0:!1:!1},isIos:function(){return gdd.utils.isNative()?device.platform=="iOS"?!0:!1:!1},applyModuleVisibility:function(){gdd.session.startProfile.showMobiVersionStopMsg()?($("#appStopMessage").show(),$("#appNoticeMessage").hide(),$("#appStopMessage").html(gdd.session.startProfile.mobiVersionStopMsg())):($("#appStopMessage").hide(),gdd.session.startProfile.showMobiVersionNoticeMsg()?($("#appNoticeMessage").show(),$("#appNoticeMessage").html(gdd.session.startProfile.mobiVersionNoticeMsg())):$("#appNoticeMessage").hide()),gdd.session.activeSession.portalSettings.groupsIsActive?$(".groupsModule").show():$(".groupsModule").hide(),gdd.session.activeSession.permissions.manageSecProfiles?$(".mngPermissionsModule").show():$(".mngPermissionsModule").hide(),gdd.session.activeSession.portalSettings.sermonsIsActive?$(".sermonsModule").show():$(".sermonsModule").hide(),gdd.session.activeSession.portalSettings.workflowsIsActive?$(".workflowModule").show():$(".workflowModule").hide(),gdd.session.activeSession.portalSettings.followUpIsActive?$(".followUpModule").show():$(".followUpModule").hide(),gdd.session.activeSession.portalSettings.customListsIsActive?$(".customListsModule").show():$(".customListsModule").hide(),gdd.session.activeSession.portalSettings.eventsIsActive?$(".eventsModule").show():$(".eventsModule").hide(),gdd.session.activeSession.portalSettings.newsIsActive?$(".newsModule").show():$(".newsModule").hide(),gdd.session.activeSession.portalSettings.kidsChurchIsActive?$(".kidsChurchModule").show():$(".kidsChurchModule").hide(),gdd.session.activeSession.portalSettings.givingIsActive?$(".givingModule").show():$(".givingModule").hide()},appStart:function(){gdd.utils.configMergeFromJs(e),this.isNative()?(gdd.utils.deviceIsReady=!1,document.addEventListener("deviceready",gdd.utils.phoneGap.onDeviceReady,!1)):gdd.utils.deviceIsReady=!0,$("#globalErrorMessage").show(),$("#globalWarningMessage").show(),$("#globalMessage").show(),$("#popupSettings").show(),$("#globalDidYouKnow").show(),$("#globalDidYouKnow").enhanceWithin().popup(),$("#globalErrorMessage").enhanceWithin().popup(),$("#globalMessage").enhanceWithin().popup(),$("#globalWarningMessage").enhanceWithin().popup(),$("#popupSettings").enhanceWithin().popup(),$("#appMenuPanel").enhanceWithin().panel().show(),$("#appSettingsPanel").enhanceWithin().panel().show();try{var t=gdd.storage.getAuthInfo();if(t){e.mapping.mergeFromJS(gdd.session.auth,t);var n=gdd.storage.getSessionInfo();if(n){this.appInitialized=!0;if(gdd.utils.appReady())gdd.session.startNewSession();else var r=0,i=setInterval(function(){s()},1e3),s=function(){gdd.utils.appReady()?(clearInterval(i),gdd.hideLoader(),gdd.session.startNewSession()):(r+=1,r>10?(clearInterval(i),gdd.hideLoader(),gdd.showMsg("There appears to be a connectivity problem with the app. Please click the OK button below to force a reset.",function(){location.href=gdd.utils.renderPagePath("index.html")})):gdd.showLoader("Connecting..."+r+"/10"))}}else gdd.pages.index.view.create(),this.appInitialized=!0,gdd.pages.index.view.show()}else gdd.storage.saveSessionInfo(null),gdd.session.endOldSession(),gdd.pages.index.view.create(),this.appInitialized=!0,gdd.pages.index.view.show()}catch(o){gdd.storage.saveSessionInfo(null),gdd.session.endOldSession(),gdd.pages.index.view.create(),this.appInitialized=!0,gdd.pages.index.view.show()}},initDatePicker:function(e,t){$("#"+e).datepicker({defaultDate:"+1w",changeYear:"true",yearRange:"-90:+1",changeMonth:!0,dateFormat:gdd.utils.dateDisplayFormat,numberOfMonths:1,onClose:function(e){if(e){var n=$(this).datepicker("getDate"),r={};r.unix=gdd.utils.sysDate(n),r.display=gdd.utils.displayDate(n),r.dt=n,t(r)}else{var r={};r.unix="",r.display="",r.dt="",t(r)}}})},slideTransitionView:function(e,t,n,r){var i="up";switch(n){case"up":i="down";break;case"left":i="right";break;case"right":i="left";break;case"down":i="up"}$.when($(e).not($(t)).hide("slide",{direction:n})).then(function(){$.when($(t).show("slide",{direction:i})).then(function(){r&&r()})})},push:{updateDeviceIdOnServer:function(e,t){var n={deviceId:e,osType:t,personId:gdd.session.personId()};gdd.api.callApi("Security/UpdateUsersDeviceID","GET",n,{success:function(t){gdd.session.pushDeviceId=e},fail:function(e){gdd.utils.push.pluginError(e.msg)}})},android:{onNotification:function(e){switch(e.event){case"registered":e.regid.length>0&&gdd.utils.push.updateDeviceIdOnServer(e.regid,"2");break;case"message":var t={};t.message="",e.payload&&(e.payload.message&&(t.message=e.payload.message),e.payload.title,e.payload.sentBy,e.payload.linkMore),gdd.utils.push.messageReceived(t);break;case"error":gdd.utils.push.pluginError("Google Cloud Messaging incurred the following error: "+e.msg);break;default:gdd.utils.push.pluginError("An unknown error has occurred on Google Cloud Messaging")}}},iOs:{tokenHandler:function(e){gdd.utils.push.updateDeviceIdOnServer(e,"1")},onNotification:function(e){var t={};t.message="",e.alert&&(t.message=e.alert);if(e.sound){var n=new Media(e.sound);n.play()}if(e.badge){var r=window.plugins.pushNotification;r.setApplicationIconBadgeNumber(gdd.utils.push.pluginSuccess,gdd.utils.push.pluginError,e.badge)}gdd.utils.push.messageReceived(t)}},pluginSuccess:function(e){},pluginError:function(e){gdd.showErr("Push Plugin Error: "+e)},messageReceived:function(e){try{gdd.pages.messages.view.messagesChecked=!1,gdd.pages.messages.view.messages.removeAll(),gdd.utils.checkMessages()}catch(t){}},configure:function(){if(gdd.utils.isNative()&&gdd.session.signedIn()&&!gdd.session.pushDeviceId&&window.plugins&&window.plugins.pushNotification&&device)if(gdd.utils.isAndroid())try{var e=window.plugins.pushNotification,t=gdd.session.auth.globalSettings.googleGdcProjectId();e.register(gdd.utils.push.pluginSuccess,gdd.utils.push.pluginError,{senderID:t,ecb:"gdd.utils.push.android.onNotification"})}catch(n){gdd.utils.push.pluginError("The following error was generated while trying to register the device with Google Cloud Messaging: "+n)}else if(gdd.utils.isIos())try{var r=window.plugins.pushNotification;r.register(gdd.utils.push.iOs.tokenHandler,gdd.utils.push.pluginError,{badge:"true",sound:"true",alert:"true",ecb:"gdd.utils.push.iOs.onNotification"})}catch(n){gdd.utils.push.pluginError("The following error was generated while trying to register the device with Apples Push Notification services: "+n)}}},sysDate:function(e){return e?e.getTime()/1e3:(new Date).getTime()/1e3},months:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dateDisplayFormat:"dd-M-yy",displayDate:function(e){return e||(e=new Date),e.getDate()+"-"+gdd.utils.months[e.getMonth()]+"-"+e.getFullYear()},getDt:function(e){var t={},n=new Date;if(e)if(e>0){var r=new Date(n.getTime()+864e5*e);t.unix=gdd.utils.sysDate(r),t.display=gdd.utils.displayDate(r)}else e*=-1,r=new Date(n.getTime()-864e5*e),t.unix=gdd.utils.sysDate(r),t.display=gdd.utils.displayDate(r);else t.unix=gdd.utils.sysDate(n),t.display=gdd.utils.displayDate(n);return t},getAppConfig:function(t){if(gdd.session.startProfile.timeChecked){var n=gdd.utils.getDt(),r=gdd.session.startProfile.timeChecked,i=n.unix-r;i>86300&&(gdd.session.startProfile.timeChecked=null)}gdd.session.startProfile.timeChecked?t():gdd.api.callApi("Open/GetStartProfile","GET","",{success:function(n){e.mapping.mergeFromJS(gdd.session.startProfile,n.gddData),gdd.session.baseApiUrl=n.gddData.baseApiUrl,gdd.session.startProfile.timeChecked=gdd.utils.getDt().unix,t()},fail:function(e){gdd.showErr("Start Profile Error: "+e.msg)}})},buildLabelObject:function(){var e=gdd.session.activeSession.portalLabels,t={};$.each(e,function(e,n){t[n.code.toString()]=n.title}),gdd.labels=t}}}),define("global/api",[],function(){var e=function(){return gdd.session.baseApiUrl?"http://41.86.98.79/webapi2/api/":"http://41.86.98.79/webapi2/api/"},t=function(){var e=gdd.session.sessionKey();if(e)return{apiKey:gdd.session.apiKey,usrKey:e,appInfo:gdd.session.appInfo};var t=gdd.session.authKey();return t?{apiKey:gdd.session.apiKey,usrKey:t,appInfo:gdd.session.appInfo}:{apiKey:gdd.session.apiKey,usrKey:"",appInfo:gdd.session.appInfo}};return{callApi:function(n,r,i,s){$.support.cors=!0;if(!s.success||!s.fail)throw"You must provide a valid callback for 'success' and 'failed'";var o=e()+n;$.ajax(o,{type:r,headers:t(),data:i,complete:function(e,t){var n={};n.status=e.status;if(e.responseJSON)n.gdd=e.responseJSON;else{if(!e.responseText){n.status===404?(n.gdd=n.gdd||{},n.gdd.msg="HTTP ERROR: You are not permitted to access this api endpoint. If you think this is an error please contact support."):n.status=="0"?(n.gdd=n.gdd||{},n.gdd.msg="INTERNET CONNECTION: Your internet connection has been lost. Please reconnect and try again."):(n.gdd=n.gdd||{},n.gdd.msg="The response from the server has been tampered with. Please contact support."),s.fail(n.gdd);return}try{n.gdd=JSON.parse(e.responseText)}catch(r){n.gdd=n.gdd||{},n.gdd.msg="The response from the server has been tampered with. Please contact support.",s.fail(n.gdd);return}}if(n.status===404||n.status=="0")n.gdd=n.gdd||{},n.gdd.msg="HTTP ERROR: You are not permitted to access this api endpoint. If you think this is an error please contact support.",s.fail(n.gdd);else if(n.gdd.code)switch(n.gdd.code){case 1e3:s.success(n.gdd);break;case 1001:s.success(n.gdd,n.gdd.codesc);break;case 4e3:n.gdd.msg="VALIDATION ERROR: "+n.gdd.msg,s.validation?s.validation(n.gdd):s.fail(n.gdd);break;case 4002:gdd.session.signOut();break;case 4001:n.gdd.msg="ACCESS DENIED: "+n.gdd.msg,s.fail(n.gdd);break;case 5e3:n.gdd.msg="SERVER ERROR: "+n.gdd.msg,s.fail(n.gdd);break;case 5001:n.gdd.msg="ERROR: "+n.gdd.msg,s.fail(n.gdd)}else n.gdd=n.gdd||{},n.gdd.msg="The response from the server was not correctly formatted. Please contact support.",s.fail(n.gdd)}})}}}),define("global/storage",[],function(){var e=function(e,t){var n=t.getItem(e);if(!n)return t.removeItem(e),null;try{return $.parseJSON(n)}catch(r){return t.removeItem(e),null}},t=function(e,t,n){e?n.setItem(t,JSON.stringify(e)):n.removeItem(t)},n="glb_authkey",r="ses_authkey",i="ses_grpref_",s="ses_account",o="perm_evregcache",u="glb_facgeostruc";return{signOut:function(){var e=new Array;for(var t=0;t<localStorage.length;t++){var n=localStorage.key(t).split("_")[0];n!="perm"&&e.push(localStorage.key(t))}$.each(e,function(e,t){localStorage.removeItem(t)}),e.length=0;for(var t=0;t<sessionStorage.length;t++){var n=sessionStorage.key(t).split("_")[0];n!="perm"&&e.push(sessionStorage.key(t))}$.each(e,function(e,t){sessionStorage.removeItem(t)})},getAuthInfo:function(){return e(n,localStorage)},saveAuthInfo:function(e){t(e,n,localStorage)},getSessionInfo:function(){return e(r,localStorage)},saveSessionInfo:function(e){t(e,r,localStorage)},getGrpRefData:function(){return e(i+gdd.session.activeSession.portalId(),localStorage)},saveGrpRefData:function(e){t(e,i+gdd.session.activeSession.portalId(),localStorage)},getAccountData:function(){return e(s,localStorage)},saveAccountData:function(e){t(e,s,localStorage)},getEventRegCache:function(){return e(o,localStorage)},saveEventRegCache:function(e){t(e,o,localStorage)},getFacGeoStruc:function(){return e(u,localStorage)},saveFacGeoStruc:function(e){t(e,u,localStorage)}}}),define("global/cache",["knockout","knockoutMapping"],function(e,t){return e.mapping=t,{appPortals:e.observableArray()}}),define("global/nms",["views/views","global/session","global/utils","global/api","global/storage","global/cache"],function(e,t,n,r,i,s){return{cache:s,pages:e,session:t,utils:n,api:r,storage:i,permissions:function(){return gdd.session?gdd.session.activeSession?gdd.session.activeSession.permissions:null:null},loadPage:function(e,t,r){n.loadPage(e,t,r)},portalId:function(){return gdd.session.activeSession.portalId()},portalName:function(){return gdd.session.activeSession.portalName()},tap:function(){return n.tap},click:function(){return n.click},showMsg:function(e,t){n.showMsg(e,t)},showWarning:function(e,t){n.showWarning(e,t)},showErr:function(e,t){n.showErr(e,t)},showPopup:function(e,t,r){n.showPopup(e,t,r)},hideLoader:function(){n.hideLoader()},showLoader:function(e){n.showLoader(e)}}}),window.gdd=null,requirejs.onError=function(e){alert("RJS ERROR: "+e.message),window.gddAppRestart()},requirejs.config({paths:{jquidatepicker:"libraries/datepicker",knockout:"libraries/knockout-3.2.0",knockoutMapping:"libraries/knockout.mapping"},shim:{}}),requirejs(["global/nms"],function(e){e.session.appInfo=window.gddAppInfo,window.gdd=e,gdd.utils.activePage=e.pages.index,gdd.utils.appStart()}),define("start",function(){});